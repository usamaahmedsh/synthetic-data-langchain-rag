The structural similarity index measure (SSIM) is a method for predicting the perceived quality of digital television and cinematic pictures, as well as other kinds of digital images and videos.  It is also used for measuring the similarity between two images. The SSIM index is a full reference metric; in other words, the measurement or prediction of image quality is based on an initial uncompressed or distortion-free image as reference.
SSIM is a perception-based model that considers image degradation as perceived change in structural information, while also incorporating important perceptual phenomena, including both luminance masking and contrast masking terms.  This distinguishes from other techniques such as mean squared error (MSE) or peak signal-to-noise ratio (PSNR) that instead estimate absolute errors.  Structural information is the idea that the pixels have strong inter-dependencies especially when they are spatially close. These dependencies carry important information about the structure of the objects in the visual scene. Luminance masking is a phenomenon whereby image distortions (in this context) tend to be less visible in bright regions, while contrast masking is a phenomenon whereby distortions become less visible where there is significant activity or "texture" in the image.


== History ==
The predecessor of SSIM was called Universal Quality Index (UQI), or Wang–Bovik index, which was developed by Zhou Wang and Alan Bovik in 2001. This evolved, through their collaboration with Hamid Sheikh and Eero Simoncelli, into the current version of SSIM, which was published in April 2004 in the IEEE Transactions on Image Processing. In addition to defining the SSIM quality index, the paper provides a general context for developing and evaluating perceptual quality measures, including connections to human visual neurobiology and perception, and direct validation of the index against human subject ratings.
The basic model was developed in the Laboratory for Image and Video Engineering (LIVE) at The University of Texas at Austin and further developed jointly with the Laboratory for Computational Vision (LCV) at New York University. Further variants of the model have been developed in the Image and Visual Computing Laboratory at University of Waterloo and have been commercially marketed.
SSIM subsequently found strong adoption in the image processing community and in the television and social media industries. The 2004 SSIM paper has been cited over 50,000 times according to Google Scholar, making it one of the highest cited papers in the image processing and video engineering fields. It was recognized with the IEEE Signal Processing Society Best Paper Award for 2009. It also received the IEEE Signal Processing Society Sustained Impact Award for 2016, indicative of a paper having an unusually high impact for at least 10 years following its publication. Because of its high adoption by the television industry, the authors of the original SSIM paper were each accorded a Primetime Engineering Emmy Award in 2015 by the Television Academy.


== Algorithm ==
The SSIM index is calculated between two windows of pixel values 
  
    
      
        x
      
    
    {\displaystyle x}
  
 and 
  
    
      
        y
      
    
    {\displaystyle y}
  
 of common size, from corresponding locations in two images to be compared.  These SSIM values can be aggregated across the full images by averaging or other variations.


=== Special-case formula ===
In one simple special case, further explained in the next section, the SSIM measure between 
  
    
      
        x
      
    
    {\displaystyle x}
  
 and 
  
    
      
        y
      
    
    {\displaystyle y}
  
 is:

  
    
      
        
          
            SSIM
          
        
        (
        x
        ,
        y
        )
        =
        
          
            
              (
              2
              
                μ
                
                  x
                
              
              
                μ
                
                  y
                
              
              +
              
                c
                
                  1
                
              
              )
              (
              2
              
                σ
                
                  x
                  y
                
              
              +
              
                c
                
                  2
                
              
              )
            
            
              (
              
                μ
                
                  x
                
                
                  2
                
              
              +
              
                μ
                
                  y
                
                
                  2
                
              
              +
              
                c
                
                  1
                
              
              )
              (
              
                σ
                
                  x
                
                
                  2
                
              
              +
              
                σ
                
                  y
                
                
                  2
                
              
              +
              
                c
                
                  2
                
              
              )
            
          
        
      
    
    {\displaystyle {\hbox{SSIM}}(x,y)={\frac {(2\mu _{x}\mu _{y}+c_{1})(2\sigma _{xy}+c_{2})}{(\mu _{x}^{2}+\mu _{y}^{2}+c_{1})(\sigma _{x}^{2}+\sigma _{y}^{2}+c_{2})}}}
  

with:

  
    
      
        
          μ
          
            x
          
        
      
    
    {\displaystyle \mu _{x}}
  
 the pixel sample mean of 
  
    
      
        x
      
    
    {\displaystyle x}
  
;

  
    
      
        
          μ
          
            y
          
        
      
    
    {\displaystyle \mu _{y}}
  
 the pixel sample mean of 
  
    
      
        y
      
    
    {\displaystyle y}
  
;

  
    
      
        
          σ
          
            x
          
          
            2
          
        
      
    
    {\displaystyle \sigma _{x}^{2}}
  
 the sample variance of 
  
    
      
        x
      
    
    {\displaystyle x}
  
;

  
    
      
        
          σ
          
            y
          
          
            2
          
        
      
    
    {\displaystyle \sigma _{y}^{2}}
  
 the sample variance of 
  
    
      
        y
      
    
    {\displaystyle y}
  
;

  
    
      
        
          σ
          
            x
            y
          
        
      
    
    {\displaystyle \sigma _{xy}}
  
 the sample covariance of 
  
    
      
        x
      
    
    {\displaystyle x}
  
 and 
  
    
      
        y
      
    
    {\displaystyle y}
  
;

  
    
      
        
          c
          
            1
          
        
        =
        (
        
          k
          
            1
          
        
        L
        
          )
          
            2
          
        
      
    
    {\displaystyle c_{1}=(k_{1}L)^{2}}
  
, 
  
    
      
        
          c
          
            2
          
        
        =
        (
        
          k
          
            2
          
        
        L
        
          )
          
            2
          
        
      
    
    {\displaystyle c_{2}=(k_{2}L)^{2}}
  
 two variables to stabilize the division with weak denominator;

  
    
      
        L
      
    
    {\displaystyle L}
  
 the dynamic range of the pixel-values (typically this is 
  
    
      
        
          2
          
            #
            b
            i
            t
            s
             
            p
            e
            r
             
            p
            i
            x
            e
            l
          
        
        −
        1
      
    
    {\displaystyle 2^{\#bits\ per\ pixel}-1}
  
);

  
    
      
        
          k
          
            1
          
        
        =
        0.01
      
    
    {\displaystyle k_{1}=0.01}
  
 and 
  
    
      
        
          k
          
            2
          
        
        =
        0.03
      
    
    {\displaystyle k_{2}=0.03}
  
 by default.


=== General formula and components ===
The SSIM formula is based on three comparison measurements between the samples of 
  
    
      
        x
      
    
    {\displaystyle x}
  
 and 
  
    
      
        y
      
    
    {\displaystyle y}
  
: luminance (
  
    
      
        l
      
    
    {\displaystyle l}
  
), contrast (
  
    
      
        c
      
    
    {\displaystyle c}
  
), and structure (
  
    
      
        s
      
    
    {\displaystyle s}
  
). The individual comparison functions are:

  
    
      
        l
        (
        x
        ,
        y
        )
        =
        
          
            
              2
              
                μ
                
                  x
                
              
              
                μ
                
                  y
                
              
              +
              
                c
                
                  1
                
              
            
            
              
                μ
                
                  x
                
                
                  2
                
              
              +
              
                μ
                
                  y
                
                
                  2
                
              
              +
              
                c
                
                  1
                
              
            
          
        
      
    
    {\displaystyle l(x,y)={\frac {2\mu _{x}\mu _{y}+c_{1}}{\mu _{x}^{2}+\mu _{y}^{2}+c_{1}}}}
  

  
    
      
        c
        (
        x
        ,
        y
        )
        =
        
          
            
              2
              
                σ
                
                  x
                
              
              
                σ
                
                  y
                
              
              +
              
                c
                
                  2
                
              
            
            
              
                σ
                
                  x
                
                
                  2
                
              
              +
              
                σ
                
                  y
                
                
                  2
                
              
              +
              
                c
                
                  2
                
              
            
          
        
      
    
    {\displaystyle c(x,y)={\frac {2\sigma _{x}\sigma _{y}+c_{2}}{\sigma _{x}^{2}+\sigma _{y}^{2}+c_{2}}}}
  

  
    
      
        s
        (
        x
        ,
        y
        )
        =
        
          
            
              
                σ
                
                  x
                  y
                
              
              +
              
                c
                
                  3
                
              
            
            
              
                σ
                
                  x
                
              
              
                σ
                
                  y
                
              
              +
              
                c
                
                  3
                
              
            
          
        
      
    
    {\displaystyle s(x,y)={\frac {\sigma _{xy}+c_{3}}{\sigma _{x}\sigma _{y}+c_{3}}}}
  

The SSIM for each block is then a weighted combination of those comparative measures:

  
    
      
        
          SSIM
        
        (
        x
        ,
        y
        )
        =
        l
        (
        x
        ,
        y
        
          )
          
            α
          
        
        ⋅
        c
        (
        x
        ,
        y
        
          )
          
            β
          
        
        ⋅
        s
        (
        x
        ,
        y
        
          )
          
            γ
          
        
      
    
    {\displaystyle {\text{SSIM}}(x,y)=l(x,y)^{\alpha }\cdot c(x,y)^{\beta }\cdot s(x,y)^{\gamma }}
  

Choosing the third denominator stabilizing constant as:

  
    
      
        
          c
          
            3
          
        
        =
        
          c
          
            2
          
        
        
          /
        
        2
      
    
    {\displaystyle c_{3}=c_{2}/2}
  

leads to a simplification when combining the c and s components with equal exponents (
  
    
      
        β
        =
        γ
      
    
    {\displaystyle \beta =\gamma }
  
), as the numerator of c is then twice the denominator of s, leading to a cancellation leaving just a 2.  Setting the weights (exponents) 
  
    
      
        α
        ,
        β
        ,
        γ
      
    
    {\displaystyle \alpha ,\beta ,\gamma }
  
 to 1, the formula can then be reduced to the special case shown above.


=== Mathematical properties ===
SSIM satisfies the identity of indiscernibles, and symmetry properties, but not the triangle inequality or non-negativity, and thus is not a distance function. However, under certain conditions, SSIM may be converted to a normalized root MSE measure, which is a distance function. The square of such a function is not convex, but is locally convex and quasiconvex, making SSIM a feasible target for optimization.


=== Application of the formula ===
In order to evaluate the image quality, this formula is usually applied only on luma, although it may also be applied on color (e.g., RGB) values or chromatic (e.g. YCbCr) values. The resultant SSIM index is a decimal value between -1 and 1, where 1 indicates perfect similarity, 0 indicates no similarity, and -1 indicates perfect anti-correlation. For an image, it is typically calculated using a sliding Gaussian window of size 11×11 or a block window of size 8×8. The window can be displaced pixel-by-pixel on the image to create an SSIM quality map of the image. In the case of video quality assessment, the authors propose to use only a subgroup of the possible windows to reduce the complexity of the calculation.


=== Variants ===


==== Multi-scale SSIM ====
A more advanced form of SSIM, called Multiscale SSIM (MS-SSIM) is conducted over multiple scales through a process of multiple stages of sub-sampling, reminiscent of multiscale processing in the early vision system. It has been shown to perform equally well or better than SSIM on different subjective image and video databases.


==== Multi-component SSIM ====
Three-component SSIM (3-SSIM) is a form of SSIM that takes into account the fact that the human eye can see differences more precisely on textured or edge regions than on smooth regions. The resulting metric is calculated as a weighted average of SSIM for three categories of regions: edges, textures, and smooth regions. The proposed weighting is 0.5 for edges, 0.25 for the textured and smooth regions. The authors mention that a 1/0/0 weighting (ignoring anything but edge distortions) leads to results that are closer to subjective ratings. This suggests that edge regions play a dominant role in image quality perception.
The authors of 3-SSIM have also extended the model into four-component SSIM (4-SSIM). The edge types are further subdivided into preserved and changed edges by their distortion status. The proposed weighting is 0.25 for all four components.


==== Structural dissimilarity ====
Structural dissimilarity (DSSIM) may be derived from SSIM, though it does not constitute a distance function as the triangle inequality is not necessarily satisfied.

  
    
      
        
          
            DSSIM
          
        
        (
        x
        ,
        y
        )
        =
        
          
            
              1
              −
              
                
                  SSIM
                
              
              (
              x
              ,
              y
              )
            
            2
          
        
      
    
    {\displaystyle {\hbox{DSSIM}}(x,y)={\frac {1-{\hbox{SSIM}}(x,y)}{2}}}
  


==== Video quality metrics and temporal variants ====
It is worth noting that the original version SSIM was designed to measure the quality of still images. It does not contain any parameters directly related to temporal effects of human perception and human judgment. A common practice is to calculate the average SSIM value over all frames in the video sequence. However, several temporal variants of SSIM have been developed.


==== Complex wavelet SSIM ====
The complex wavelet transform variant of the SSIM (CW-SSIM) is designed to deal with issues of image scaling, translation and rotation. Instead of giving low scores to images with such conditions, the CW-SSIM takes advantage of the complex wavelet transform and therefore yields higher scores to said images. The CW-SSIM is defined as follows:

  
    
      
        
          CW-SSIM
        
        (
        
          c
          
            x
          
        
        ,
        
          c
          
            y
          
        
        )
        =
        
          
            (
          
        
        
          
            
              2
              
                ∑
                
                  i
                  =
                  1
                
                
                  N
                
              
              
                |
              
              
                c
                
                  x
                  ,
                  i
                
              
              
                |
              
              
                |
              
              
                c
                
                  y
                  ,
                  i
                
              
              
                |
              
              +
              K
            
            
              
                ∑
                
                  i
                  =
                  1
                
                
                  N
                
              
              
                |
              
              
                c
                
                  x
                  ,
                  i
                
              
              
                
                  |
                
                
                  2
                
              
              +
              
                ∑
                
                  i
                  =
                  1
                
                
                  N
                
              
              
                |
              
              
                c
                
                  y
                  ,
                  i
                
              
              
                
                  |
                
                
                  2
                
              
              +
              K
            
          
        
        
          
            )
          
        
        
          
            (
          
        
        
          
            
              2
              
                |
              
              
                ∑
                
                  i
                  =
                  1
                
                
                  N
                
              
              
                c
                
                  x
                  ,
                  i
                
              
              
                c
                
                  y
                  ,
                  i
                
                
                  ∗
                
              
              
                |
              
              +
              K
            
            
              2
              
                ∑
                
                  i
                  =
                  1
                
                
                  N
                
              
              
                |
              
              
                c
                
                  x
                  ,
                  i
                
              
              
                c
                
                  y
                  ,
                  i
                
                
                  ∗
                
              
              
                |
              
              +
              K
            
          
        
        
          
            )
          
        
      
    
    {\displaystyle {\text{CW-SSIM}}(c_{x},c_{y})={\bigg (}{\frac {2\sum _{i=1}^{N}|c_{x,i}||c_{y,i}|+K}{\sum _{i=1}^{N}|c_{x,i}|^{2}+\sum _{i=1}^{N}|c_{y,i}|^{2}+K}}{\bigg )}{\bigg (}{\frac {2|\sum _{i=1}^{N}c_{x,i}c_{y,i}^{*}|+K}{2\sum _{i=1}^{N}|c_{x,i}c_{y,i}^{*}|+K}}{\bigg )}}
  

Where 
  
    
      
        
          c
          
            x
          
        
      
    
    {\displaystyle c_{x}}
  
 is the complex wavelet transform of the signal 
  
    
      
        x
      
    
    {\displaystyle x}
  
 and 
  
    
      
        
          c
          
            y
          
        
      
    
    {\displaystyle c_{y}}
  
 is the complex wavelet transform for the signal 
  
    
      
        y
      
    
    {\displaystyle y}
  
. Additionally, 
  
    
      
        K
      
    
    {\displaystyle K}
  
 is a small positive number used for the purposes of function stability. Ideally, it should be zero. Like the SSIM, the CW-SSIM has a maximum value of 1. The maximum value of 1 indicates that the two signals are perfectly structurally similar while a value of 0 indicates no structural similarity.


==== SSIMPLUS ====
The SSIMPLUS index is based on SSIM and is a commercially available tool. It extends SSIM's capabilities, mainly to target video applications. It provides scores in the range of 0–100, linearly matched to human subjective ratings. It also allows adapting the scores to the intended viewing device, comparing video across different resolutions and contents.
According to its authors, SSIMPLUS achieves higher accuracy and higher speed than other image and video quality metrics. However, no independent evaluation of SSIMPLUS has been performed, as the algorithm itself is not publicly available.


==== cSSIM ====
In order to further investigate the standard discrete SSIM from a theoretical perspective, the continuous SSIM (cSSIM) has been introduced and studied in the context of radial basis function interpolation.


=== SSIMULACRA ===
SSIMULACRA and SSIMULACRA2 are variants of SSIM developed by Cloudinary with the goal of fitted to subjective opinion data. The variants operate in XYB color space and combine MS-SSIM with two types of asymmetric error maps for blockiness/ringing and smoothing/blur, common compression artifacts. SSIMULACRA2 is part of libjxl, the reference implementation of JPEG XL.


==== Other simple modifications ====
The r* cross-correlation metric is based on the variance metrics of SSIM. It's defined as r*(x, y) = ⁠σxy/σxσy⁠ when σxσy ≠ 0, 1 when both standard deviations are zero, and 0 when only one is zero. It has found use in analyzing human response to contrast-detail phantoms.
SSIM has also been used on the gradient of images, making it "G-SSIM". G-SSIM is especially useful on blurred images.
The modifications above can be combined. For example, 4-G-r* is a combination of 4-SSIM, G-SSIM, and r*. It is able to reflect radiologist preference for images much better than other SSIM variants tested.


== Application ==
SSIM has applications in a variety of different problems.  Some examples are:

Image compression: In lossy image compression, information is deliberately discarded to decrease the storage space of images and video. The MSE is typically used in such compression schemes. According to its authors, using SSIM instead of MSE is suggested to produce better results for the decompressed images.
Image restoration: Image restoration focuses on solving the problem 
  
    
      
        y
        =
        h
        ∗
        x
        +
        n
      
    
    {\displaystyle y=h*x+n}
  
 where 
  
    
      
        y
      
    
    {\displaystyle y}
  
 is the blurry image that should be restored, 
  
    
      
        h
      
    
    {\displaystyle h}
  
 is the blur kernel, 
  
    
      
        n
      
    
    {\displaystyle n}
  
 is the additive noise and 
  
    
      
        x
      
    
    {\displaystyle x}
  
 is the original image we wish to recover. The traditional filter which is used to solve this problem is the Wiener Filter. However, the Wiener filter design is based on the MSE. Using an SSIM variant, specifically Stat-SSIM, is claimed to produce better visual results, according to the algorithm's authors.
Pattern recognition: Since SSIM mimics aspects of human perception, it could be used for recognizing patterns. When faced with issues like image scaling, translation and rotation, the algorithm's authors claim that it is better to use CW-SSIM, which is insensitive to these variations and may be directly applied by template matching without using any training sample. Since data-driven pattern recognition approaches may produce better performance when a large amount of data is available for training, the authors suggest using CW-SSIM in data-driven approaches.


== Performance comparison ==
Due to its popularity, SSIM is often compared to other metrics, including more simple metrics such as MSE and PSNR, and other perceptual image and video quality metrics. SSIM has been repeatedly shown to significantly outperform MSE and its derivates in accuracy, including research by its own authors and others.
A paper by Dosselmann and Yang claims that the performance of SSIM is "much closer to that of the MSE" than usually assumed. While they do not dispute the advantage of SSIM over MSE, they state an analytical and functional dependency between the two metrics. According to their research, SSIM has been found to correlate as well as MSE-based methods on subjective databases other than the databases from SSIM's creators. As an example, they cite Reibman and Poole, who found that MSE outperformed SSIM on a database containing packet-loss–impaired video. In another paper, an analytical link between PSNR and SSIM was identified.


== See also ==
Mean squared error
Peak signal-to-noise ratio
Video Multimethod Assessment Fusion (VMAF)
Video quality


== References ==


== External links ==
Home page
Rust Implementation
C/C++ Implementation
DSSIM C++ Implementation
Chris Lomont's C# Implementation
qpsnr implementation (multi threaded C++)
Implementation in VQMT software
Implementation in Python
"Mystery Behind Similarity Measures MSE and SSIM", Gintautas Palubinskas, 2014