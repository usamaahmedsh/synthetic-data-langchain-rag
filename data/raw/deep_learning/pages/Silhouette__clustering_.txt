Silhouette is a method of interpretation and validation of consistency within clusters of data. The technique provides a succinct graphical representation of how well each object has been classified. It was proposed by Belgian statistician Peter Rousseeuw in 1987.
The silhouette value is a measure of how similar an object is to its own cluster (cohesion) compared to other clusters (separation). The silhouette value ranges from −1 to +1, where a high value indicates that the object is well matched to its own cluster and poorly matched to neighboring clusters. If most objects have a high value, then the clustering configuration is appropriate. If many points have a low or negative value, then the clustering configuration may have too many or too few clusters. A clustering with an average silhouette width of over 0.7 is considered to be "strong", a value over 0.5 "reasonable", and over 0.25 "weak". However, with an increasing dimensionality of the data, it becomes difficult to achieve such high values because of the curse of dimensionality, as the distances become more similar.  The silhouette score is specialized for measuring cluster quality when the clusters are convex-shaped, and may not perform well if the data clusters have irregular shapes or are of varying sizes. The silhouette value can be calculated with any distance metric, such as Euclidean distance or Manhattan distance.
According to a scientific article published in PeerJ Computer Science in 2025, the Silhouette coefficient (along with the Davies-Bouldin index) can be more informative than other popular clustering internal metrics such as Dunn index, Calinski-Harabasz index, Shannon entropy, and Gap statistic when applied to convex-shaped clusters.


== Definition ==

Assume the data have been clustered via any technique, such as k-medoids or k-means, into 
  
    
      
        k
      
    
    {\displaystyle k}
  
 clusters.
For data point 
  
    
      
        i
        ∈
        
          C
          
            i
          
        
      
    
    {\displaystyle i\in C_{i}}
  
 (data point 
  
    
      
        i
      
    
    {\displaystyle i}
  
 in the cluster 
  
    
      
        
          C
          
            i
          
        
      
    
    {\displaystyle C_{i}}
  
), let

  
    
      
        a
        (
        i
        )
        =
        
          
            1
            
              
                |
              
              
                C
                
                  i
                
              
              
                |
              
              −
              1
            
          
        
        
          ∑
          
            j
            ∈
            
              C
              
                i
              
            
            ,
            i
            ≠
            j
          
        
        d
        (
        i
        ,
        j
        )
      
    
    {\displaystyle a(i)={\frac {1}{|C_{i}|-1}}\sum _{j\in C_{i},i\neq j}d(i,j)}
  

be the mean distance between 
  
    
      
        i
      
    
    {\displaystyle i}
  
 and all other data points in the same cluster, where 
  
    
      
        
          |
        
        
          C
          
            i
          
        
        
          |
        
      
    
    {\displaystyle |C_{i}|}
  
 is the number of points belonging to cluster 
  
    
      
        
          C
          
            i
          
        
      
    
    {\displaystyle C_{i}}
  
, and 
  
    
      
        d
        (
        i
        ,
        j
        )
      
    
    {\displaystyle d(i,j)}
  
 is the distance between data points 
  
    
      
        i
      
    
    {\displaystyle i}
  
 and 
  
    
      
        j
      
    
    {\displaystyle j}
  
 in the cluster 
  
    
      
        
          C
          
            i
          
        
      
    
    {\displaystyle C_{i}}
  
 (we divide by 
  
    
      
        
          |
        
        
          C
          
            i
          
        
        
          |
        
        −
        1
      
    
    {\displaystyle |C_{i}|-1}
  
 because the distance 
  
    
      
        d
        (
        i
        ,
        i
        )
      
    
    {\displaystyle d(i,i)}
  
 is not included in the sum). 
  
    
      
        a
        (
        i
        )
      
    
    {\displaystyle a(i)}
  
 can be interpreted as a measure of how well 
  
    
      
        i
      
    
    {\displaystyle i}
  
 is assigned to its cluster (the smaller the value, the better the assignment).
We then define the mean dissimilarity of point 
  
    
      
        i
      
    
    {\displaystyle i}
  
 to some cluster 
  
    
      
        
          C
          
            j
          
        
      
    
    {\displaystyle C_{j}}
  
 as the mean of the distance from 
  
    
      
        i
      
    
    {\displaystyle i}
  
 to all points in 
  
    
      
        
          C
          
            j
          
        
      
    
    {\displaystyle C_{j}}
  
 (where 
  
    
      
        
          C
          
            j
          
        
        ≠
        
          C
          
            i
          
        
      
    
    {\displaystyle C_{j}\neq C_{i}}
  
).
For each data point 
  
    
      
        i
        ∈
        
          C
          
            i
          
        
      
    
    {\displaystyle i\in C_{i}}
  
, we now define

  
    
      
        b
        (
        i
        )
        =
        
          min
          
            j
            ≠
            i
          
        
        
          
            1
            
              
                |
              
              
                C
                
                  j
                
              
              
                |
              
            
          
        
        
          ∑
          
            j
            ∈
            
              C
              
                j
              
            
          
        
        d
        (
        i
        ,
        j
        )
      
    
    {\displaystyle b(i)=\min _{j\neq i}{\frac {1}{|C_{j}|}}\sum _{j\in C_{j}}d(i,j)}
  

to be the smallest (hence the 
  
    
      
        min
      
    
    {\displaystyle \min }
  
 operator in the formula) mean distance of 
  
    
      
        i
      
    
    {\displaystyle i}
  
 to all points in any other cluster (i.e., in any cluster of which 
  
    
      
        i
      
    
    {\displaystyle i}
  
 is not a member). The cluster with the smallest mean dissimilarity is said to be the "neighboring cluster" of 
  
    
      
        i
      
    
    {\displaystyle i}
  
 because it is the next best fit cluster for point 
  
    
      
        i
      
    
    {\displaystyle i}
  
.
We now define a silhouette (value) of one data point 
  
    
      
        i
      
    
    {\displaystyle i}
  

  
    
      
        s
        (
        i
        )
        =
        
          
            
              b
              (
              i
              )
              −
              a
              (
              i
              )
            
            
              max
              {
              a
              (
              i
              )
              ,
              b
              (
              i
              )
              }
            
          
        
      
    
    {\displaystyle s(i)={\frac {b(i)-a(i)}{\max\{a(i),b(i)\}}}}
  
, if 
  
    
      
        
          |
        
        
          C
          
            i
          
        
        
          |
        
        >
        1
      
    
    {\displaystyle |C_{i}|>1}
  

and

  
    
      
        s
        (
        i
        )
        =
        0
      
    
    {\displaystyle s(i)=0}
  
, if 
  
    
      
        
          |
        
        
          C
          
            i
          
        
        
          |
        
        =
        1
      
    
    {\displaystyle |C_{i}|=1}
  
,
which can also be written as

  
    
      
        s
        (
        i
        )
        =
        
          
            {
            
              
                
                  1
                  −
                  
                    
                      
                        a
                        (
                        i
                        )
                      
                      
                        b
                        (
                        i
                        )
                      
                    
                  
                  ,
                
                
                  
                    
                       if 
                    
                  
                  a
                  (
                  i
                  )
                  <
                  b
                  (
                  i
                  )
                
              
              
                
                  0
                  ,
                
                
                  
                    
                      if 
                    
                  
                  a
                  (
                  i
                  )
                  =
                  b
                  (
                  i
                  )
                
              
              
                
                  
                    
                      
                        b
                        (
                        i
                        )
                      
                      
                        a
                        (
                        i
                        )
                      
                    
                  
                  −
                  1
                  ,
                
                
                  
                    
                       if 
                    
                  
                  a
                  (
                  i
                  )
                  >
                  b
                  (
                  i
                  )
                
              
            
            
          
        
      
    
    {\displaystyle s(i)={\begin{cases}1-{\frac {a(i)}{b(i)}},&{\mbox{ if }}a(i)<b(i)\\0,&{\mbox{if }}a(i)=b(i)\\{\frac {b(i)}{a(i)}}-1,&{\mbox{ if }}a(i)>b(i)\\\end{cases}}}
  

From the above definition, 
  
    
      
        s
        (
        i
        )
      
    
    {\displaystyle s(i)}
  
 is bounded to the interval 
  
    
      
        [
        −
        1
        ,
        1
        ]
      
    
    {\displaystyle [-1,1]}
  
, i.e. 
  
    
      
        −
        1
        ≤
        s
        (
        i
        )
        ≤
        1.
      
    
    {\displaystyle -1\leq s(i)\leq 1.}
  

Note that 
  
    
      
        a
        (
        i
        )
      
    
    {\displaystyle a(i)}
  
 is not clearly defined for clusters with size = 1, in which case we set 
  
    
      
        s
        (
        i
        )
        =
        0
      
    
    {\displaystyle s(i)=0}
  
. This choice is arbitrary, but neutral in the sense that it is at the midpoint of the bounds, -1 and 1.
For 
  
    
      
        s
        (
        i
        )
      
    
    {\displaystyle s(i)}
  
 to be close to 1 we require 
  
    
      
        a
        (
        i
        )
        ≪
        b
        (
        i
        )
      
    
    {\displaystyle a(i)\ll b(i)}
  
. As 
  
    
      
        a
        (
        i
        )
      
    
    {\displaystyle a(i)}
  
 is a measure of how dissimilar 
  
    
      
        i
      
    
    {\displaystyle i}
  
 is to its own cluster, a small value means it is well matched. Furthermore, a large 
  
    
      
        b
        (
        i
        )
      
    
    {\displaystyle b(i)}
  
 implies that 
  
    
      
        i
      
    
    {\displaystyle i}
  
 is badly matched to its neighbouring cluster. Thus an 
  
    
      
        s
        (
        i
        )
      
    
    {\displaystyle s(i)}
  
 close to 1 means that the data is appropriately clustered. If 
  
    
      
        s
        (
        i
        )
      
    
    {\displaystyle s(i)}
  
 is close to -1, then by the same logic we see that 
  
    
      
        i
      
    
    {\displaystyle i}
  
 would be more appropriate if it was clustered in its neighbouring cluster. An 
  
    
      
        s
        (
        i
        )
      
    
    {\displaystyle s(i)}
  
 near zero means that the datum is on the border of two natural clusters.
The mean 
  
    
      
        s
        (
        i
        )
      
    
    {\displaystyle s(i)}
  
 over all points of a cluster is a measure of how tightly grouped all the points in the cluster are. Thus the mean 
  
    
      
        s
        (
        i
        )
      
    
    {\displaystyle s(i)}
  
 over all data of the entire dataset is a measure of how appropriately the data have been clustered. If there are too many or too few clusters, as may occur when a poor choice of 
  
    
      
        k
      
    
    {\displaystyle k}
  
 is used in the clustering algorithm (e.g., k-means), some of the clusters will typically display much narrower silhouettes than the rest. Thus silhouette plots and means may be used to determine the natural number of clusters within a dataset. One can also increase the likelihood of the silhouette being maximized at the correct number of clusters by re-scaling the data using feature weights that are cluster specific.
Kaufman et al. introduced the term silhouette coefficient for the maximum value of the mean 
  
    
      
        s
        (
        i
        )
      
    
    {\displaystyle s(i)}
  
 over all data of the entire dataset, i.e.,

  
    
      
        S
        C
        =
        
          max
          
            k
          
        
        
          
            
              s
              ~
            
          
        
        
          (
          k
          )
        
        ,
      
    
    {\displaystyle SC=\max _{k}{\tilde {s}}\left(k\right),}
  

where 
  
    
      
        
          
            
              s
              ~
            
          
        
        
          (
          k
          )
        
      
    
    {\displaystyle {\tilde {s}}\left(k\right)}
  
 represents the mean 
  
    
      
        s
        (
        i
        )
      
    
    {\displaystyle s(i)}
  
 over all data of the entire dataset for a specific number of clusters 
  
    
      
        k
      
    
    {\displaystyle k}
  
.


== Simplified Silhouette and Medoid Silhouette ==
Computing the silhouette coefficient needs all 
  
    
      
        
          
            O
          
        
        (
        
          N
          
            2
          
        
        )
      
    
    {\displaystyle {\mathcal {O}}(N^{2})}
  
 pairwise distances, making this evaluation much more costly than clustering with k-means. For a clustering with centers 
  
    
      
        
          μ
          
            
              C
              
                I
              
            
          
        
      
    
    {\displaystyle \mu _{C_{I}}}
  
 for each cluster 
  
    
      
        
          C
          
            I
          
        
      
    
    {\displaystyle C_{I}}
  
, we can use the following simplified Silhouette for each point 
  
    
      
        i
        ∈
        
          C
          
            I
          
        
      
    
    {\displaystyle i\in C_{I}}
  
 instead, which can be computed using only 
  
    
      
        
          
            O
          
        
        (
        N
        k
        )
      
    
    {\displaystyle {\mathcal {O}}(Nk)}
  
 distances:

  
    
      
        
          a
          ′
        
        (
        i
        )
        =
        d
        (
        i
        ,
        
          μ
          
            
              C
              
                I
              
            
          
        
        )
      
    
    {\displaystyle a'(i)=d(i,\mu _{C_{I}})}
  
 and 
  
    
      
        
          b
          ′
        
        (
        i
        )
        =
        
          min
          
            
              C
              
                J
              
            
            ≠
            
              C
              
                I
              
            
          
        
        d
        (
        i
        ,
        
          μ
          
            
              C
              
                J
              
            
          
        
        )
      
    
    {\displaystyle b'(i)=\min _{C_{J}\neq C_{I}}d(i,\mu _{C_{J}})}
  
,
which has the additional benefit that 
  
    
      
        
          a
          ′
        
        (
        i
        )
      
    
    {\displaystyle a'(i)}
  
 is always defined, then define accordingly the simplified silhouette and simplified silhouette coefficient

  
    
      
        
          s
          ′
        
        (
        i
        )
        =
        
          
            
              
                b
                ′
              
              (
              i
              )
              −
              
                a
                ′
              
              (
              i
              )
            
            
              max
              {
              
                a
                ′
              
              (
              i
              )
              ,
              
                b
                ′
              
              (
              i
              )
              }
            
          
        
      
    
    {\displaystyle s'(i)={\frac {b'(i)-a'(i)}{\max\{a'(i),b'(i)\}}}}
  

  
    
      
        S
        
          C
          ′
        
        =
        
          max
          
            k
          
        
        
          
            1
            N
          
        
        
          ∑
          
            i
          
        
        
          s
          ′
        
        
          (
          i
          )
        
      
    
    {\displaystyle SC'=\max _{k}{\frac {1}{N}}\sum _{i}s'\left(i\right)}
  
.
If the cluster centers are medoids (as in k-medoids clustering) instead of arithmetic means (as in k-means clustering), this is also called the medoid-based silhouette or medoid silhouette.
If every object is assigned to the nearest medoid (as in k-medoids clustering), we know that 
  
    
      
        
          a
          ′
        
        (
        i
        )
        ≤
        
          b
          ′
        
        (
        i
        )
      
    
    {\displaystyle a'(i)\leq b'(i)}
  
, and hence 
  
    
      
        
          s
          ′
        
        (
        i
        )
        =
        
          
            
              
                b
                ′
              
              (
              i
              )
              −
              
                a
                ′
              
              (
              i
              )
            
            
              
                b
                ′
              
              (
              i
              )
            
          
        
        =
        1
        −
        
          
            
              
                a
                ′
              
              (
              i
              )
            
            
              
                b
                ′
              
              (
              i
              )
            
          
        
      
    
    {\displaystyle s'(i)={\frac {b'(i)-a'(i)}{b'(i)}}=1-{\frac {a'(i)}{b'(i)}}}
  
.


== Silhouette Clustering ==
Instead of using the average silhouette to evaluate a clustering obtained from, e.g., k-medoids or k-means, we can try to directly find a solution that maximizes the Silhouette. We do not have a closed form solution to maximize this, but it will usually be best to assign points to the nearest cluster as done by these methods. Van der Laan et al. proposed to adapt the standard algorithm for k-medoids, PAM, for this purpose and call this algorithm PAMSIL:

Choose initial medoids by using PAM
Compute the average silhouette of this initial solution
For each pair of a medoid m and a non-medoid x
swap m and x
compute the average silhouette of the resulting solution
remember the best swap
un-swap m and x for the next iteration
Perform the best swap and return to 3, otherwise stop if no improvement was found.
The loop in step 3 is executed for 
  
    
      
        
          
            O
          
        
        (
        N
        k
        )
      
    
    {\displaystyle {\mathcal {O}}(Nk)}
  
 pairs, and involves computing the silhouette in 
  
    
      
        
          
            O
          
        
        (
        
          N
          
            2
          
        
        )
      
    
    {\displaystyle {\mathcal {O}}(N^{2})}
  
, hence this algorithm needs 
  
    
      
        
          
            O
          
        
        (
        
          N
          
            3
          
        
        k
        i
        )
      
    
    {\displaystyle {\mathcal {O}}(N^{3}ki)}
  
 time, where i is the number of iterations.
Because this is a fairly expensive operation, the authors propose to also use the medoid-based silhouette, and call the resulting algorithm PAMMEDSIL. It needs 
  
    
      
        
          
            O
          
        
        (
        
          N
          
            2
          
        
        
          k
          
            2
          
        
        i
        )
      
    
    {\displaystyle {\mathcal {O}}(N^{2}k^{2}i)}
  
 time.
Batool et al. propose a similar algorithm under the name OSil, and propose a CLARA-like sampling strategy for larger data sets, that solves the problem only for a sub-sample.
By adopting recent improvements to the PAM algorithm, FastMSC reduces the runtime using the medoid silhouette to just 
  
    
      
        
          
            O
          
        
        (
        
          N
          
            2
          
        
        i
        )
      
    
    {\displaystyle {\mathcal {O}}(N^{2}i)}
  
.
By starting with a maximum number of clusters  kmax and iteratively removing the worst center (in terms of a change in silhouette) and re-optimizing, the best (highest medoid silhouette) clustering can be automatically determined. As data structures can be reused, this reduces the computation cost substantially over repeatedly running the algorithm for different numbers of clusters.
This algorithm needs pairwise distances and is typically implemented with a pairwise distance matrix. The 
  
    
      
        
          
            O
          
        
        (
        
          N
          
            2
          
        
        )
      
    
    {\displaystyle {\mathcal {O}}(N^{2})}
  
 memory requirement is the main limiting factor for applying this to very large data sets.


== See also ==
Cluster analysis
Davies–Bouldin index
Calinski-Harabasz index
Dunn index
Determining the number of clusters in a data set
Density-based clustering validation


== Further reading ==
Rousseeuw, Peter J. (1987). "Silhouettes: a Graphical Aid to the Interpretation and Validation of Cluster Analysis". Computational and Applied Mathematics. 20: 53–65. doi:10.1016/0377-0427(87)90125-7.
Chicco, Davide; Campagner, Andrea; Spagnolo, Andrea; Ciucci, Davide; Jurman, Giuseppe (2025). "The Silhouette coefficient and the Davies-Bouldin index are more informative than Dunn index, Calinski-Harabasz index, Shannon entropy, and Gap statistic for unsupervised clustering internal evaluation of two convex clusters". PeerJ Computer Science. 11 (e3309): 1–49. doi:10.7717/peerj-cs.3309.


== References ==