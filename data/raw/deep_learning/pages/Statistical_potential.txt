In protein structure prediction, statistical potentials or knowledge-based potentials are scoring functions derived from an analysis of known protein structures in the Protein Data Bank (PDB).
The original method to obtain such potentials is the quasi-chemical approximation, due to Miyazawa and Jernigan. It was later followed by the potential of mean force (statistical PMF ), developed by Sippl. Although the obtained scores are often considered as approximations of the free energy—thus referred to as pseudo-energies—this physical interpretation is incorrect. Nonetheless, they are applied with success in many cases, because they frequently correlate with actual Gibbs free energy differences.


== Overview ==
Possible features to which a pseudo-energy can be assigned include:

interatomic distances,
torsion angles,
solvent exposure,
or hydrogen bond geometry.
The classic application is, however, based on pairwise amino acid contacts or distances, thus producing statistical interatomic potentials. For pairwise amino acid contacts, a statistical potential is formulated as an interaction matrix that assigns a weight or energy value to each possible pair of standard amino acids. The energy of a particular structural model is then the combined energy of all pairwise contacts (defined as two amino acids within a certain distance of each other) in the structure. The energies are determined using statistics on amino acid contacts in a database of known protein structures (obtained from the PDB).


== History ==


=== Initial development ===
Many textbooks present the statistical PMFs as proposed by Sippl  as a simple consequence of the Boltzmann distribution, as applied to pairwise distances between amino acids. This is incorrect, but a useful start to introduce the construction of the potential in practice.
The Boltzmann distribution applied to a specific pair of amino acids,
is given by:

  
    
      
        P
        
          (
          r
          )
        
        =
        
          
            1
            Z
          
        
        
          e
          
            −
            
              
                
                  F
                  
                    (
                    r
                    )
                  
                
                
                  k
                  T
                
              
            
          
        
      
    
    {\displaystyle P\left(r\right)={\frac {1}{Z}}e^{-{\frac {F\left(r\right)}{kT}}}}
  

where 
  
    
      
        r
      
    
    {\displaystyle r}
  
 is the distance, 
  
    
      
        k
      
    
    {\displaystyle k}
  
 is the Boltzmann constant, 
  
    
      
        T
      
    
    {\displaystyle T}
  
 is
the temperature and 
  
    
      
        Z
      
    
    {\displaystyle Z}
  
 is the partition function, with

  
    
      
        Z
        =
        ∫
        
          e
          
            −
            
              
                
                  F
                  (
                  r
                  )
                
                
                  k
                  T
                
              
            
          
        
        d
        r
      
    
    {\displaystyle Z=\int e^{-{\frac {F(r)}{kT}}}dr}
  

The quantity 
  
    
      
        F
        (
        r
        )
      
    
    {\displaystyle F(r)}
  
 is the free energy assigned to the pairwise system.
Simple rearrangement results in the inverse Boltzmann formula,
which expresses the free energy 
  
    
      
        F
        (
        r
        )
      
    
    {\displaystyle F(r)}
  
 as a function of 
  
    
      
        P
        (
        r
        )
      
    
    {\displaystyle P(r)}
  
:

  
    
      
        F
        
          (
          r
          )
        
        =
        −
        k
        T
        ln
        ⁡
        P
        
          (
          r
          )
        
        −
        k
        T
        ln
        ⁡
        Z
      
    
    {\displaystyle F\left(r\right)=-kT\ln P\left(r\right)-kT\ln Z}
  

To construct a PMF, one then introduces a so-called reference state with a corresponding distribution 
  
    
      
        
          Q
          
            R
          
        
      
    
    {\displaystyle Q_{R}}
  
 and partition function

  
    
      
        
          Z
          
            R
          
        
      
    
    {\displaystyle Z_{R}}
  
, and calculates the following free energy difference:

  
    
      
        Δ
        F
        
          (
          r
          )
        
        =
        −
        k
        T
        ln
        ⁡
        
          
            
              P
              
                (
                r
                )
              
            
            
              
                Q
                
                  R
                
              
              
                (
                r
                )
              
            
          
        
        −
        k
        T
        ln
        ⁡
        
          
            Z
            
              Z
              
                R
              
            
          
        
      
    
    {\displaystyle \Delta F\left(r\right)=-kT\ln {\frac {P\left(r\right)}{Q_{R}\left(r\right)}}-kT\ln {\frac {Z}{Z_{R}}}}
  

The reference state typically results from a hypothetical
system in which the specific interactions between the amino acids
are absent. The second term involving 
  
    
      
        Z
      
    
    {\displaystyle Z}
  
 and

  
    
      
        
          Z
          
            R
          
        
      
    
    {\displaystyle Z_{R}}
  
 can be ignored, as it is a constant.
In practice, 
  
    
      
        P
        (
        r
        )
      
    
    {\displaystyle P(r)}
  
 is estimated from the database of known protein
structures, while 
  
    
      
        
          Q
          
            R
          
        
        (
        r
        )
      
    
    {\displaystyle Q_{R}(r)}
  
 typically results from calculations
or simulations. For example, 
  
    
      
        P
        (
        r
        )
      
    
    {\displaystyle P(r)}
  
 could be the conditional probability
of finding the 
  
    
      
        C
        β
      
    
    {\displaystyle C\beta }
  
 atoms of a valine and a serine at a given
distance 
  
    
      
        r
      
    
    {\displaystyle r}
  
 from each other, giving rise to the free energy difference

  
    
      
        Δ
        F
      
    
    {\displaystyle \Delta F}
  
. The total free energy difference of a protein,

  
    
      
        Δ
        
          F
          
            
              T
            
          
        
      
    
    {\displaystyle \Delta F_{\textrm {T}}}
  
, is then claimed to be the sum
of all the pairwise free energies:

where the sum runs over all amino acid pairs 
  
    
      
        
          a
          
            i
          
        
        ,
        
          a
          
            j
          
        
      
    
    {\displaystyle a_{i},a_{j}}
  

(with 
  
    
      
        i
        <
        j
      
    
    {\displaystyle i<j}
  
) and 
  
    
      
        
          r
          
            i
            j
          
        
      
    
    {\displaystyle r_{ij}}
  
 is their corresponding distance. In many studies 
  
    
      
        
          Q
          
            R
          
        
      
    
    {\displaystyle Q_{R}}
  
 does not depend on the amino acid sequence.


=== Conceptual issues ===
Intuitively, it is clear that a low value for 
  
    
      
        Δ
        
          F
          
            
              T
            
          
        
      
    
    {\displaystyle \Delta F_{\textrm {T}}}
  
 indicates
that the set of distances in a structure is more likely in proteins than
in the reference state. However, the physical meaning of these statistical PMFs has
been widely disputed, since their introduction. The main issues are:

The wrong interpretation of this "potential" as a true, physically valid potential of mean force;
The nature of the so-called reference state and its optimal formulation;
The validity of generalizations beyond pairwise distances.


==== Controversial analogy ====
In response to the issue regarding the physical validity, the first justification of statistical PMFs was attempted by Sippl. It was based on an analogy with the statistical physics of liquids. For liquids, the potential of mean force is related to the radial distribution function 
  
    
      
        g
        (
        r
        )
      
    
    {\displaystyle g(r)}
  
, which is given by:

  
    
      
        g
        (
        r
        )
        =
        
          
            
              P
              (
              r
              )
            
            
              
                Q
                
                  R
                
              
              (
              r
              )
            
          
        
      
    
    {\displaystyle g(r)={\frac {P(r)}{Q_{R}(r)}}}
  

where 
  
    
      
        P
        (
        r
        )
      
    
    {\displaystyle P(r)}
  
 and 
  
    
      
        
          Q
          
            R
          
        
        (
        r
        )
      
    
    {\displaystyle Q_{R}(r)}
  
 are the respective probabilities of
finding two particles at a distance 
  
    
      
        r
      
    
    {\displaystyle r}
  
 from each other in the liquid
and in the reference state. For liquids, the reference state
is clearly defined; it corresponds to the ideal gas, consisting of
non-interacting particles. The two-particle potential of mean force

  
    
      
        W
        (
        r
        )
      
    
    {\displaystyle W(r)}
  
 is related to 
  
    
      
        g
        (
        r
        )
      
    
    {\displaystyle g(r)}
  
 by:

  
    
      
        W
        (
        r
        )
        =
        −
        k
        T
        log
        ⁡
        g
        (
        r
        )
        =
        −
        k
        T
        log
        ⁡
        
          
            
              P
              (
              r
              )
            
            
              
                Q
                
                  R
                
              
              (
              r
              )
            
          
        
      
    
    {\displaystyle W(r)=-kT\log g(r)=-kT\log {\frac {P(r)}{Q_{R}(r)}}}
  

According to the reversible work theorem, the two-particle
potential of mean force 
  
    
      
        W
        (
        r
        )
      
    
    {\displaystyle W(r)}
  
 is the reversible work required to
bring two particles in the liquid from infinite separation to a distance

  
    
      
        r
      
    
    {\displaystyle r}
  
 from each other.
Sippl justified the use of statistical PMFs—a few years after he introduced
them for use in protein structure prediction—by
appealing to the analogy with the reversible work theorem for liquids. For liquids, 
  
    
      
        g
        (
        r
        )
      
    
    {\displaystyle g(r)}
  
 can be experimentally measured
using small angle X-ray scattering; for proteins, 
  
    
      
        P
        (
        r
        )
      
    
    {\displaystyle P(r)}
  
 is obtained
from the set of known protein structures, as explained in the previous
section. However, as Ben-Naim wrote in a publication on the subject:

[...] the quantities, referred to as "statistical potentials," "structure
based potentials," or "pair potentials of mean force", as derived from
the protein data bank (PDB), are neither "potentials" nor "potentials of
mean force," in the ordinary sense as used in the literature on
liquids and solutions.

Moreover, this analogy does not solve the issue of how to specify a suitable reference state for proteins.


=== Machine learning ===
In the mid-2000s, authors started to combine multiple statistical potentials, derived from different structural features, into composite scores. For that purpose, they used machine learning techniques, such as support vector machines (SVMs). Probabilistic neural networks (PNNs) have also been applied for the training of a position-specific distance-dependent statistical potential. In 2016, the DeepMind artificial intelligence research laboratory started to apply deep learning techniques to the development of a torsion- and distance-dependent statistical potential. The resulting method, named AlphaFold, won the 13th Critical Assessment of Techniques for Protein Structure Prediction (CASP) by correctly predicting the most accurate structure for 25 out of 43 free modelling domains.


== Explanation ==


=== Bayesian probability ===
Baker and co-workers  justified statistical PMFs from a
Bayesian point of view and used these insights in the construction of
the coarse grained ROSETTA energy function.  According
to Bayesian probability calculus, the conditional probability 
  
    
      
        P
        (
        X
        ∣
        A
        )
      
    
    {\displaystyle P(X\mid A)}
  
 of a structure 
  
    
      
        X
      
    
    {\displaystyle X}
  
, given the amino acid sequence 
  
    
      
        A
      
    
    {\displaystyle A}
  
, can be
written as:

  
    
      
        P
        
          (
          
            X
            ∣
            A
          
          )
        
        =
        
          
            
              P
              
                (
                
                  A
                  ∣
                  X
                
                )
              
              P
              
                (
                X
                )
              
            
            
              P
              
                (
                A
                )
              
            
          
        
        ∝
        P
        
          (
          
            A
            ∣
            X
          
          )
        
        P
        
          (
          X
          )
        
      
    
    {\displaystyle P\left(X\mid A\right)={\frac {P\left(A\mid X\right)P\left(X\right)}{P\left(A\right)}}\propto P\left(A\mid X\right)P\left(X\right)}
  

  
    
      
        P
        (
        X
        ∣
        A
        )
      
    
    {\displaystyle P(X\mid A)}
  
 is proportional to the product of
the likelihood 
  
    
      
        P
        
          (
          
            A
            ∣
            X
          
          )
        
      
    
    {\displaystyle P\left(A\mid X\right)}
  
 times the prior

  
    
      
        P
        
          (
          X
          )
        
      
    
    {\displaystyle P\left(X\right)}
  
. By assuming that the likelihood can be approximated
as a product of pairwise probabilities, and applying Bayes' theorem, the
likelihood can be written as:

where the product runs over all amino acid pairs 
  
    
      
        
          a
          
            i
          
        
        ,
        
          a
          
            j
          
        
      
    
    {\displaystyle a_{i},a_{j}}
  
 (with

  
    
      
        i
        <
        j
      
    
    {\displaystyle i<j}
  
), and 
  
    
      
        
          r
          
            i
            j
          
        
      
    
    {\displaystyle r_{ij}}
  
 is the distance between amino acids 
  
    
      
        i
      
    
    {\displaystyle i}
  
 and 
  
    
      
        j
      
    
    {\displaystyle j}
  
.
Obviously, the negative of the logarithm of the expression
has the same functional form as the classic
pairwise distance statistical PMFs, with the denominator playing the role of the
reference state. This explanation has two shortcomings: it relies on the unfounded assumption the likelihood can be expressed
as a product of pairwise probabilities, and it is purely qualitative.


=== Probability kinematics ===
Hamelryck and co-workers  later gave a quantitative explanation for the statistical potentials, according to which they approximate a form of probabilistic reasoning due to Richard Jeffrey and named probability kinematics. This variant of Bayesian thinking (sometimes called "Jeffrey conditioning") allows updating a prior distribution based on new information on the probabilities of the elements of a partition on the support of the prior. From this point of view, (i) it is not necessary to assume that the database of protein structures—used to build the potentials—follows a Boltzmann distribution, (ii) statistical potentials generalize readily beyond pairwise differences, and (iii) the reference ratio is determined by the prior distribution.


==== Reference ratio ====

Expressions that resemble statistical PMFs naturally result from the application of
probability theory to solve a fundamental problem that arises in protein
structure prediction: how to improve an imperfect probability
distribution 
  
    
      
        Q
        (
        X
        )
      
    
    {\displaystyle Q(X)}
  
 over a first variable 
  
    
      
        X
      
    
    {\displaystyle X}
  
 using a probability
distribution 
  
    
      
        P
        (
        Y
        )
      
    
    {\displaystyle P(Y)}
  
 over a second variable 
  
    
      
        Y
      
    
    {\displaystyle Y}
  
, with 
  
    
      
        Y
        =
        f
        (
        X
        )
      
    
    {\displaystyle Y=f(X)}
  
. Typically, 
  
    
      
        X
      
    
    {\displaystyle X}
  
 and 
  
    
      
        Y
      
    
    {\displaystyle Y}
  
 are fine and coarse grained variables, respectively. For example, 
  
    
      
        Q
        (
        X
        )
      
    
    {\displaystyle Q(X)}
  
 could concern
the local structure of the protein, while 
  
    
      
        P
        (
        Y
        )
      
    
    {\displaystyle P(Y)}
  
 could concern the pairwise distances between the amino acids. In that case, 
  
    
      
        X
      
    
    {\displaystyle X}
  
 could for example be a vector of dihedral angles that specifies all atom positions (assuming ideal bond lengths and angles).
In order to combine the two distributions, such that the local structure will be distributed according to 
  
    
      
        Q
        (
        X
        )
      
    
    {\displaystyle Q(X)}
  
, while
the pairwise distances will be distributed according to 
  
    
      
        P
        (
        Y
        )
      
    
    {\displaystyle P(Y)}
  
, the following expression is needed:

  
    
      
        P
        (
        X
        ,
        Y
        )
        =
        
          
            
              P
              (
              Y
              )
            
            
              Q
              (
              Y
              )
            
          
        
        Q
        (
        X
        )
      
    
    {\displaystyle P(X,Y)={\frac {P(Y)}{Q(Y)}}Q(X)}
  

where 
  
    
      
        Q
        (
        Y
        )
      
    
    {\displaystyle Q(Y)}
  
 is the distribution over 
  
    
      
        Y
      
    
    {\displaystyle Y}
  
 implied by 
  
    
      
        Q
        (
        X
        )
      
    
    {\displaystyle Q(X)}
  
. The ratio in the expression corresponds 
to the PMF. Typically, 
  
    
      
        Q
        (
        X
        )
      
    
    {\displaystyle Q(X)}
  
 is brought in by sampling (typically from a fragment library), and not explicitly evaluated; the ratio, which in contrast is explicitly evaluated, corresponds to Sippl's PMF. This explanation is quantitive, and allows the generalization of statistical PMFs from pairwise distances to arbitrary coarse grained variables. It also 
provides a rigorous definition of the reference state, which is implied by 
  
    
      
        Q
        (
        X
        )
      
    
    {\displaystyle Q(X)}
  
. Conventional applications of pairwise distance statistical PMFs usually lack two
necessary features to make them fully rigorous: the use of a proper probability distribution over pairwise distances in proteins, and the recognition that the reference state is rigorously
defined by 
  
    
      
        Q
        (
        X
        )
      
    
    {\displaystyle Q(X)}
  
.


== Applications ==
Statistical potentials are used as energy functions in the assessment of an ensemble of structural models produced by homology modeling or protein threading. Many differently parameterized statistical potentials have been shown to successfully identify the native state structure from an ensemble of decoy or non-native structures. Statistical potentials are not only used for protein structure prediction, but also for modelling the protein folding pathway.


== See also ==
Scoring functions for docking
Discrete optimized protein energy
CASP
CAMEO3D
Lennard-Jones potential
Bond order potential


== Notes ==


== References ==