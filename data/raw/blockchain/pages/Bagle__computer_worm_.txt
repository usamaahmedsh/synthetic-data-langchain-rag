Bagle (also known as Beagle) was a mass-mailing computer worm affecting Microsoft Windows. The first strain, Bagle.A, did not propagate widely. A second variant, Bagle.B, was considerably more virulent.


== Overview ==
Bagle used its own SMTP engine to mass-mail itself as an attachment to recipients gathered from the infected computer by combing through all of the computer's .htm, .html, .txt, and .wab files for any email addresses. It does not mail itself to addresses containing certain strings such as "@hotmail.com", "@msn.com", "@microsoft", "@avp", or “.r1”. Bagle pretends to be a different file type (a 15,872 byte Windows Calculator for Bagle.A and an 11,264 byte audio file for Bagle.B), with a randomized name, and it will then open that file type as a cover for opening its own .exe file. It copies itself to the Windows system directory (Bagle.A as bbeagle.exe, Bagle.B as au.exe), adds HKCU run keys to the registry, and opens a backdoor on a TCP port (6777 for Bagle.A and 8866 for Bagle.B). Using an HTTP GET request, Bagle.B also informs the virus's programmer that the machine has been successfully infected. Bagle variants, including Bagle.A and Bagle.B, generally have a date at which they stop spreading included in their programming. Computers infected with older versions of Bagle are updated when newer ones are released.


== History ==
The initial strain, Bagle.A, was first sighted on January 18, 2004, seemingly originating in Australia. The original file name for the Bagle virus was Beagle, but computer scientists decided to call it Bagle instead as a way to spite Bagle's programmer. Although it started strong with more than 120,000 infected computers, it quickly dwindled in efficacy. Sometimes accompanied by Trojan.Mitglieder.C, it stopped spreading after January 28, 2004, as designed.
The second strain, Bagle.B, was first sighted on February 17, 2004. It was much more widespread and appeared in large numbers; Network Associates rated it a "medium" threat. It was designed to stop spreading after February 25, 2004.
At one point in 2004, the Bagle and Netsky viruses exchanged insults and harsh words with each other in their codes, beginning with Bagle.I on March 3, 2004. Notably, Bagle.J contained the message “Hey, NetSky, fuck off you bitch, don't ruine our bussiness, wanna start a war?”, and Netsky-R included, "Yes, true, you have understand it. Bagle is a shitty guy, he opens a backdoor and he makes a lot of money. Netsky not, Netsky is Skynet, a good software, Good guys behind it. Believe me, or not. We will release thousands of our Skynet versions, as long as bagle is there ...". Additionally, Bagle and Netsky both tried to remove each other from an infected system.
Subsequent variants have later been discovered.  By July 26, 2004, there were 35 variants of Bagle, and by April 22, 2005, that number had increased to over 100. Although they have not all been successful, a number remain notable threats. Additionally, on July 3 and 4, 2004, Bagle.AD and Bagle.AE were released, with the source code for the virus, written in Assembly, visibly appearing in both of them.
Some of these variants contain the following text: 

    "Greetz to antivirus companies
     In a difficult world, 
     In a nameless time, 
     I want to survive, 
     So, you will be mine!! 
     -- Bagle Author, 29.04.04, Germany."

This has led some to believe that the worm originated in Germany.
Since 2004, the threat risk from these variants has been changed to "low" due to decreased prevalence. However, Windows users are warned to watch out for it.


== Botnet ==
The Bagle botnet (Initial discovery early 2004), also known by its aliases Beagle, Mitglieder and Lodeight, is a botnet mostly involved in proxy-to-relay e-mail spam.
The Bagle botnet consists of an estimated 150,000-230,000 computers infected with the Bagle Computer worm. It was estimated that the botnet was responsible for about 10.39% of the worldwide spam volume on December 29, 2009, with a surge up to 14% on New Year's Day, though the actual percentage seems to rise and drop rapidly. As of April 2010 it is estimated that the botnet sends roughly 5.7 billion spam messages a day, or about 4.3% of the global spam volume.


== See also ==


== References ==