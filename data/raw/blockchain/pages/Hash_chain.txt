A hash chain is the successive application of a cryptographic hash function to a piece of data. In computer security, a hash chain is a method used to produce many one-time keys from a single key or password.  For non-repudiation, a hash function can be applied successively to additional pieces of data in order to record the chronology of data's existence.


== Definition ==
A hash chain is a successive application of a cryptographic hash function 
  
    
      
        h
      
    
    {\displaystyle h}
  
 to a string 
  
    
      
        x
      
    
    {\displaystyle x}
  
.
For example,

  
    
      
        h
        (
        h
        (
        h
        (
        h
        (
        x
        )
        )
        )
        )
      
    
    {\displaystyle h(h(h(h(x))))}
  

gives a hash chain of length 4, often denoted 
  
    
      
        
          h
          
            4
          
        
        (
        x
        )
      
    
    {\displaystyle h^{4}(x)}
  


== Applications ==

Leslie Lamport suggested the use of hash chains as a password protection scheme in an insecure environment. A server which needs to provide authentication may store a hash chain rather than a plain text password and prevent theft of the password in transmission or theft from the server. For example, a server begins by storing 
  
    
      
        
          h
          
            1000
          
        
        (
        
          p
          a
          s
          s
          w
          o
          r
          d
        
        )
      
    
    {\displaystyle h^{1000}(\mathrm {password} )}
  
 which is provided by the user. When the user wishes to authenticate, they supply 
  
    
      
        
          h
          
            999
          
        
        (
        
          p
          a
          s
          s
          w
          o
          r
          d
        
        )
      
    
    {\displaystyle h^{999}(\mathrm {password} )}
  
 to the server. The server computes 
  
    
      
        h
        (
        
          h
          
            999
          
        
        (
        
          p
          a
          s
          s
          w
          o
          r
          d
        
        )
        )
        =
        
          h
          
            1000
          
        
        (
        
          p
          a
          s
          s
          w
          o
          r
          d
        
        )
      
    
    {\displaystyle h(h^{999}(\mathrm {password} ))=h^{1000}(\mathrm {password} )}
  
 and verifies this matches the hash chain it has stored. It then stores 
  
    
      
        
          h
          
            999
          
        
        (
        
          p
          a
          s
          s
          w
          o
          r
          d
        
        )
      
    
    {\displaystyle h^{999}(\mathrm {password} )}
  
 for the next time the user wishes to authenticate.
An eavesdropper seeing 
  
    
      
        
          h
          
            999
          
        
        (
        
          p
          a
          s
          s
          w
          o
          r
          d
        
        )
      
    
    {\displaystyle h^{999}(\mathrm {password} )}
  
 communicated to the server will be unable to re-transmit the same hash chain to the server for authentication since the server now expects 
  
    
      
        
          h
          
            998
          
        
        (
        
          p
          a
          s
          s
          w
          o
          r
          d
        
        )
      
    
    {\displaystyle h^{998}(\mathrm {password} )}
  
. Due to the one-way property of cryptographically secure hash functions, it is infeasible for the eavesdropper to reverse the hash function and obtain an earlier piece of the hash chain. In this example, the user could authenticate 1000 times before the hash chain were exhausted. Each time the hash value is different, and thus cannot be duplicated by an attacker.


== Binary hash chains ==

Binary hash chains are commonly used in association with a hash tree. A binary hash chain takes two hash values as inputs, concatenates them and applies a hash function to the result, thereby producing a third hash value.

The above diagram shows a hash tree consisting of eight leaf nodes and the hash chain for the third leaf node. In addition to the hash values themselves the order of concatenation (right or left 1,0) or "order bits" are necessary to complete the hash chain.


== Winternitz chains ==
Winternitz chains (also known as function chains) are used in hash-based cryptography. The chain is parameterized by the Winternitz parameter w (number of bits in a "digit" d) and security  parameter n (number of bits in the hash value, typically double the security strength, 256 or 512). The chain consists of 
  
    
      
        
          2
          
            w
          
        
      
    
    {\displaystyle 2^{w}}
  
 values that are results of repeated application of a one-way "chain" function F to a secret key sk: 
  
    
      
        s
        k
        ,
        F
        (
        s
        k
        )
        ,
        F
        (
        F
        (
        s
        k
        )
        )
        ,
        .
        .
        .
        ,
        
          F
          
            
              2
              
                w
                −
                1
              
            
          
        
        (
        s
        k
        )
      
    
    {\displaystyle sk,F(sk),F(F(sk)),...,F^{2^{w-1}}(sk)}
  
. The chain function is typically based on a standard cryptographic hash, but needs to be parameterized ("randomized"), so it involves few invocations of the underlying hash. In the Winternitz signature scheme a chain is used to encode one digit of the m-bit message, so the Winternitz signature uses approximately 
  
    
      
        m
        n
        
          /
        
        w
      
    
    {\displaystyle mn/w}
  
 bits, its calculation takes about 
  
    
      
        
          2
          
            w
          
        
        m
        
          /
        
        w
      
    
    {\displaystyle 2^{w}m/w}
  
 applications of the function F. Note that some signature standards (like Extended Merkle signature scheme, XMSS) define w as the number of possible values in a digit, so 
  
    
      
        w
        =
        16
      
    
    {\displaystyle w=16}
  
 in XMSS corresponds to 
  
    
      
        w
        =
        4
      
    
    {\displaystyle w=4}
  
 in standards  (like Leighton-Micali Signature, LMS) that define w in the same way as above - as a number of bits in the digit.


== Hash chain vs. blockchain ==
A hash chain is similar to a blockchain, as they both utilize a cryptographic hash function for creating a link between two nodes. However, a blockchain (as used by Bitcoin and related systems) is generally intended to support distributed agreement around a public ledger (data), and incorporates a set of rules for encapsulation of data and associated data permissions.


== See also ==
Challenge–response authentication
Hash list – In contrast to the recursive structure of hash chains, the elements of a hash list are independent of each other.
One-time password
Key stretching
Linked timestamping – Binary hash chains are a key component in linked timestamping.
X.509


== References ==


== Sources ==
Buchmann, Johannes; Dahmen, Erik; Ereth, Sarah; Hülsing, Andreas; Rückert, Markus (2011). "On the Security of the Winternitz One-Time Signature Scheme" (PDF). Progress in Cryptology – AFRICACRYPT 2011. Lecture Notes in Computer Science. Vol. 6737. Springer Berlin Heidelberg. pp. 363–378. doi:10.1007/978-3-642-21969-6_23. eISSN 1611-3349. ISBN 978-3-642-21968-9. ISSN 0302-9743.
Hülsing, Andreas (2013b). Practical Forward Secure Signatures using Minimal Security Assumptions (PDF) (PhD). TU Darmstadt.
Hülsing, Andreas (2013a). "W-OTS+ – Shorter Signatures for Hash-Based Signature Schemes" (PDF). Progress in Cryptology – AFRICACRYPT 2013. Lecture Notes in Computer Science. Vol. 7918. Springer Berlin Heidelberg. pp. 173–188. doi:10.1007/978-3-642-38553-7_10. eISSN 1611-3349. ISBN 978-3-642-38552-0. ISSN 0302-9743.