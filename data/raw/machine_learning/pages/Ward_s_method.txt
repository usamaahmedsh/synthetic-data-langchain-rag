In statistics, Ward's method is a criterion applied in hierarchical cluster analysis. Ward's minimum variance method is a special case of the objective function approach originally presented by Joe H. Ward, Jr. Ward suggested a general agglomerative hierarchical clustering procedure, where the criterion for choosing the pair of clusters to merge at each step is based on the optimal value of an objective function. This objective function could be "any function that reflects the investigator's purpose." Many of the standard clustering procedures are contained in this very general class. To illustrate the procedure, Ward used the example where the objective function is the error sum of squares, and this example is known as Ward's method or more precisely Ward's minimum variance method.
The nearest-neighbor chain algorithm can be used to find the same clustering defined by Ward's method, in time proportional to the size of the input distance matrix and space linear in the number of points being clustered.


== The minimum variance criterion ==
Ward's minimum variance criterion minimizes the total within-cluster variance. To implement this method, at each step find the pair of clusters that leads to minimum increase in total within-cluster variance after merging. This increase is a weighted squared distance between cluster centers. At the initial step, all clusters are singletons (clusters containing a single point). To apply a recursive algorithm under this objective function, the initial distance between individual objects must be (proportional to) squared Euclidean distance. 
The initial cluster distances in Ward's minimum variance method are therefore defined to be the squared Euclidean distance between points:

  
    
      
        
          d
          
            i
            j
          
        
        =
        d
        (
        {
        
          X
          
            i
          
        
        }
        ,
        {
        
          X
          
            j
          
        
        }
        )
        =
        
          ‖
          
            X
            
              i
            
          
          −
          
            X
            
              j
            
          
          
            ‖
            
              2
            
          
        
        .
      
    
    {\displaystyle d_{ij}=d(\{X_{i}\},\{X_{j}\})={\|X_{i}-X_{j}\|^{2}}.}
  

Note: In software that implements Ward's method, it is important to check whether the function arguments should specify Euclidean distances or squared Euclidean distances.


== Lance–Williams algorithms ==
Ward's minimum variance method can be defined and implemented recursively by a Lance–Williams algorithm. The Lance–Williams algorithms are an infinite family of agglomerative hierarchical clustering algorithms which are represented by a recursive formula for updating cluster distances at each step (each time a pair of clusters is merged). At each step, it is necessary to optimize the objective function (find the optimal pair of clusters to merge). The recursive formula simplifies finding the optimal pair.
Suppose that clusters 
  
    
      
        
          C
          
            i
          
        
      
    
    {\displaystyle C_{i}}
  
 and 
  
    
      
        
          C
          
            j
          
        
      
    
    {\displaystyle C_{j}}
  
 were next to be merged. At this point all of the current pairwise cluster distances are known. The recursive formula gives the updated cluster distances following the pending merge of clusters 
  
    
      
        
          C
          
            i
          
        
      
    
    {\displaystyle C_{i}}
  
 and 
  
    
      
        
          C
          
            j
          
        
      
    
    {\displaystyle C_{j}}
  
. Let

  
    
      
        
          d
          
            i
            j
          
        
      
    
    {\displaystyle d_{ij}}
  
, 
  
    
      
        
          d
          
            i
            k
          
        
      
    
    {\displaystyle d_{ik}}
  
, and 
  
    
      
        
          d
          
            j
            k
          
        
      
    
    {\displaystyle d_{jk}}
  
 be the pairwise distances between clusters 
  
    
      
        
          C
          
            i
          
        
      
    
    {\displaystyle C_{i}}
  
, 
  
    
      
        
          C
          
            j
          
        
      
    
    {\displaystyle C_{j}}
  
, and 
  
    
      
        
          C
          
            k
          
        
      
    
    {\displaystyle C_{k}}
  
, respectively,

  
    
      
        
          d
          
            (
            i
            j
            )
            k
          
        
      
    
    {\displaystyle d_{(ij)k}}
  
 be the distance between the new cluster 
  
    
      
        
          C
          
            i
          
        
        ∪
        
          C
          
            j
          
        
      
    
    {\displaystyle C_{i}\cup C_{j}}
  
 and 
  
    
      
        
          C
          
            k
          
        
      
    
    {\displaystyle C_{k}}
  
.
An algorithm belongs to the Lance-Williams family if the updated cluster distance 
  
    
      
        
          d
          
            (
            i
            j
            )
            k
          
        
      
    
    {\displaystyle d_{(ij)k}}
  
 can be computed recursively by

  
    
      
        
          d
          
            (
            i
            j
            )
            k
          
        
        =
        
          α
          
            i
          
        
        
          d
          
            i
            k
          
        
        +
        
          α
          
            j
          
        
        
          d
          
            j
            k
          
        
        +
        β
        
          d
          
            i
            j
          
        
        +
        γ
        
          |
        
        
          d
          
            i
            k
          
        
        −
        
          d
          
            j
            k
          
        
        
          |
        
        ,
      
    
    {\displaystyle d_{(ij)k}=\alpha _{i}d_{ik}+\alpha _{j}d_{jk}+\beta d_{ij}+\gamma |d_{ik}-d_{jk}|,}
  

where 
  
    
      
        
          α
          
            i
          
        
        ,
        
          α
          
            j
          
        
        ,
        β
        ,
      
    
    {\displaystyle \alpha _{i},\alpha _{j},\beta ,}
  
 and 
  
    
      
        γ
      
    
    {\displaystyle \gamma }
  
 are parameters, which may depend on cluster sizes, that together with the cluster distance function 
  
    
      
        
          d
          
            i
            j
          
        
      
    
    {\displaystyle d_{ij}}
  
 determine the clustering algorithm. Several standard clustering algorithms such as single linkage, complete linkage, and group average method have a recursive formula of the above type. A table of parameters for standard methods is given by several authors.
Ward's minimum variance method can be implemented by the Lance–Williams formula. For disjoint clusters 
  
    
      
        
          C
          
            i
          
        
        ,
        
          C
          
            j
          
        
        ,
      
    
    {\displaystyle C_{i},C_{j},}
  
 and 
  
    
      
        
          C
          
            k
          
        
      
    
    {\displaystyle C_{k}}
  
 with sizes 
  
    
      
        
          n
          
            i
          
        
        ,
        
          n
          
            j
          
        
        ,
      
    
    {\displaystyle n_{i},n_{j},}
  
 and 
  
    
      
        
          n
          
            k
          
        
      
    
    {\displaystyle n_{k}}
  
 respectively:

  
    
      
        d
        (
        
          C
          
            i
          
        
        ∪
        
          C
          
            j
          
        
        ,
        
          C
          
            k
          
        
        )
        =
        
          
            
              
                n
                
                  i
                
              
              +
              
                n
                
                  k
                
              
            
            
              
                n
                
                  i
                
              
              +
              
                n
                
                  j
                
              
              +
              
                n
                
                  k
                
              
            
          
        
        
        d
        (
        
          C
          
            i
          
        
        ,
        
          C
          
            k
          
        
        )
        +
        
          
            
              
                n
                
                  j
                
              
              +
              
                n
                
                  k
                
              
            
            
              
                n
                
                  i
                
              
              +
              
                n
                
                  j
                
              
              +
              
                n
                
                  k
                
              
            
          
        
        
        d
        (
        
          C
          
            j
          
        
        ,
        
          C
          
            k
          
        
        )
        −
        
          
            
              n
              
                k
              
            
            
              
                n
                
                  i
                
              
              +
              
                n
                
                  j
                
              
              +
              
                n
                
                  k
                
              
            
          
        
        
        d
        (
        
          C
          
            i
          
        
        ,
        
          C
          
            j
          
        
        )
        .
      
    
    {\displaystyle d(C_{i}\cup C_{j},C_{k})={\frac {n_{i}+n_{k}}{n_{i}+n_{j}+n_{k}}}\;d(C_{i},C_{k})+{\frac {n_{j}+n_{k}}{n_{i}+n_{j}+n_{k}}}\;d(C_{j},C_{k})-{\frac {n_{k}}{n_{i}+n_{j}+n_{k}}}\;d(C_{i},C_{j}).}
  

Hence Ward's method can be implemented as a Lance–Williams algorithm with

  
    
      
        
          α
          
            i
          
        
        =
        
          
            
              
                n
                
                  i
                
              
              +
              
                n
                
                  k
                
              
            
            
              
                n
                
                  i
                
              
              +
              
                n
                
                  j
                
              
              +
              
                n
                
                  k
                
              
            
          
        
        ,
        
        
          α
          
            j
          
        
        =
        
          
            
              
                n
                
                  j
                
              
              +
              
                n
                
                  k
                
              
            
            
              
                n
                
                  i
                
              
              +
              
                n
                
                  j
                
              
              +
              
                n
                
                  k
                
              
            
          
        
        ,
        
        β
        =
        
          
            
              −
              
                n
                
                  k
                
              
            
            
              
                n
                
                  i
                
              
              +
              
                n
                
                  j
                
              
              +
              
                n
                
                  k
                
              
            
          
        
        ,
        
        γ
        =
        0.
      
    
    {\displaystyle \alpha _{i}={\frac {n_{i}+n_{k}}{n_{i}+n_{j}+n_{k}}},\qquad \alpha _{j}={\frac {n_{j}+n_{k}}{n_{i}+n_{j}+n_{k}}},\qquad \beta ={\frac {-n_{k}}{n_{i}+n_{j}+n_{k}}},\qquad \gamma =0.}
  


== Variations ==
The popularity of the Ward's method has led to variations of it. For instance, Wardp introduces the use of cluster specific feature weights, following the intuitive idea that features could have different degrees of relevance at different clusters. 


== References ==


== Further reading ==
Everitt, B. S., Landau, S. and Leese, M. (2001), Cluster Analysis, 4th Edition, Oxford University Press, Inc., New York; Arnold, London. ISBN 0340761199
Hartigan, J. A. (1975), Clustering Algorithms, New York: Wiley.
Jain, A. K. and Dubes, R. C. (1988), Algorithms for Clustering Data, New Jersey: Prentice–Hall.
Kaufman, L. and Rousseeuw, P. J. (1990), Finding Groups in Data: An Introduction to Cluster Analysis, New York: Wiley.