In computer science, learning vector quantization (LVQ) is a prototype-based supervised classification algorithm. LVQ is the supervised counterpart of vector quantization systems. LVQ can be understood as a special case of an artificial neural network, more precisely, it applies a winner-take-all Hebbian learning-based approach. It is a precursor to self-organizing maps (SOM) and related to neural gas and the k-nearest neighbor algorithm (k-NN). LVQ was invented by Teuvo Kohonen.


== Definition ==
An LVQ system is represented by prototypes 
  
    
      
        W
        =
        (
        w
        (
        i
        )
        ,
        .
        .
        .
        ,
        w
        (
        n
        )
        )
      
    
    {\displaystyle W=(w(i),...,w(n))}
  
 which are defined in the feature space of observed data. In winner-take-all training algorithms one determines, for each data point, the prototype which is closest to the input according to a given distance measure. The position of this so-called winner prototype is then adapted, i.e. the winner is moved closer if it correctly classifies the data point or moved away if it classifies the data point incorrectly.
An advantage of LVQ is that it creates prototypes that are easy to interpret for experts in the respective application domain.
LVQ systems can be applied to multi-class classification problems in a natural way. 
A key issue in LVQ is the choice of an appropriate measure of distance or similarity for training and classification. Recently, techniques have been developed which adapt a parameterized distance measure in the course of training the system, see e.g. (Schneider, Biehl, and Hammer, 2009) and references therein.
LVQ can be a source of great help in classifying text documents.


== Algorithm ==
The algorithms are presented as in.
Set up:

Let the data be denoted by 
  
    
      
        
          x
          
            i
          
        
        ∈
        
          
            R
          
          
            D
          
        
      
    
    {\displaystyle x_{i}\in \mathbb {R} ^{D}}
  
, and their corresponding labels by 
  
    
      
        
          y
          
            i
          
        
        ∈
        {
        1
        ,
        2
        ,
        …
        ,
        C
        }
      
    
    {\displaystyle y_{i}\in \{1,2,\dots ,C\}}
  
.
The complete dataset is 
  
    
      
        {
        (
        
          x
          
            i
          
        
        ,
        
          y
          
            i
          
        
        )
        
          }
          
            i
            =
            1
          
          
            N
          
        
      
    
    {\displaystyle \{(x_{i},y_{i})\}_{i=1}^{N}}
  
.
The set of code vectors is 
  
    
      
        
          w
          
            j
          
        
        ∈
        
          
            R
          
          
            D
          
        
      
    
    {\displaystyle w_{j}\in \mathbb {R} ^{D}}
  
.
The learning rate at iteration step 
  
    
      
        t
      
    
    {\displaystyle t}
  
 is denoted by 
  
    
      
        
          α
          
            t
          
        
      
    
    {\displaystyle \alpha _{t}}
  
.
The hyperparameters 
  
    
      
        w
      
    
    {\displaystyle w}
  
 and 
  
    
      
        ϵ
      
    
    {\displaystyle \epsilon }
  
 are used by LVQ2 and LVQ3. The original paper suggests 
  
    
      
        ϵ
        ∈
        [
        0.1
        ,
        0.5
        ]
      
    
    {\displaystyle \epsilon \in [0.1,0.5]}
  
 and 
  
    
      
        w
        ∈
        [
        0.2
        ,
        0.3
        ]
      
    
    {\displaystyle w\in [0.2,0.3]}
  
.


=== LVQ1 ===
Initialize several code vectors per label. Iterate until convergence criteria is reached.

Sample a datum 
  
    
      
        
          x
          
            i
          
        
      
    
    {\displaystyle x_{i}}
  
, and find out the code vector 
  
    
      
        
          w
          
            j
          
        
      
    
    {\displaystyle w_{j}}
  
, such that 
  
    
      
        
          x
          
            i
          
        
      
    
    {\displaystyle x_{i}}
  
 falls within the Voronoi cell of 
  
    
      
        
          w
          
            j
          
        
      
    
    {\displaystyle w_{j}}
  
.
If its label 
  
    
      
        
          y
          
            i
          
        
      
    
    {\displaystyle y_{i}}
  
 is the same as that of 
  
    
      
        
          w
          
            j
          
        
      
    
    {\displaystyle w_{j}}
  
, then 
  
    
      
        
          w
          
            j
          
        
        ←
        
          w
          
            j
          
        
        +
        
          α
          
            t
          
        
        (
        
          x
          
            i
          
        
        −
        
          w
          
            j
          
        
        )
      
    
    {\displaystyle w_{j}\leftarrow w_{j}+\alpha _{t}(x_{i}-w_{j})}
  
, otherwise, 
  
    
      
        
          w
          
            j
          
        
        ←
        
          w
          
            j
          
        
        −
        
          α
          
            t
          
        
        (
        
          x
          
            i
          
        
        −
        
          w
          
            j
          
        
        )
      
    
    {\displaystyle w_{j}\leftarrow w_{j}-\alpha _{t}(x_{i}-w_{j})}
  
.


=== LVQ2 ===
LVQ2 is the same as LVQ3, but with this sentence removed: "If 
  
    
      
        
          w
          
            j
          
        
      
    
    {\displaystyle w_{j}}
  
 and 
  
    
      
        
          w
          
            k
          
        
      
    
    {\displaystyle w_{k}}
  
 and 
  
    
      
        
          x
          
            i
          
        
      
    
    {\displaystyle x_{i}}
  
 have the same class, then 
  
    
      
        
          w
          
            j
          
        
        ←
        
          w
          
            j
          
        
        −
        
          α
          
            t
          
        
        (
        
          x
          
            i
          
        
        −
        
          w
          
            j
          
        
        )
      
    
    {\displaystyle w_{j}\leftarrow w_{j}-\alpha _{t}(x_{i}-w_{j})}
  
 and 
  
    
      
        
          w
          
            k
          
        
        ←
        
          w
          
            k
          
        
        +
        
          α
          
            t
          
        
        (
        
          x
          
            i
          
        
        −
        
          w
          
            k
          
        
        )
      
    
    {\displaystyle w_{k}\leftarrow w_{k}+\alpha _{t}(x_{i}-w_{k})}
  
.". If 
  
    
      
        
          w
          
            j
          
        
      
    
    {\displaystyle w_{j}}
  
 and 
  
    
      
        
          w
          
            k
          
        
      
    
    {\displaystyle w_{k}}
  
 and 
  
    
      
        
          x
          
            i
          
        
      
    
    {\displaystyle x_{i}}
  
 have the same class, then nothing happens.


=== LVQ3 ===

Initialize several code vectors per label. Iterate until convergence criteria is reached.

Sample a datum 
  
    
      
        
          x
          
            i
          
        
      
    
    {\displaystyle x_{i}}
  
, and find out two code vectors 
  
    
      
        
          w
          
            j
          
        
        ,
        
          w
          
            k
          
        
      
    
    {\displaystyle w_{j},w_{k}}
  
 closest to it.
Let 
  
    
      
        
          d
          
            j
          
        
        :=
        ‖
        
          x
          
            i
          
        
        −
        
          w
          
            j
          
        
        ‖
        ,
        
          d
          
            k
          
        
        :=
        ‖
        
          x
          
            i
          
        
        −
        
          w
          
            k
          
        
        ‖
      
    
    {\displaystyle d_{j}:=\|x_{i}-w_{j}\|,d_{k}:=\|x_{i}-w_{k}\|}
  
.
If 
  
    
      
        min
        
          (
          
            
              
                
                  d
                  
                    j
                  
                
                
                  d
                  
                    k
                  
                
              
            
            ,
            
              
                
                  d
                  
                    k
                  
                
                
                  d
                  
                    j
                  
                
              
            
          
          )
        
        >
        s
      
    
    {\displaystyle \min \left({\frac {d_{j}}{d_{k}}},{\frac {d_{k}}{d_{j}}}\right)>s}
  
, where 
  
    
      
        s
        =
        
          
            
              1
              −
              w
            
            
              1
              +
              w
            
          
        
      
    
    {\displaystyle s={\frac {1-w}{1+w}}}
  
, then
If 
  
    
      
        
          w
          
            j
          
        
      
    
    {\displaystyle w_{j}}
  
 and 
  
    
      
        
          x
          
            i
          
        
      
    
    {\displaystyle x_{i}}
  
 have the same class, and 
  
    
      
        
          w
          
            k
          
        
      
    
    {\displaystyle w_{k}}
  
 and 
  
    
      
        
          x
          
            i
          
        
      
    
    {\displaystyle x_{i}}
  
 have different classes, then 
  
    
      
        
          w
          
            j
          
        
        ←
        
          w
          
            j
          
        
        +
        
          α
          
            t
          
        
        (
        
          x
          
            i
          
        
        −
        
          w
          
            j
          
        
        )
      
    
    {\displaystyle w_{j}\leftarrow w_{j}+\alpha _{t}(x_{i}-w_{j})}
  
 and 
  
    
      
        
          w
          
            k
          
        
        ←
        
          w
          
            k
          
        
        −
        
          α
          
            t
          
        
        (
        
          x
          
            i
          
        
        −
        
          w
          
            k
          
        
        )
      
    
    {\displaystyle w_{k}\leftarrow w_{k}-\alpha _{t}(x_{i}-w_{k})}
  
.
If 
  
    
      
        
          w
          
            k
          
        
      
    
    {\displaystyle w_{k}}
  
 and 
  
    
      
        
          x
          
            i
          
        
      
    
    {\displaystyle x_{i}}
  
 have the same class, and 
  
    
      
        
          w
          
            j
          
        
      
    
    {\displaystyle w_{j}}
  
 and 
  
    
      
        
          x
          
            i
          
        
      
    
    {\displaystyle x_{i}}
  
 have different classes, then 
  
    
      
        
          w
          
            j
          
        
        ←
        
          w
          
            j
          
        
        −
        
          α
          
            t
          
        
        (
        
          x
          
            i
          
        
        −
        
          w
          
            j
          
        
        )
      
    
    {\displaystyle w_{j}\leftarrow w_{j}-\alpha _{t}(x_{i}-w_{j})}
  
 and 
  
    
      
        
          w
          
            k
          
        
        ←
        
          w
          
            k
          
        
        +
        
          α
          
            t
          
        
        (
        
          x
          
            i
          
        
        −
        
          w
          
            k
          
        
        )
      
    
    {\displaystyle w_{k}\leftarrow w_{k}+\alpha _{t}(x_{i}-w_{k})}
  
.
If 
  
    
      
        
          w
          
            j
          
        
      
    
    {\displaystyle w_{j}}
  
 and 
  
    
      
        
          w
          
            k
          
        
      
    
    {\displaystyle w_{k}}
  
 and 
  
    
      
        
          x
          
            i
          
        
      
    
    {\displaystyle x_{i}}
  
 have the same class, then 
  
    
      
        
          w
          
            j
          
        
        ←
        
          w
          
            j
          
        
        −
        ϵ
        
          α
          
            t
          
        
        (
        
          x
          
            i
          
        
        −
        
          w
          
            j
          
        
        )
      
    
    {\displaystyle w_{j}\leftarrow w_{j}-\epsilon \alpha _{t}(x_{i}-w_{j})}
  
 and 
  
    
      
        
          w
          
            k
          
        
        ←
        
          w
          
            k
          
        
        +
        ϵ
        
          α
          
            t
          
        
        (
        
          x
          
            i
          
        
        −
        
          w
          
            k
          
        
        )
      
    
    {\displaystyle w_{k}\leftarrow w_{k}+\epsilon \alpha _{t}(x_{i}-w_{k})}
  
.
If 
  
    
      
        
          w
          
            k
          
        
      
    
    {\displaystyle w_{k}}
  
 and 
  
    
      
        
          x
          
            i
          
        
      
    
    {\displaystyle x_{i}}
  
 have different classes, and 
  
    
      
        
          w
          
            j
          
        
      
    
    {\displaystyle w_{j}}
  
 and 
  
    
      
        
          x
          
            i
          
        
      
    
    {\displaystyle x_{i}}
  
 have different classes, then the original paper simply does not explain what happens in this case, but presumably nothing happens in this case.
Otherwise, skip.
Note that condition 
  
    
      
        min
        
          (
          
            
              
                
                  d
                  
                    j
                  
                
                
                  d
                  
                    k
                  
                
              
            
            ,
            
              
                
                  d
                  
                    k
                  
                
                
                  d
                  
                    j
                  
                
              
            
          
          )
        
        >
        s
      
    
    {\displaystyle \min \left({\frac {d_{j}}{d_{k}}},{\frac {d_{k}}{d_{j}}}\right)>s}
  
, where 
  
    
      
        s
        =
        
          
            
              1
              −
              w
            
            
              1
              +
              w
            
          
        
      
    
    {\displaystyle s={\frac {1-w}{1+w}}}
  
, precisely means that the point 
  
    
      
        
          x
          
            i
          
        
      
    
    {\displaystyle x_{i}}
  
 falls between two Apollonian spheres. 


== References ==


== Further reading ==
Somervuo, Panu; Kohonen, Teuvo (1999). "Self-organizing maps and learning vector quantization for feature sequences". Neural Processing Letters. 10 (2): 151–159. doi:10.1023/A:1018741720065.
Nova, David; Estévez, Pablo A. (2014-09-01). "A review of learning vector quantization classifiers". Neural Computing and Applications. 25 (3): 511–524. arXiv:1509.07093. doi:10.1007/s00521-013-1535-3. ISSN 1433-3058.


== External links ==
lvq_pak official release (1996) by Kohonen and his team