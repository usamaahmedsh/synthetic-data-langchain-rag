In probability theory, Kelly's lemma states that for a stationary continuous-time Markov chain, a process defined as the time-reversed process has the same stationary distribution as the forward-time process. The theorem is named after Frank Kelly.


== Statement ==
For a continuous time Markov chain with an at most countable state space 
  
    
      
        S
      
    
    {\displaystyle S}
  
 and transition-rate matrix 
  
    
      
        Q
      
    
    {\displaystyle Q}
  
 (with elements 
  
    
      
        
          q
          
            i
            j
          
        
      
    
    {\displaystyle q_{ij}}
  
), if we can find a set of non-negative numbers 
  
    
      
        
          q
          
            i
            j
          
          ′
        
      
    
    {\displaystyle q_{ij}'}
  
 and a positive measure 
  
    
      
        π
      
    
    {\displaystyle \pi }
  
 that satisfy the following conditions:

  
    
      
        
          
            
              
                
                  ∑
                  
                    j
                    ∈
                    S
                  
                
                
                  q
                  
                    i
                    j
                  
                
              
              
                
                =
                
                  ∑
                  
                    j
                    ∈
                    S
                  
                
                
                  q
                  
                    i
                    j
                  
                  ′
                
                
                ∀
                i
                ∈
                S
              
            
            
              
                
                  π
                  
                    i
                  
                
                
                  q
                  
                    i
                    j
                  
                
              
              
                
                =
                
                  π
                  
                    j
                  
                
                
                  q
                  
                    j
                    i
                  
                  ′
                
                
                ∀
                i
                ,
                j
                ∈
                S
                ,
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}\sum _{j\in S}q_{ij}&=\sum _{j\in S}q'_{ij}\quad \forall i\in S\\\pi _{i}q_{ij}&=\pi _{j}q_{ji}'\quad \forall i,j\in S,\end{aligned}}}
  

then 
  
    
      
        
          q
          
            i
            j
          
          ′
        
      
    
    {\displaystyle q_{ij}'}
  
 are the rates for the reversed process and 
  
    
      
        π
      
    
    {\displaystyle \pi }
  
 is proportional to the stationary distribution for both processes.


=== Proof ===
Given the assumptions made on the 
  
    
      
        
          q
          
            i
            j
          
        
      
    
    {\displaystyle q_{ij}}
  
 and 
  
    
      
        π
      
    
    {\displaystyle \pi }
  
 we have

  
    
      
        
          ∑
          
            i
            ∈
            S
          
        
        
          π
          
            i
          
        
        
          q
          
            i
            j
          
        
        =
        
          ∑
          
            i
            ∈
            S
          
        
        
          π
          
            j
          
        
        
          q
          
            j
            i
          
          ′
        
        =
        
          π
          
            j
          
        
        
          ∑
          
            i
            ∈
            S
          
        
        
          q
          
            j
            i
          
          ′
        
        =
        
          π
          
            j
          
        
        
          ∑
          
            i
            ∈
            S
          
        
        
          q
          
            j
            i
          
        
        =
        
          π
          
            j
          
        
        ,
      
    
    {\displaystyle \sum _{i\in S}\pi _{i}q_{ij}=\sum _{i\in S}\pi _{j}q'_{ji}=\pi _{j}\sum _{i\in S}q'_{ji}=\pi _{j}\sum _{i\in S}q_{ji}=\pi _{j},}
  

so the global balance equations are satisfied and the measure 
  
    
      
        π
      
    
    {\displaystyle \pi }
  
 is proportional to the stationary distribution of the original process.
By symmetry, the same argument shows that 
  
    
      
        π
      
    
    {\displaystyle \pi }
  
 is also proportional to the stationary distribution of the reversed process.


== References ==