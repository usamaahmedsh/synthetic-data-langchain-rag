In financial econometrics (the application of statistical methods to economic data), the Markov-switching multifractal (MSM) is a model of asset returns developed by Laurent E. Calvet and Adlai J. Fisher that incorporates stochastic volatility components of heterogeneous durations. MSM captures the outliers, log-memory-like volatility persistence and power variation of financial returns. In currency and equity series, MSM compares favorably with standard volatility models such as GARCH(1,1) and FIGARCH both in- and out-of-sample. MSM is used by practitioners in the financial industry for different types of forecasts.


== MSM specification ==
The MSM model can be specified in both discrete time and continuous time.


=== Discrete time ===
Let 
  
    
      
        
          P
          
            t
          
        
      
    
    {\displaystyle P_{t}}
  
 denote the price of a financial asset, and let 
  
    
      
        
          r
          
            t
          
        
        =
        ln
        ⁡
        (
        
          P
          
            t
          
        
        
          /
        
        
          P
          
            t
            −
            1
          
        
        )
      
    
    {\displaystyle r_{t}=\ln(P_{t}/P_{t-1})}
  
 denote the return over two consecutive periods. In MSM, returns are specified as

  
    
      
        
          r
          
            t
          
        
        =
        μ
        +
        
          
            
              σ
              ¯
            
          
        
        (
        
          M
          
            1
            ,
            t
          
        
        
          M
          
            2
            ,
            t
          
        
        .
        .
        .
        
          M
          
            
              
                
                  k
                  ¯
                
              
            
            ,
            t
          
        
        
          )
          
            1
            
              /
            
            2
          
        
        
          ϵ
          
            t
          
        
        ,
      
    
    {\displaystyle r_{t}=\mu +{\bar {\sigma }}(M_{1,t}M_{2,t}...M_{{\bar {k}},t})^{1/2}\epsilon _{t},}
  

where 
  
    
      
        μ
      
    
    {\displaystyle \mu }
  
 and 
  
    
      
        σ
      
    
    {\displaystyle \sigma }
  
  are constants and {
  
    
      
        
          ϵ
          
            t
          
        
      
    
    {\displaystyle \epsilon _{t}}
  
} are independent standard Gaussians. Volatility is driven by the first-order latent Markov state vector:

  
    
      
        
          M
          
            t
          
        
        =
        (
        
          M
          
            1
            ,
            t
          
        
        
          M
          
            2
            ,
            t
          
        
        …
        
          M
          
            
              
                
                  k
                  ¯
                
              
            
            ,
            t
          
        
        )
        ∈
        
          R
          
            +
          
          
            
              
                k
                ¯
              
            
          
        
        .
      
    
    {\displaystyle M_{t}=(M_{1,t}M_{2,t}\dots M_{{\bar {k}},t})\in R_{+}^{\bar {k}}.}
  

Given the volatility state 
  
    
      
        
          M
          
            t
          
        
      
    
    {\displaystyle M_{t}}
  
, the next-period multiplier 
  
    
      
        
          M
          
            k
            ,
            t
            +
            1
          
        
      
    
    {\displaystyle M_{k,t+1}}
  
 is drawn from a fixed distribution M with probability 
  
    
      
        
          γ
          
            k
          
        
      
    
    {\displaystyle \gamma _{k}}
  
, and is otherwise left unchanged.

The transition probabilities are specified by

  
    
      
        
          γ
          
            k
          
        
        =
        1
        −
        (
        1
        −
        
          γ
          
            1
          
        
        
          )
          
            (
            
              b
              
                k
                −
                1
              
            
            )
          
        
      
    
    {\displaystyle \gamma _{k}=1-(1-\gamma _{1})^{(b^{k-1})}}
  
.
The sequence 
  
    
      
        
          γ
          
            k
          
        
      
    
    {\displaystyle \gamma _{k}}
  
 is approximately geometric 
  
    
      
        
          γ
          
            k
          
        
        ≈
        
          γ
          
            1
          
        
        
          b
          
            k
            −
            1
          
        
      
    
    {\displaystyle \gamma _{k}\approx \gamma _{1}b^{k-1}}
  
 at low frequency. The marginal distribution M has a unit mean, has a positive support, and is independent of k.


==== Binomial MSM ====
In empirical applications, the distribution M is often a discrete distribution that can take the values 
  
    
      
        
          m
          
            0
          
        
      
    
    {\displaystyle m_{0}}
  
 or 
  
    
      
        2
        −
        
          m
          
            0
          
        
      
    
    {\displaystyle 2-m_{0}}
  
 with equal probability. The return process 
  
    
      
        
          r
          
            t
          
        
      
    
    {\displaystyle r_{t}}
  
 is then specified by the parameters 
  
    
      
        θ
        =
        (
        
          m
          
            0
          
        
        ,
        μ
        ,
        
          
            
              σ
              ¯
            
          
        
        ,
        b
        ,
        
          γ
          
            1
          
        
        )
      
    
    {\displaystyle \theta =(m_{0},\mu ,{\bar {\sigma }},b,\gamma _{1})}
  
. Note that the number of parameters is the same for all  
  
    
      
        
          
            
              k
              ¯
            
          
        
        >
        1
      
    
    {\displaystyle {\bar {k}}>1}
  
.


=== Continuous time ===
MSM is similarly defined in continuous time. The price process follows the diffusion:

  
    
      
        
          
            
              d
              
                P
                
                  t
                
              
            
            
              P
              
                t
              
            
          
        
        =
        μ
        d
        t
        +
        σ
        (
        
          M
          
            t
          
        
        )
        
        d
        
          W
          
            t
          
        
        ,
      
    
    {\displaystyle {\frac {dP_{t}}{P_{t}}}=\mu dt+\sigma (M_{t})\,dW_{t},}
  

where 
  
    
      
        σ
        (
        
          M
          
            t
          
        
        )
        =
        
          
            
              σ
              ¯
            
          
        
        (
        
          M
          
            1
            ,
            t
          
        
        …
        
          M
          
            
              
                
                  k
                  ¯
                
              
            
            ,
            t
          
        
        
          )
          
            1
            
              /
            
            2
          
        
      
    
    {\displaystyle \sigma (M_{t})={\bar {\sigma }}(M_{1,t}\dots M_{{\bar {k}},t})^{1/2}}
  
, 
  
    
      
        
          W
          
            t
          
        
      
    
    {\displaystyle W_{t}}
  
 is a standard Brownian motion, and 
  
    
      
        μ
      
    
    {\displaystyle \mu }
  
 and 
  
    
      
        
          
            
              σ
              ¯
            
          
        
      
    
    {\displaystyle {\bar {\sigma }}}
  
 are constants. Each component follows the dynamics:

The intensities vary geometrically with k:

  
    
      
        
          γ
          
            k
          
        
        =
        
          γ
          
            1
          
        
        
          b
          
            k
            −
            1
          
        
        .
      
    
    {\displaystyle \gamma _{k}=\gamma _{1}b^{k-1}.}
  

When the number of components 
  
    
      
        
          
            
              k
              ¯
            
          
        
      
    
    {\displaystyle {\bar {k}}}
  
 goes to infinity, continuous-time MSM converges to a multifractal diffusion, whose sample paths take a continuum of local Hölder exponents on any finite time interval.


== Inference and closed-form likelihood ==
When 
  
    
      
        M
      
    
    {\displaystyle M}
  
 has a discrete distribution, the Markov state vector 
  
    
      
        
          M
          
            t
          
        
      
    
    {\displaystyle M_{t}}
  
 takes finitely many values 
  
    
      
        
          m
          
            1
          
        
        ,
        .
        .
        .
        ,
        
          m
          
            d
          
        
        ∈
        
          R
          
            +
          
          
            
              
                k
                ¯
              
            
          
        
      
    
    {\displaystyle m^{1},...,m^{d}\in R_{+}^{\bar {k}}}
  
. For instance, there are 
  
    
      
        d
        =
        
          2
          
            
              
                k
                ¯
              
            
          
        
      
    
    {\displaystyle d=2^{\bar {k}}}
  
 possible states in binomial MSM. The Markov dynamics are characterized by the transition matrix 
  
    
      
        A
        =
        (
        
          a
          
            i
            ,
            j
          
        
        
          )
          
            1
            ≤
            i
            ,
            j
            ≤
            d
          
        
      
    
    {\displaystyle A=(a_{i,j})_{1\leq i,j\leq d}}
  
 with components 
  
    
      
        
          a
          
            i
            ,
            j
          
        
        =
        P
        
          (
          
            
              M
              
                t
                +
                1
              
            
            =
            
              m
              
                j
              
            
            
              |
            
            
              M
              
                t
              
            
            =
            
              m
              
                i
              
            
          
          )
        
      
    
    {\displaystyle a_{i,j}=P\left(M_{t+1}=m^{j}|M_{t}=m^{i}\right)}
  
.
Conditional on the volatility state, the return 
  
    
      
        
          r
          
            t
          
        
      
    
    {\displaystyle r_{t}}
  
 has Gaussian density

  
    
      
        f
        (
        
          r
          
            t
          
        
        
          |
        
        
          M
          
            t
          
        
        =
        
          m
          
            i
          
        
        )
        =
        
          
            1
            
              2
              π
              
                σ
                
                  2
                
              
              (
              
                m
                
                  i
                
              
              )
            
          
        
        exp
        ⁡
        
          [
          
            −
            
              
                
                  (
                  
                    r
                    
                      t
                    
                  
                  −
                  μ
                  
                    )
                    
                      2
                    
                  
                
                
                  2
                  
                    σ
                    
                      2
                    
                  
                  (
                  
                    m
                    
                      i
                    
                  
                  )
                
              
            
          
          ]
        
        .
      
    
    {\displaystyle f(r_{t}|M_{t}=m^{i})={\frac {1}{\sqrt {2\pi \sigma ^{2}(m^{i})}}}\exp \left[-{\frac {(r_{t}-\mu )^{2}}{2\sigma ^{2}(m^{i})}}\right].}
  


=== Conditional distribution ===


=== Closed-form Likelihood ===
The log likelihood function has the following analytical expression:

  
    
      
        ln
        ⁡
        L
        (
        
          r
          
            1
          
        
        ,
        …
        ,
        
          r
          
            T
          
        
        ;
        θ
        )
        =
        
          ∑
          
            t
            =
            1
          
          
            T
          
        
        ln
        ⁡
        [
        ω
        (
        
          r
          
            t
          
        
        )
        .
        (
        
          Π
          
            t
            −
            1
          
        
        A
        )
        ]
        .
      
    
    {\displaystyle \ln L(r_{1},\dots ,r_{T};\theta )=\sum _{t=1}^{T}\ln[\omega (r_{t}).(\Pi _{t-1}A)].}
  

Maximum likelihood provides reasonably precise estimates in finite samples.


=== Other estimation methods ===
When 
  
    
      
        M
      
    
    {\displaystyle M}
  
 has a continuous distribution, estimation can proceed by simulated method of moments, or simulated likelihood via a particle filter.


== Forecasting ==
Given 
  
    
      
        
          r
          
            1
          
        
        ,
        …
        ,
        
          r
          
            t
          
        
      
    
    {\displaystyle r_{1},\dots ,r_{t}}
  
, the conditional distribution of the latent state vector at date 
  
    
      
        t
        +
        n
      
    
    {\displaystyle t+n}
  
 is given by:

  
    
      
        
          
            
              
                Π
                ^
              
            
          
          
            t
            ,
            n
          
        
        =
        
          Π
          
            t
          
        
        
          A
          
            n
          
        
        .
        
      
    
    {\displaystyle {\hat {\Pi }}_{t,n}=\Pi _{t}A^{n}.\,}
  

MSM often provides better volatility forecasts than some of the best traditional models both in and out of sample. Calvet and Fisher report considerable gains in exchange rate volatility forecasts at horizons of 10 to 50 days as compared with GARCH(1,1), Markov-Switching GARCH, and Fractionally Integrated GARCH. Lux obtains similar results using linear predictions.


== Applications ==


=== Multiple assets and value-at-risk ===
Extensions of MSM to multiple assets provide reliable estimates of the value-at-risk in a portfolio of securities.


=== Asset pricing ===
In financial economics, MSM has been used to analyze the pricing implications of multifrequency risk. The models have had some success in explaining the excess volatility of stock returns compared to fundamentals and the negative skewness of equity returns. They have also been used to generate multifractal jump-diffusions.


== Related approaches ==
MSM is a stochastic volatility model with arbitrarily many frequencies. MSM builds on the convenience of regime-switching models, which were advanced in economics and finance by James D. Hamilton. 
MSM is closely related to the Multifractal Model of Asset Returns. MSM improves on the MMAR's combinatorial construction by randomizing arrival times, guaranteeing a strictly stationary process. 
MSM provides a pure regime-switching formulation of multifractal measures, which were pioneered by Benoit Mandelbrot.


== See also ==
Brownian motion
Rogemar Mamon
Markov chain
Multifractal model of asset returns
Multifractal
Stochastic volatility


== References ==


== External links ==
Financial Time Series, Multifractals and Hidden Markov Models