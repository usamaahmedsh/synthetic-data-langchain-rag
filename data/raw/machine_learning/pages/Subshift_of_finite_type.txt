In mathematics, subshifts of finite type are shift spaces defined by a finite set of forbidden words. They are used to model dynamical systems, and in particular are objects of study in symbolic dynamics and ergodic theory. They also describe the set of all possible sequences executed by a finite-state machine. The most widely studied shift spaces are the subshifts of finite type.


== Motivating examples ==
One example of a (one-sided) shift of finite type is the set of all sequences, infinite on one end only, that can be made up of the letters 
  
    
      
        A
        ,
        B
      
    
    {\displaystyle A,B}
  
, like 
  
    
      
        A
        A
        A
        ⋯
        ,
        A
        B
        A
        B
        ⋯
        ,
        …
      
    
    {\displaystyle AAA\cdots ,ABAB\cdots ,\dots }
  
. This is known as a full shift and is denoted by 
  
    
      
        {
        A
        ,
        B
        
          }
          
            
              N
            
          
        
      
    
    {\displaystyle \{A,B\}^{\mathbb {N} }}
  
.
By forbidding the word 
  
    
      
        B
        B
      
    
    {\displaystyle BB}
  
, one defines a shift of finite type 
  
    
      
        Σ
        =
        {
        (
        
          x
          
            0
          
        
        ,
        
          x
          
            1
          
        
        ,
        
          x
          
            2
          
        
        ,
        …
        )
        ∣
        
          x
          
            i
          
        
        
          x
          
            i
            +
            1
          
        
        ≠
        B
        B
        }
      
    
    {\displaystyle \Sigma =\{(x_{0},x_{1},x_{2},\ldots )\mid x_{i}x_{i+1}\neq BB\}}
  
 called the golden shift, so-called because the numbers of legal words of length 
  
    
      
        n
      
    
    {\displaystyle n}
  
 are the Fibonacci numbers. Two-sided shifts of finite type are similar, but consist of sequences that are infinite on both ends.
A subshift can be defined by a directed graph on the letters, such as the graph 
  
    
      
        A
        →
        B
        →
        C
        →
        A
      
    
    {\displaystyle A\to B\to C\to A}
  
. It consists of sequences whose transitions between consecutive letters are only those allowed by the graph. For this example, the subshift consists of only three one-sided sequences: 
  
    
      
        A
        B
        C
        A
        B
        C
        ⋯
        ,
        B
        C
        A
        B
        C
        A
        ⋯
        ,
        C
        A
        B
        C
        A
        B
        ⋯
      
    
    {\displaystyle ABCABC\cdots ,BCABCA\cdots ,CABCAB\cdots }
  
. Similarly, the two-sided subshift described by this graph consists of only three two-sided sequences.
Other directed graphs on the same letters produce other subshifts. For example, adding another arrow 
  
    
      
        A
        →
        C
      
    
    {\displaystyle A\to C}
  
 to the graph produces a subshift that, instead of containing three sequences, contains an uncountably infinite number of sequences. Up to a local recoding of letters, every subshift of finite type can be described by such a directed graph.


== Definition ==
Let 
  
    
      
        
          
            A
          
        
      
    
    {\displaystyle {\mathcal {A}}}
  
 be a finite set of 
  
    
      
        n
      
    
    {\displaystyle n}
  
 symbols (alphabet).  Let 
  
    
      
        X
      
    
    {\displaystyle X}
  
 denote the set 
  
    
      
        
          
            
              A
            
          
          
            
              Z
            
          
        
      
    
    {\displaystyle {\mathcal {A}}^{\mathbb {Z} }}
  
 of all bi-infinite sequences of elements of 
  
    
      
        
          
            A
          
        
      
    
    {\displaystyle {\mathcal {A}}}
  
 together with the shift operator 
  
    
      
        T
      
    
    {\displaystyle T}
  
.  We endow 
  
    
      
        
          
            A
          
        
      
    
    {\displaystyle {\mathcal {A}}}
  
 with the discrete topology and 
  
    
      
        X
      
    
    {\displaystyle X}
  
 with the product topology.  A symbolic flow or subshift is a closed 
  
    
      
        T
      
    
    {\displaystyle T}
  
-invariant subset 
  
    
      
        Y
      
    
    {\displaystyle Y}
  
 of 
  
    
      
        X
      
    
    {\displaystyle X}
  
  and the associated language 
  
    
      
        
          
            
              L
            
          
          
            Y
          
        
      
    
    {\displaystyle {\mathcal {L}}_{Y}}
  
 is the set of finite subsequences of 
  
    
      
        Y
      
    
    {\displaystyle Y}
  
.
Let 
  
    
      
        F
      
    
    {\displaystyle F}
  
 be a finite set of words in the alphabet 
  
    
      
        
          
            A
          
        
      
    
    {\displaystyle {\mathcal {A}}}
  
, which are called forbidden words. The associated subshift of finite type is defined to be the space

  
    
      
        
          Σ
          
            F
          
        
        =
        {
        (
        
          x
          
            0
          
        
        ,
        
          x
          
            1
          
        
        ,
        
          x
          
            2
          
        
        ,
        …
        )
        ∣
        ∀
        i
        ,
        k
        ≥
        0
        ,
        
          x
          
            i
          
        
        
          x
          
            i
            +
            1
          
        
        ⋯
        
          x
          
            i
            +
            k
          
        
        ∉
        F
        }
      
    
    {\displaystyle \Sigma _{F}=\{(x_{0},x_{1},x_{2},\ldots )\mid \forall i,k\geq 0,x_{i}x_{i+1}\cdots x_{i+k}\notin F\}}
  

of sequences that avoid the set of forbidden word 
  
    
      
        F
      
    
    {\displaystyle F}
  
.
If the sequence extends to infinity in only one direction as above, it is called a one-sided subshift of finite type, and if it is bilateral, it is called a two-sided subshift of finite type.
The shift operator 
  
    
      
        T
      
    
    {\displaystyle T}
  
 maps a sequence in the one- or two-sided shift to another by shifting all symbols to the left, i.e.

  
    
      
        (
        T
        (
        x
        )
        
          )
          
            i
          
        
        =
        
          x
          
            i
            +
            1
          
        
        .
      
    
    {\displaystyle (T(x))_{i}=x_{i+1}.}
  

Clearly this map is only invertible in the case of the two-sided shift.
A particularly useful subclass is given by the edge shifts. Let A be an n × n adjacency matrix with entries in {0, 1}. Using these elements we construct a directed graph G = (V, E) with V the set of vertices and E the set of edges containing the directed edge x → y in E if and only if Ax, y = 1.  Let Y be the set of all infinite admissible sequences of edges, where by admissible it is meant that the sequence is a walk of the graph, and the sequence can be either one-sided or two-sided infinite.  Let T be the left shift operator on such sequences; it plays the role of the time-evolution operator of the dynamical system.  An edge shift is then defined as a pair (Y, T) obtained in this way.
Formally, one may define the sequences of edges as

  
    
      
        
          Σ
          
            A
          
          
            +
          
        
        =
        
          {
          
            (
            
              x
              
                0
              
            
            ,
            
              x
              
                1
              
            
            ,
            …
            )
            :
            
              x
              
                j
              
            
            ∈
            V
            ,
            
              A
              
                
                  x
                  
                    j
                  
                
                
                  x
                  
                    j
                    +
                    1
                  
                
              
            
            =
            1
            ,
            j
            ∈
            
              N
            
          
          }
        
        .
      
    
    {\displaystyle \Sigma _{A}^{+}=\left\{(x_{0},x_{1},\ldots ):x_{j}\in V,A_{x_{j}x_{j+1}}=1,j\in \mathbb {N} \right\}.}
  

This is the space of all sequences of symbols such that the symbol p can be followed by the symbol q only if the (p, q)-th entry of the matrix A is 1. The space of all bi-infinite sequences is defined analogously:

  
    
      
        
          Σ
          
            A
          
        
        =
        
          {
          
            (
            …
            ,
            
              x
              
                −
                1
              
            
            ,
            
              x
              
                0
              
            
            ,
            
              x
              
                1
              
            
            ,
            …
            )
            :
            
              x
              
                j
              
            
            ∈
            V
            ,
            
              A
              
                
                  x
                  
                    j
                  
                
                
                  x
                  
                    j
                    +
                    1
                  
                
              
            
            =
            1
            ,
            j
            ∈
            
              Z
            
          
          }
        
        .
      
    
    {\displaystyle \Sigma _{A}=\left\{(\ldots ,x_{-1},x_{0},x_{1},\ldots ):x_{j}\in V,A_{x_{j}x_{j+1}}=1,j\in \mathbb {Z} \right\}.}
  

Edge shifts are a subset of the subshifts of finite type whose set of forbidden words comprise only two-letter words. On the other hand, it can be shown that every subshift of finite type is topologically conjugate to an edge shift via a local recoding.
An edge shift is called transitive if G is strongly connected: there is a sequence of edges from any one vertex to any other vertex. Subshifts of finite type with dense orbits are precisely those that are conjugate to a transitive edge shift.
An important special case is the full n-shift: it has a graph with an edge that connects every vertex to every other vertex; that is, all of the entries of the adjacency matrix are 1.  The full n-shift corresponds to the Bernoulli scheme without the measure.


== Terminology ==
By convention, the term shift is understood to refer to the full n-shift.  A subshift is then any subspace of the full shift that is shift-invariant (that is, a subspace that is invariant under the action of the shift operator), non-empty, and closed for the product topology defined below. Some subshifts can be characterized by a transition matrix, as above; such subshifts are then called subshifts of finite type.  Often, subshifts of finite type are called simply shifts of finite type. Subshifts of finite type are also sometimes called topological Markov shifts.


== Examples ==
Many chaotic dynamical systems are isomorphic to subshifts of finite type; examples include systems with transverse homoclinic connections, diffeomorphisms of closed manifolds with positive metric entropy, and piecewise-linear Markov maps of the interval.


== Topology ==
A subshift has a natural topology, derived from the product topology on ⁠
  
    
      
        
          V
          
            
              Z
            
          
        
        ,
      
    
    {\displaystyle V^{\mathbb {Z} },}
  
⁠ where

  
    
      
        
          V
          
            
              Z
            
          
        
        =
        
          ∏
          
            n
            ∈
            
              Z
            
          
        
        V
        =
        {
        x
        =
        (
        …
        ,
        
          x
          
            −
            1
          
        
        ,
        
          x
          
            0
          
        
        ,
        
          x
          
            1
          
        
        ,
        …
        )
        :
        
          x
          
            k
          
        
        ∈
        V
        
        ∀
        k
        ∈
        
          Z
        
        }
      
    
    {\displaystyle V^{\mathbb {Z} }=\prod _{n\in \mathbb {Z} }V=\{x=(\ldots ,x_{-1},x_{0},x_{1},\ldots ):x_{k}\in V\;\forall k\in \mathbb {Z} \}}
  

and V is given the discrete topology. 
A basis for the topology of ⁠
  
    
      
        
          V
          
            
              Z
            
          
        
        ,
      
    
    {\displaystyle V^{\mathbb {Z} },}
  
⁠ which induces the topology of the subshift, is the family of cylinder sets

  
    
      
        
          C
          
            t
          
        
        [
        
          a
          
            0
          
        
        ,
        …
        ,
        
          a
          
            s
          
        
        ]
        =
        {
        x
        ∈
        
          V
          
            
              Z
            
          
        
        :
        
          x
          
            t
          
        
        =
        
          a
          
            0
          
        
        ,
        …
        ,
        
          x
          
            t
            +
            s
          
        
        =
        
          a
          
            s
          
        
        }
      
    
    {\displaystyle C_{t}[a_{0},\ldots ,a_{s}]=\{x\in V^{\mathbb {Z} }:x_{t}=a_{0},\ldots ,x_{t+s}=a_{s}\}}
  

The cylinder sets are clopen sets in ⁠
  
    
      
        
          V
          
            
              Z
            
          
        
        .
      
    
    {\displaystyle V^{\mathbb {Z} }.}
  
⁠ Every open set in ⁠
  
    
      
        
          V
          
            
              Z
            
          
        
      
    
    {\displaystyle V^{\mathbb {Z} }}
  
⁠ is a countable union of cylinder sets. Every open set in the subshift is the intersection of an open set of ⁠
  
    
      
        
          V
          
            
              Z
            
          
        
      
    
    {\displaystyle V^{\mathbb {Z} }}
  
⁠ with the subshift. With respect to this topology, the shift T is a homeomorphism; that is,  with respect to this topology, it is continuous with continuous inverse.
The space ⁠
  
    
      
        
          V
          
            
              Z
            
          
        
      
    
    {\displaystyle V^{\mathbb {Z} }}
  
⁠ is homeomorphic to a Cantor set.


== Metric ==
A variety of different metrics can be defined on a shift space. One can define a metric on a shift space by considering two points to be "close" if they have many initial symbols in common; this is the p-adic metric. In fact, both the one- and two-sided shift spaces are compact metric spaces.


== Measure ==
A subshift of finite type may be endowed with any one of several different measures, thus leading to a measure-preserving dynamical system. A common object of study is the Markov measure, which is an extension of a Markov chain to the topology of the shift.
A Markov chain is a pair (P, π) consisting of the transition matrix, an n × n matrix P = (pij) for which all pij ≥ 0 and

  
    
      
        
          ∑
          
            j
            =
            1
          
          
            n
          
        
        
          p
          
            i
            j
          
        
        =
        1
      
    
    {\displaystyle \sum _{j=1}^{n}p_{ij}=1}
  

for all i. The stationary probability vector π = (πi) has all πi ≥ 0, 
  
    
      
        ∑
        
          π
          
            i
          
        
        =
        1
      
    
    {\textstyle \sum \pi _{i}=1}
  
 and has

  
    
      
        
          ∑
          
            i
            =
            1
          
          
            n
          
        
        
          π
          
            i
          
        
        
          p
          
            i
            j
          
        
        =
        
          π
          
            j
          
        
        .
      
    
    {\displaystyle \sum _{i=1}^{n}\pi _{i}p_{ij}=\pi _{j}.}
  

A Markov chain, as defined above, is said to be compatible with the shift of finite type if pij = 0 whenever Aij = 0.  The Markov measure of a cylinder set may then be defined by

  
    
      
        μ
        (
        
          C
          
            t
          
        
        [
        
          a
          
            0
          
        
        ,
        …
        ,
        
          a
          
            s
          
        
        ]
        )
        =
        
          π
          
            
              a
              
                0
              
            
          
        
        
          p
          
            
              a
              
                0
              
            
            ,
            
              a
              
                1
              
            
          
        
        ⋯
        
          p
          
            
              a
              
                s
                −
                1
              
            
            ,
            
              a
              
                s
              
            
          
        
      
    
    {\displaystyle \mu (C_{t}[a_{0},\ldots ,a_{s}])=\pi _{a_{0}}p_{a_{0},a_{1}}\cdots p_{a_{s-1},a_{s}}}
  

The Kolmogorov–Sinai entropy with relation to the Markov measure is

  
    
      
        
          s
          
            μ
          
        
        =
        −
        
          ∑
          
            i
            =
            1
          
          
            n
          
        
        
          π
          
            i
          
        
        
          ∑
          
            j
            =
            1
          
          
            n
          
        
        
          p
          
            i
            j
          
        
        log
        ⁡
        
          p
          
            i
            j
          
        
      
    
    {\displaystyle s_{\mu }=-\sum _{i=1}^{n}\pi _{i}\sum _{j=1}^{n}p_{ij}\log p_{ij}}
  


=== Markov and non-Markov measures ===

As above, given a Markov transition matrix and an invariant distribution on the states, we can impose a probability measure on the subshift. For example, consider the Markov chain given on the left on the states 
  
    
      
        A
        ,
        
          B
          
            1
          
        
        ,
        
          B
          
            2
          
        
      
    
    {\displaystyle A,B_{1},B_{2}}
  
, with invariant distribution 
  
    
      
        π
        =
        (
        2
        
          /
        
        7
        ,
        4
        
          /
        
        7
        ,
        1
        
          /
        
        7
        )
      
    
    {\displaystyle \pi =(2/7,4/7,1/7)}
  
. If we "forget" the distinction between 
  
    
      
        
          B
          
            1
          
        
        ,
        
          B
          
            2
          
        
      
    
    {\displaystyle B_{1},B_{2}}
  
, we project this subshift on 
  
    
      
        A
        ,
        
          B
          
            1
          
        
        ,
        
          B
          
            2
          
        
      
    
    {\displaystyle A,B_{1},B_{2}}
  
 onto a subshift on 
  
    
      
        A
        ,
        B
      
    
    {\displaystyle A,B}
  
, and this projection also projects the probability measure down to a probability measure on the subshift on 
  
    
      
        A
        ,
        B
      
    
    {\displaystyle A,B}
  
.
The curious thing is that the probability measure on the subshift on 
  
    
      
        A
        ,
        B
      
    
    {\displaystyle A,B}
  
 is not created by a Markov chain on 
  
    
      
        A
        ,
        B
      
    
    {\displaystyle A,B}
  
, not even multiple orders. Intuitively, this is because if one observes a long sequence of 
  
    
      
        
          B
          
            n
          
        
      
    
    {\displaystyle B^{n}}
  
, then one would become increasingly sure that the 
  
    
      
        P
        r
        (
        A
        
          |
        
        
          B
          
            n
          
        
        )
        →
        
          
            2
            3
          
        
      
    
    {\displaystyle Pr(A|B^{n})\to {\frac {2}{3}}}
  
, meaning that the observable part of the system can be affected by something infinitely in the past.
Conversely, there exists a subshift on 6 symbols, projected to a subshift on 2 symbols, such that any Markov measure on the smaller subshift has a preimage measure that is not Markov of any order (Example 2.6 ).


== Zeta function ==
The Artin–Mazur zeta function is defined as the formal power series

  
    
      
        ζ
        (
        z
        )
        =
        exp
        ⁡
        
          (
          
            
              ∑
              
                n
                =
                1
              
              
                ∞
              
            
            
              
                |
              
            
            
              
                Fix
              
            
            (
            
              T
              
                n
              
            
            )
            
              
                |
              
            
            
              
                
                  z
                  
                    n
                  
                
                n
              
            
          
          )
        
        ,
      
    
    {\displaystyle \zeta (z)=\exp \left(\sum _{n=1}^{\infty }{\Bigl |}{\textrm {Fix}}(T^{n}){\Bigr |}{\frac {z^{n}}{n}}\right),}
  

where Fix(T n) is the set of fixed points of the n-fold shift.   It has a product formula

  
    
      
        ζ
        (
        z
        )
        =
        
          ∏
          
            γ
          
        
        
          
            (
            
              1
              −
              
                z
                
                  
                    |
                  
                  γ
                  
                    |
                  
                
              
            
            )
          
          
            −
            1
          
        
         
      
    
    {\displaystyle \zeta (z)=\prod _{\gamma }\left(1-z^{|\gamma |}\right)^{-1}\ }
  

where γ runs over the closed orbits.  For subshifts of finite type, the zeta function is a rational function of z:

  
    
      
        ζ
        (
        z
        )
        =
        (
        det
        (
        I
        −
        z
        A
        )
        
          )
          
            −
            1
          
        
         
        .
      
    
    {\displaystyle \zeta (z)=(\det(I-zA))^{-1}\ .}
  


== Generalizations ==
A sofic shift is an image of a subshift of finite type where different edges of the transition graph may be mapped to the same symbol. For example, if one only watches the output from a hidden Markov chain, then the output appears to be a sofic system. It may be regarded as the set of labellings of paths through an automaton: a subshift of finite type then corresponds to an automaton which is deterministic. Such systems correspond to regular languages.
Context-free systems are defined analogously, and are generated by phrase structure grammars.
A renewal system is defined to be the set of all infinite concatenations of some fixed finite collection of finite words.
Subshifts of finite type are identical to free (non-interacting) one-dimensional Potts models (n-letter generalizations of Ising models),  with certain nearest-neighbor configurations excluded. Interacting Ising models are defined as subshifts together with a continuous function of the configuration space (continuous with respect to the product topology, defined below); the partition function and Hamiltonian are explicitly expressible in terms of this function.
Subshifts may be quantized in a certain way, leading to the idea of the quantum finite automata.


== See also ==
Shift space
Transfer operator
De Bruijn graph
Quantum finite automata
Axiom A


== Notes ==


== References ==
Brin, Michael; Stuck, Garrett (2002). Introduction to Dynamical Systems (2nd ed.). Cambridge University Press. ISBN 0-521-80841-3.
David Damanik, Strictly Ergodic Subshifts and Associated Operators, (2005)
Pytheas Fogg, N. (2002). Berthé, Valérie; Ferenczi, Sébastien; Mauduit, Christian; Siegel, A. (eds.). Substitutions in dynamics, arithmetics and combinatorics. Lecture Notes in Mathematics. Vol. 1794. Berlin: Springer-Verlag. ISBN 3-540-44141-7. Zbl 1014.11015.
Natasha Jonoska, Subshifts of Finite Type, Sofic Systems and Graphs, (2000).
Michael S. Keane, Ergodic theory and subshifts of finite type, (1991), appearing as Chapter 2 in Ergodic Theory, Symbolic Dynamics and Hyperbolic Spaces, Tim Bedford, Michael Keane and Caroline Series, Eds. Oxford University Press, Oxford (1991). ISBN 0-19-853390-X (Provides a short expository introduction, with exercises, and extensive references.)
Lind, Douglas; Marcus, Brian (1995). An introduction to symbolic dynamics and coding. Cambridge University Press. ISBN 0-521-55124-2. Zbl 1106.37301.
Teschl, Gerald (2012). Ordinary Differential Equations and Dynamical Systems. Providence: American Mathematical Society. ISBN 978-0-8218-8328-0.
Xie, Huimin (1996). Grammatical Complexity and One-Dimensional Dynamical Systems. Directions in Chaos. Vol. 6. World Scientific. ISBN 9810223986.


== Further reading ==
Williams, Susan G., ed. (2004). Symbolic Dynamics and Its Applications: American Mathematical Society, Short Course, January 4-5, 2002, San Diego, California. Proceedings of symposia in applied mathematics: AMS short course lecture notes. Vol. 60. American Mathematical Society. ISBN 0-8218-3157-7. Zbl 1052.37003.