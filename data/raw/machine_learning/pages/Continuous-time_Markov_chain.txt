A continuous-time Markov chain (CTMC) is a continuous stochastic process in which, for each state, the process will change state according to an exponential random variable and then move to a different state as specified by the probabilities of a stochastic matrix. An equivalent formulation describes the process as changing state according to the least value of a set of exponential random variables, one for each possible state it can move to, with the parameters determined by the current state.
An example of a CTMC with three states 
  
    
      
        {
        0
        ,
        1
        ,
        2
        }
      
    
    {\displaystyle \{0,1,2\}}
  
 is as follows: the process makes a transition after the amount of time specified by the holding time—an exponential random variable 
  
    
      
        
          E
          
            i
          
        
      
    
    {\displaystyle E_{i}}
  
, where i is its current state. Each random variable is independent and such that 
  
    
      
        
          E
          
            0
          
        
        ∼
        
          Exp
        
        (
        6
        )
      
    
    {\displaystyle E_{0}\sim {\text{Exp}}(6)}
  
, 
  
    
      
        
          E
          
            1
          
        
        ∼
        
          Exp
        
        (
        12
        )
      
    
    {\displaystyle E_{1}\sim {\text{Exp}}(12)}
  
 and 
  
    
      
        
          E
          
            2
          
        
        ∼
        
          Exp
        
        (
        18
        )
      
    
    {\displaystyle E_{2}\sim {\text{Exp}}(18)}
  
. When a transition is to be made, the process moves according to the jump chain, a discrete-time Markov chain with stochastic matrix:

  
    
      
        
          
            [
            
              
                
                  0
                
                
                  
                    
                      1
                      2
                    
                  
                
                
                  
                    
                      1
                      2
                    
                  
                
              
              
                
                  
                    
                      1
                      3
                    
                  
                
                
                  0
                
                
                  
                    
                      2
                      3
                    
                  
                
              
              
                
                  
                    
                      5
                      6
                    
                  
                
                
                  
                    
                      1
                      6
                    
                  
                
                
                  0
                
              
            
            ]
          
        
        .
      
    
    {\displaystyle {\begin{bmatrix}0&{\frac {1}{2}}&{\frac {1}{2}}\\{\frac {1}{3}}&0&{\frac {2}{3}}\\{\frac {5}{6}}&{\frac {1}{6}}&0\end{bmatrix}}.}
  

Equivalently, by the property of competing exponentials, this CTMC changes state from state i according to the minimum of two random variables, which are independent and such that 
  
    
      
        
          E
          
            i
            ,
            j
          
        
        ∼
        
          Exp
        
        (
        
          q
          
            i
            ,
            j
          
        
        )
      
    
    {\displaystyle E_{i,j}\sim {\text{Exp}}(q_{i,j})}
  
 for 
  
    
      
        i
        ≠
        j
      
    
    {\displaystyle i\neq j}
  
 where the parameters are given by the Q-matrix 
  
    
      
        Q
        =
        (
        
          q
          
            i
            ,
            j
          
        
        )
      
    
    {\displaystyle Q=(q_{i,j})}
  

  
    
      
        
          
            [
            
              
                
                  −
                  6
                
                
                  3
                
                
                  3
                
              
              
                
                  4
                
                
                  −
                  12
                
                
                  8
                
              
              
                
                  15
                
                
                  3
                
                
                  −
                  18
                
              
            
            ]
          
        
        .
      
    
    {\displaystyle {\begin{bmatrix}-6&3&3\\4&-12&8\\15&3&-18\end{bmatrix}}.}
  

Each non-diagonal entry 
  
    
      
        
          q
          
            i
            ,
            j
          
        
      
    
    {\displaystyle q_{i,j}}
  
 can be computed as the probability that the jump chain moves from state i to state j, divided by the expected holding time of state i. The diagonal entries are chosen so that each row sums to 0.
A CTMC satisfies the Markov property, that its behavior depends only on its current state and not on its past behavior, due to the memorylessness of the exponential distribution and of discrete-time Markov chains.


== Definition ==
Let 
  
    
      
        (
        Ω
        ,
        
          
            A
          
        
        ,
        Pr
        )
      
    
    {\displaystyle (\Omega ,{\cal {A}},\Pr )}
  
 be a probability space, let 
  
    
      
        S
      
    
    {\displaystyle S}
  
 be a countable nonempty set, and let 
  
    
      
        T
        =
        
          
            R
          
          
            ≥
            0
          
        
      
    
    {\displaystyle T=\mathbb {R} _{\geq 0}}
  
 (
  
    
      
        T
      
    
    {\displaystyle T}
  
 for "time"). Equip 
  
    
      
        S
      
    
    {\displaystyle S}
  
 with the discrete metric, so that we can make sense of right continuity of functions 
  
    
      
        
          
            R
          
          
            ≥
            0
          
        
        →
        S
      
    
    {\displaystyle \mathbb {R} _{\geq 0}\to S}
  
. A continuous-time Markov chain is defined by:

A probability vector 
  
    
      
        λ
      
    
    {\displaystyle \lambda }
  
 on 
  
    
      
        S
      
    
    {\displaystyle S}
  
 (which below we will interpret as the initial distribution of the Markov chain), and
A rate matrix 
  
    
      
        Q
      
    
    {\displaystyle Q}
  
 on 
  
    
      
        S
      
    
    {\displaystyle S}
  
, that is, a function 
  
    
      
        Q
        :
        
          S
          
            2
          
        
        →
        
          R
        
      
    
    {\displaystyle Q:S^{2}\to \mathbb {R} }
  
 such that
for all distinct 
  
    
      
        i
        ,
        j
        ∈
        S
        ,
        0
        ≤
        
          q
          
            i
            ,
            j
          
        
      
    
    {\displaystyle i,j\in S,0\leq q_{i,j}}
  
,
for all 
  
    
      
        i
        ∈
        S
        ,
      
    
    {\displaystyle i\in S,}
  
 
  
    
      
        
          ∑
          
            j
            ∈
            S
            :
            j
            ≠
            i
          
        
        
          q
          
            i
            ,
            j
          
        
        =
        −
        
          q
          
            i
            ,
            i
          
        
        .
      
    
    {\displaystyle \sum _{j\in S:j\neq i}q_{i,j}=-q_{i,i}.}
  
 (Even if 
  
    
      
        S
      
    
    {\displaystyle S}
  
 is infinite, this sum is a priori well defined (possibly equalling 
  
    
      
        +
        ∞
      
    
    {\displaystyle +\infty }
  
) because each term appearing in the sum is nonnegative. A posteriori, we know the sum must also be finite (not equal to 
  
    
      
        +
        ∞
      
    
    {\displaystyle +\infty }
  
), since we're assuming it's equal to 
  
    
      
        −
        
          q
          
            i
            ,
            i
          
        
      
    
    {\displaystyle -q_{i,i}}
  
 and we've assumed 
  
    
      
        Q
      
    
    {\displaystyle Q}
  
 is real valued. Some authors instead use a definition that's word-for-word the same except for a modified stipulation 
  
    
      
        Q
        :
        
          S
          
            2
          
        
        →
        
          R
        
        ∪
        {
        −
        ∞
        }
      
    
    {\displaystyle Q:S^{2}\to \mathbb {R} \cup \{-\infty \}}
  
, and say 
  
    
      
        Q
      
    
    {\displaystyle Q}
  
 is stable or totally stable to mean 
  
    
      
        range
        ⁡
        Q
        ⊆
        
          R
        
      
    
    {\displaystyle \operatorname {range} Q\subseteq \mathbb {R} }
  
, i.e., every entry is real valued.)
Note that the row sums of 
  
    
      
        Q
      
    
    {\displaystyle Q}
  
 are 0: 
  
    
      
        ∀
        i
        ∈
        S
        ,
         
        
          ∑
          
            j
            ∈
            S
          
        
        
          q
          
            i
            ,
            j
          
        
        =
        0
        ,
      
    
    {\displaystyle \forall i\in S,~\sum _{j\in S}q_{i,j}=0,}
  
 or more succinctly, 
  
    
      
        Q
        ⋅
        1
        =
        0
      
    
    {\displaystyle Q\cdot 1=0}
  
. This situation contrasts with the situation for discrete-time Markov chains, where all row sums of the transition matrix equal unity.
Now, let 
  
    
      
        X
        :
        T
        →
        
          S
          
            Ω
          
        
      
    
    {\displaystyle X:T\to S^{\Omega }}
  
 such that 
  
    
      
        ∀
        t
        ∈
        T
         
        X
        (
        t
        )
      
    
    {\displaystyle \forall t\in T~X(t)}
  
 is 
  
    
      
        (
        
          
            A
          
        
        ,
        
          
            P
          
        
        (
        S
        )
        )
      
    
    {\displaystyle ({\cal {A}},{\cal {P}}(S))}
  
-measurable. There are three equivalent ways to define 
  
    
      
        X
      
    
    {\displaystyle X}
  
 being Markov with initial distribution 
  
    
      
        λ
      
    
    {\displaystyle \lambda }
  
 and rate matrix 
  
    
      
        Q
      
    
    {\displaystyle Q}
  
: via transition probabilities or via the jump chain and holding times.
As a prelude to a transition-probability definition, we first motivate the definition of a regular rate matrix. We will use the transition-rate matrix 
  
    
      
        Q
      
    
    {\displaystyle Q}
  
 to specify the dynamics of the Markov chain by means of generating a collection of transition matrices 
  
    
      
        P
        (
        t
        )
      
    
    {\displaystyle P(t)}
  
 on 
  
    
      
        S
      
    
    {\displaystyle S}
  
 (
  
    
      
        t
        ∈
        
          
            R
          
          
            ≥
            0
          
        
      
    
    {\displaystyle t\in \mathbb {R} _{\geq 0}}
  
), via the following theorem.

We say 
  
    
      
        Q
      
    
    {\displaystyle Q}
  
 is regular to mean that we do have uniqueness for the above system, i.e., that there exists exactly one solution. We say 
  
    
      
        Q
      
    
    {\displaystyle Q}
  
 is irregular to mean 
  
    
      
        Q
      
    
    {\displaystyle Q}
  
 is not regular. If 
  
    
      
        S
      
    
    {\displaystyle S}
  
 is finite, then there is exactly one solution, namely 
  
    
      
        P
        =
        (
        
          e
          
            t
            Q
          
        
        
          )
          
            t
            ∈
            T
          
        
        ,
      
    
    {\displaystyle P=(e^{tQ})_{t\in T},}
  
 and hence 
  
    
      
        Q
      
    
    {\displaystyle Q}
  
 is regular. Otherwise, 
  
    
      
        S
      
    
    {\displaystyle S}
  
 is infinite, and there exist irregular transition-rate matrices on 
  
    
      
        S
      
    
    {\displaystyle S}
  
. If 
  
    
      
        Q
      
    
    {\displaystyle Q}
  
 is regular, then for the unique solution 
  
    
      
        P
      
    
    {\displaystyle P}
  
, for each 
  
    
      
        t
        ∈
        T
      
    
    {\displaystyle t\in T}
  
, 
  
    
      
        P
        (
        t
        )
      
    
    {\displaystyle P(t)}
  
 will be a stochastic matrix. We will assume 
  
    
      
        Q
      
    
    {\displaystyle Q}
  
 is regular from the beginning of the following subsection up through the end of this section, even though it is conventional to not include this assumption. (Note for the expert: thus we are not defining continuous-time Markov chains in general but only non-explosive continuous-time Markov chains.)


=== Transition-probability definition ===
Let 
  
    
      
        P
      
    
    {\displaystyle P}
  
 be the (unique) solution of the system (0). (Uniqueness guaranteed by our assumption that 
  
    
      
        Q
      
    
    {\displaystyle Q}
  
 is regular.) We say 
  
    
      
        X
      
    
    {\displaystyle X}
  
 is Markov with initial distribution 
  
    
      
        λ
      
    
    {\displaystyle \lambda }
  
 and rate matrix 
  
    
      
        Q
      
    
    {\displaystyle Q}
  
 to mean: for any nonnegative integer 
  
    
      
        n
        ≥
        0
      
    
    {\displaystyle n\geq 0}
  
, for all 
  
    
      
        
          t
          
            0
          
        
        ,
        …
        ,
        
          t
          
            n
            +
            1
          
        
        ∈
        T
      
    
    {\displaystyle t_{0},\dots ,t_{n+1}\in T}
  
 such that 
  
    
      
        
          t
          
            0
          
        
        <
        ⋯
        <
        
          t
          
            n
            +
            1
          
        
        ,
      
    
    {\displaystyle t_{0}<\dots <t_{n+1},}
  
 for all 
  
    
      
        
          i
          
            0
          
        
        ,
        …
        ,
        
          i
          
            n
            +
            1
          
        
        ∈
        I
        ,
      
    
    {\displaystyle i_{0},\dots ,i_{n+1}\in I,}
  

Using induction and the fact that 
  
    
      
        ∀
        A
        ,
        B
        ∈
        
          
            A
          
        
         
         
        Pr
        (
        B
        )
        ≠
        0
        →
        Pr
        (
        A
        ∩
        B
        )
        =
        Pr
        (
        A
        ∣
        B
        )
        Pr
        (
        B
        )
        ,
      
    
    {\displaystyle \forall A,B\in {\cal {A}}~~\Pr(B)\neq 0\rightarrow \Pr(A\cap B)=\Pr(A\mid B)\Pr(B),}
  
 we can show the equivalence of the above statement containing (1) and the following statement: for all 
  
    
      
        i
        ∈
        I
        ,
         
        Pr
        (
        
          X
          
            0
          
        
        =
        i
        )
        =
        
          λ
          
            i
          
        
      
    
    {\displaystyle i\in I,~\Pr(X_{0}=i)=\lambda _{i}}
  
 and for any nonnegative integer 
  
    
      
        n
        ≥
        0
      
    
    {\displaystyle n\geq 0}
  
, for all 
  
    
      
        
          t
          
            0
          
        
        ,
        …
        ,
        
          t
          
            n
            +
            1
          
        
        ∈
        T
      
    
    {\displaystyle t_{0},\dots ,t_{n+1}\in T}
  
 such that 
  
    
      
        
          t
          
            0
          
        
        <
        ⋯
        <
        
          t
          
            n
            +
            1
          
        
        ,
      
    
    {\displaystyle t_{0}<\dots <t_{n+1},}
  
 for all 
  
    
      
        
          i
          
            0
          
        
        ,
        …
        ,
        
          i
          
            n
            +
            1
          
        
        ∈
        I
      
    
    {\displaystyle i_{0},\dots ,i_{n+1}\in I}
  
 such that 
  
    
      
        0
        <
        Pr
        (
        
          X
          
            0
          
        
        =
        
          i
          
            0
          
        
        ,
        …
        ,
        
          X
          
            
              t
              
                n
              
            
          
        
        =
        
          i
          
            n
          
        
        )
      
    
    {\displaystyle 0<\Pr(X_{0}=i_{0},\dots ,X_{t_{n}}=i_{n})}
  
 (it follows that 
  
    
      
        0
        <
        Pr
        (
        
          X
          
            
              t
              
                n
              
            
          
        
        =
        
          i
          
            n
          
        
        )
      
    
    {\displaystyle 0<\Pr(X_{t_{n}}=i_{n})}
  
),

It follows from continuity of the functions 
  
    
      
        (
        P
        (
        t
        
          )
          
            i
            ,
            j
          
        
        
          )
          
            t
            ∈
            T
          
        
      
    
    {\displaystyle (P(t)_{i,j})_{t\in T}}
  
 (
  
    
      
        i
        ,
        j
        ∈
        S
      
    
    {\displaystyle i,j\in S}
  
) that the trajectory 
  
    
      
        (
        
          X
          
            t
          
        
        (
        ω
        )
        
          )
          
            t
            ∈
            T
          
        
      
    
    {\displaystyle (X_{t}(\omega ))_{t\in T}}
  
 is almost surely right continuous (with respect to the discrete metric on 
  
    
      
        S
      
    
    {\displaystyle S}
  
): there exists a 
  
    
      
        Pr
      
    
    {\displaystyle \Pr }
  
-null set 
  
    
      
        N
      
    
    {\displaystyle N}
  
 such that 
  
    
      
        {
        ω
        ∈
        Ω
        :
        (
        
          X
          
            t
          
        
        (
        ω
        )
        
          )
          
            t
            ∈
            T
          
        
        
           is right continuous
        
        }
        ⊆
        N
      
    
    {\displaystyle \{\omega \in \Omega :(X_{t}(\omega ))_{t\in T}{\text{ is right continuous}}\}\subseteq N}
  
.


=== Jump-chain/holding-time definition ===


==== Sequences associated to a right-continuous function ====
Let 
  
    
      
        f
        :
        T
        →
        S
      
    
    {\displaystyle f:T\to S}
  
 be right continuous (when we equip 
  
    
      
        S
      
    
    {\displaystyle S}
  
 with the discrete metric). Define

  
    
      
        h
        =
        h
        (
        f
        )
        =
        (
        inf
        {
        u
        ∈
        (
        0
        ,
        +
        ∞
        )
        :
        f
        (
        t
        +
        u
        )
        ≠
        f
        (
        t
        )
        }
        
          )
          
            t
            ∈
            T
          
        
        )
        ∪
        {
        +
        ∞
        ,
        0
        }
        ,
      
    
    {\displaystyle h=h(f)=(\inf\{u\in (0,+\infty ):f(t+u)\neq f(t)\})_{t\in T})\cup \{+\infty ,0\},}
  

let 

  
    
      
        H
        =
        H
        (
        f
        )
        =
        (
        
          h
          
            ∘
            n
          
        
        0
        
          )
          
            n
            ∈
            
              
                Z
              
              
                ≥
                0
              
            
          
        
      
    
    {\displaystyle H=H(f)=(h^{\circ n}0)_{n\in \mathbb {Z} _{\geq 0}}}
  

be the holding-time sequence associated to 
  
    
      
        f
      
    
    {\displaystyle f}
  
, choose 
  
    
      
        s
        ∈
        S
        ,
      
    
    {\displaystyle s\in S,}
  
 and let

  
    
      
        y
        =
        y
        (
        f
        )
        =
        
          
            (
            
              
                {
                
                  
                    
                      f
                      (
                      
                        ∑
                        
                          k
                          ∈
                          n
                        
                      
                      
                        H
                        
                          k
                        
                      
                      )
                    
                    
                      
                         if 
                      
                      
                        ∑
                        
                          k
                          ∈
                          n
                        
                      
                      
                        H
                        
                          k
                        
                      
                      <
                      +
                      ∞
                      ,
                    
                  
                  
                    
                      s
                    
                    
                      
                         else
                      
                    
                  
                
                
              
            
            )
          
          
            n
            ∈
            ω
          
        
      
    
    {\displaystyle y=y(f)=\left({\begin{cases}f(\sum _{k\in n}H_{k})&{\text{ if }}\sum _{k\in n}H_{k}<+\infty ,\\s&{\text{ else}}\end{cases}}\right)_{n\in \omega }}
  

be "the state sequence" associated to 
  
    
      
        f
      
    
    {\displaystyle f}
  
.


==== Definition of the jump matrix Π ====
The jump matrix 
  
    
      
        Π
      
    
    {\displaystyle \Pi }
  
, alternatively written 
  
    
      
        Π
        (
        Q
        )
      
    
    {\displaystyle \Pi (Q)}
  
 if we wish to emphasize the dependence on 
  
    
      
        Q
      
    
    {\displaystyle Q}
  
, is the matrix

  
    
      
        Π
        =
        (
        [
        i
        =
        j
        ]
        
          )
          
            i
            ∈
            Z
            ,
            j
            ∈
            S
          
        
        ∪
        
          ⋃
          
            i
            ∈
            S
            ∖
            Z
          
        
        (
        {
        (
        (
        i
        ,
        j
        )
        ,
        −
        
          q
          
            i
            ,
            j
          
        
        
          /
        
        
          q
          
            i
            ,
            i
          
        
        )
        :
        j
        ∈
        S
        ∖
        {
        i
        }
        }
        ∪
        {
        (
        (
        i
        ,
        i
        )
        ,
        0
        )
        }
        )
        ,
      
    
    {\displaystyle \Pi =([i=j])_{i\in Z,j\in S}\cup \bigcup _{i\in S\setminus Z}(\{((i,j),-q_{i,j}/q_{i,i}):j\in S\setminus \{i\}\}\cup \{((i,i),0)\}),}
  

where 
  
    
      
        Z
        =
        Z
        (
        Q
        )
        =
        {
        k
        ∈
        S
        :
        
          q
          
            k
            ,
            k
          
        
        =
        0
        }
      
    
    {\displaystyle Z=Z(Q)=\{k\in S:q_{k,k}=0\}}
  
 is the zero set of the function 
  
    
      
        (
        
          q
          
            k
            ,
            k
          
        
        
          )
          
            k
            ∈
            S
          
        
        .
      
    
    {\displaystyle (q_{k,k})_{k\in S}.}
  


==== Jump-chain/holding-time property ====
We say 
  
    
      
        X
      
    
    {\displaystyle X}
  
 is Markov with initial distribution 
  
    
      
        λ
      
    
    {\displaystyle \lambda }
  
 and rate matrix 
  
    
      
        Q
      
    
    {\displaystyle Q}
  
 to mean: the trajectories of 
  
    
      
        X
      
    
    {\displaystyle X}
  
 are almost surely right continuous, let 
  
    
      
        f
      
    
    {\displaystyle f}
  
 be a modification of 
  
    
      
        X
      
    
    {\displaystyle X}
  
 to have (everywhere) right-continuous trajectories, 
  
    
      
        
          ∑
          
            n
            ∈
            
              
                Z
              
              
                ≥
                0
              
            
          
        
        H
        (
        f
        (
        ω
        )
        
          )
          
            n
          
        
        =
        +
        ∞
      
    
    {\displaystyle \sum _{n\in \mathbb {Z} _{\geq 0}}H(f(\omega ))_{n}=+\infty }
  
 almost surely (note to experts: this condition says 
  
    
      
        X
      
    
    {\displaystyle X}
  
 is non-explosive), the state sequence 
  
    
      
        y
        (
        f
        (
        ω
        )
        )
      
    
    {\displaystyle y(f(\omega ))}
  
 is a discrete-time Markov chain with initial distribution 
  
    
      
        λ
      
    
    {\displaystyle \lambda }
  
 (jump-chain property) and transition matrix 
  
    
      
        Π
        (
        Q
        )
        ,
      
    
    {\displaystyle \Pi (Q),}
  
 and 
  
    
      
        ∀
        n
        ∈
        
          
            Z
          
          
            ≥
            0
          
        
         
        ∀
        B
        ∈
        
          
            B
          
        
        (
        
          
            R
          
          
            ≥
            0
          
        
        )
         
        Pr
        (
        
          H
          
            n
          
        
        (
        f
        )
        ∈
        B
        )
        =
        Exp
        ⁡
        (
        −
        
          q
          
            
              Y
              
                n
              
            
            ,
            
              Y
              
                n
              
            
          
        
        )
        (
        B
        )
      
    
    {\displaystyle \forall n\in \mathbb {Z} _{\geq 0}~\forall B\in {\cal {B}}(\mathbb {R} _{\geq 0})~\Pr(H_{n}(f)\in B)=\operatorname {Exp} (-q_{Y_{n},Y_{n}})(B)}
  
 (holding-time property).


=== Infinitesimal definition ===

We say 
  
    
      
        X
      
    
    {\displaystyle X}
  
 is Markov with initial distribution 
  
    
      
        λ
      
    
    {\displaystyle \lambda }
  
 and rate matrix 
  
    
      
        Q
      
    
    {\displaystyle Q}
  
 to mean: for all 
  
    
      
        i
        ∈
        S
        ,
      
    
    {\displaystyle i\in S,}
  
 
  
    
      
        Pr
        (
        X
        (
        0
        )
        =
        i
        )
        =
        
          λ
          
            i
          
        
      
    
    {\displaystyle \Pr(X(0)=i)=\lambda _{i}}
  
 and for all 
  
    
      
        i
        ,
        j
      
    
    {\displaystyle i,j}
  
, for all 
  
    
      
        t
      
    
    {\displaystyle t}
  
 and for small strictly positive values of 
  
    
      
        h
      
    
    {\displaystyle h}
  
, the following holds for all 
  
    
      
        t
        ∈
        T
      
    
    {\displaystyle t\in T}
  
 such that 
  
    
      
        0
        <
        Pr
        (
        X
        (
        t
        )
        =
        i
        )
      
    
    {\displaystyle 0<\Pr(X(t)=i)}
  
:

  
    
      
        Pr
        (
        X
        (
        t
        +
        h
        )
        =
        j
        ∣
        X
        (
        t
        )
        =
        i
        )
        =
        [
        i
        =
        j
        ]
        +
        
          q
          
            i
            ,
            j
          
        
        h
        +
        o
        (
        h
        )
      
    
    {\displaystyle \Pr(X(t+h)=j\mid X(t)=i)=[i=j]+q_{i,j}h+o(h)}
  
,
where the term 
  
    
      
        [
        i
        =
        j
        ]
      
    
    {\displaystyle [i=j]}
  
 is 
  
    
      
        1
      
    
    {\displaystyle 1}
  
 if 
  
    
      
        i
        =
        j
      
    
    {\displaystyle i=j}
  
 and otherwise 
  
    
      
        0
      
    
    {\displaystyle 0}
  
, and the little-o term 
  
    
      
        o
        (
        h
        )
      
    
    {\displaystyle o(h)}
  
 depends in a certain way on 
  
    
      
        i
        ,
        j
        ,
        h
      
    
    {\displaystyle i,j,h}
  
.
The above equation shows that 
  
    
      
        
          q
          
            i
            ,
            j
          
        
      
    
    {\displaystyle q_{i,j}}
  
 can be seen as measuring how quickly the transition from 
  
    
      
        i
      
    
    {\displaystyle i}
  
 to 
  
    
      
        j
      
    
    {\displaystyle j}
  
 happens for 
  
    
      
        i
        ≠
        j
      
    
    {\displaystyle i\neq j}
  
, and how quickly the transition away from 
  
    
      
        i
      
    
    {\displaystyle i}
  
 happens for 
  
    
      
        i
        =
        j
      
    
    {\displaystyle i=j}
  
.


== Properties ==


=== Communicating classes ===
Communicating classes, transience, recurrence and positive and null recurrence are defined identically as for discrete-time Markov chains.


=== Transient behaviour ===
Write P(t) for the matrix with entries pij = P(Xt = j | X0 = i). Then the matrix P(t) satisfies the forward equation, a first-order differential equation

  
    
      
        
          P
          ′
        
        (
        t
        )
        =
        P
        (
        t
        )
        Q
      
    
    {\displaystyle P'(t)=P(t)Q}
  
,
where the prime denotes differentiation with respect to t. The solution to this equation is given by a matrix exponential

  
    
      
        P
        (
        t
        )
        =
        
          e
          
            t
            Q
          
        
      
    
    {\displaystyle P(t)=e^{tQ}}
  
.
In a simple case such as a CTMC on the state space {1,2}. The general Q matrix for such a process is the following 2 × 2 matrix with α,β > 0

  
    
      
        Q
        =
        
          
            (
            
              
                
                  −
                  α
                
                
                  α
                
              
              
                
                  β
                
                
                  −
                  β
                
              
            
            )
          
        
        .
      
    
    {\displaystyle Q={\begin{pmatrix}-\alpha &\alpha \\\beta &-\beta \end{pmatrix}}.}
  

The above relation for forward matrix can be solved explicitly in this case to give

  
    
      
        P
        (
        t
        )
        =
        
          
            (
            
              
                
                  
                    
                      β
                      
                        α
                        +
                        β
                      
                    
                  
                  +
                  
                    
                      α
                      
                        α
                        +
                        β
                      
                    
                  
                  
                    e
                    
                      −
                      (
                      α
                      +
                      β
                      )
                      t
                    
                  
                
                
                  
                    
                      α
                      
                        α
                        +
                        β
                      
                    
                  
                  −
                  
                    
                      α
                      
                        α
                        +
                        β
                      
                    
                  
                  
                    e
                    
                      −
                      (
                      α
                      +
                      β
                      )
                      t
                    
                  
                
              
              
                
                  
                    
                      β
                      
                        α
                        +
                        β
                      
                    
                  
                  −
                  
                    
                      β
                      
                        α
                        +
                        β
                      
                    
                  
                  
                    e
                    
                      −
                      (
                      α
                      +
                      β
                      )
                      t
                    
                  
                
                
                  
                    
                      α
                      
                        α
                        +
                        β
                      
                    
                  
                  +
                  
                    
                      β
                      
                        α
                        +
                        β
                      
                    
                  
                  
                    e
                    
                      −
                      (
                      α
                      +
                      β
                      )
                      t
                    
                  
                
              
            
            )
          
        
      
    
    {\displaystyle P(t)={\begin{pmatrix}{\frac {\beta }{\alpha +\beta }}+{\frac {\alpha }{\alpha +\beta }}e^{-(\alpha +\beta )t}&{\frac {\alpha }{\alpha +\beta }}-{\frac {\alpha }{\alpha +\beta }}e^{-(\alpha +\beta )t}\\{\frac {\beta }{\alpha +\beta }}-{\frac {\beta }{\alpha +\beta }}e^{-(\alpha +\beta )t}&{\frac {\alpha }{\alpha +\beta }}+{\frac {\beta }{\alpha +\beta }}e^{-(\alpha +\beta )t}\end{pmatrix}}}
  
.
Computing direct solutions is complicated in larger matrices. The fact that Q is the generator for a semigroup of matrices

  
    
      
        P
        (
        t
        +
        s
        )
        =
        
          e
          
            (
            t
            +
            s
            )
            Q
          
        
        =
        
          e
          
            t
            Q
          
        
        
          e
          
            s
            Q
          
        
        =
        P
        (
        t
        )
        P
        (
        s
        )
      
    
    {\displaystyle P(t+s)=e^{(t+s)Q}=e^{tQ}e^{sQ}=P(t)P(s)}
  

is used.


=== Stationary distribution ===
The stationary distribution for an irreducible recurrent CTMC is the probability distribution to which the process converges for large values of t. Observe that for the two-state process considered earlier with P(t) given by

  
    
      
        P
        (
        t
        )
        =
        
          
            (
            
              
                
                  
                    
                      β
                      
                        α
                        +
                        β
                      
                    
                  
                  +
                  
                    
                      α
                      
                        α
                        +
                        β
                      
                    
                  
                  
                    e
                    
                      −
                      (
                      α
                      +
                      β
                      )
                      t
                    
                  
                
                
                  
                    
                      α
                      
                        α
                        +
                        β
                      
                    
                  
                  −
                  
                    
                      α
                      
                        α
                        +
                        β
                      
                    
                  
                  
                    e
                    
                      −
                      (
                      α
                      +
                      β
                      )
                      t
                    
                  
                
              
              
                
                  
                    
                      β
                      
                        α
                        +
                        β
                      
                    
                  
                  −
                  
                    
                      β
                      
                        α
                        +
                        β
                      
                    
                  
                  
                    e
                    
                      −
                      (
                      α
                      +
                      β
                      )
                      t
                    
                  
                
                
                  
                    
                      α
                      
                        α
                        +
                        β
                      
                    
                  
                  +
                  
                    
                      β
                      
                        α
                        +
                        β
                      
                    
                  
                  
                    e
                    
                      −
                      (
                      α
                      +
                      β
                      )
                      t
                    
                  
                
              
            
            )
          
        
      
    
    {\displaystyle P(t)={\begin{pmatrix}{\frac {\beta }{\alpha +\beta }}+{\frac {\alpha }{\alpha +\beta }}e^{-(\alpha +\beta )t}&{\frac {\alpha }{\alpha +\beta }}-{\frac {\alpha }{\alpha +\beta }}e^{-(\alpha +\beta )t}\\{\frac {\beta }{\alpha +\beta }}-{\frac {\beta }{\alpha +\beta }}e^{-(\alpha +\beta )t}&{\frac {\alpha }{\alpha +\beta }}+{\frac {\beta }{\alpha +\beta }}e^{-(\alpha +\beta )t}\end{pmatrix}}}
  
,
as t → ∞ the distribution tends to

  
    
      
        
          P
          
            π
          
        
        =
        
          
            (
            
              
                
                  
                    
                      β
                      
                        α
                        +
                        β
                      
                    
                  
                
                
                  
                    
                      α
                      
                        α
                        +
                        β
                      
                    
                  
                
              
              
                
                  
                    
                      β
                      
                        α
                        +
                        β
                      
                    
                  
                
                
                  
                    
                      α
                      
                        α
                        +
                        β
                      
                    
                  
                
              
            
            )
          
        
      
    
    {\displaystyle P_{\pi }={\begin{pmatrix}{\frac {\beta }{\alpha +\beta }}&{\frac {\alpha }{\alpha +\beta }}\\{\frac {\beta }{\alpha +\beta }}&{\frac {\alpha }{\alpha +\beta }}\end{pmatrix}}}
  
.
Observe that each row has the same distribution as this does not depend on starting state. The row vector π may be found by solving

  
    
      
        π
        Q
        =
        0
      
    
    {\displaystyle \pi Q=0}
  

with the constraint

  
    
      
        
          ∑
          
            i
            ∈
            S
          
        
        
          π
          
            i
          
        
        =
        1
      
    
    {\displaystyle \sum _{i\in S}\pi _{i}=1}
  
.


==== Example 1 ====

The image to the right describes a continuous-time Markov chain with state-space {Bull market, Bear market, Stagnant market} and transition-rate matrix

  
    
      
        Q
        =
        
          
            (
            
              
                
                  −
                  0.025
                
                
                  0.02
                
                
                  0.005
                
              
              
                
                  0.3
                
                
                  −
                  0.5
                
                
                  0.2
                
              
              
                
                  0.02
                
                
                  0.4
                
                
                  −
                  0.42
                
              
            
            )
          
        
        .
      
    
    {\displaystyle Q={\begin{pmatrix}-0.025&0.02&0.005\\0.3&-0.5&0.2\\0.02&0.4&-0.42\end{pmatrix}}.}
  

The stationary distribution of this chain can be found by solving 
  
    
      
        π
        Q
        =
        0
      
    
    {\displaystyle \pi Q=0}
  
, subject to the constraint that elements must sum to 1 to obtain

  
    
      
        π
        =
        
          
            (
            
              
                
                  0.885
                
                
                  0.071
                
                
                  0.044
                
              
            
            )
          
        
        .
      
    
    {\displaystyle \pi ={\begin{pmatrix}0.885&0.071&0.044\end{pmatrix}}.}
  


==== Example 2 ====

The image to the right describes a discrete-time Markov chain modeling Pac-Man with state-space {1,2,3,4,5,6,7,8,9}. The player controls Pac-Man through a maze, eating pac-dots. Meanwhile, he is being hunted by ghosts. For convenience, the maze shall be a small 3x3-grid and the ghosts move randomly in horizontal and vertical directions. A secret passageway between states 2 and 8 can be used in both directions. Entries with probability zero are removed in the following transition-rate matrix:

  
    
      
        Q
        =
        
          
            (
            
              
                
                  −
                  1
                
                
                  
                    
                      1
                      2
                    
                  
                
                
                
                  
                    
                      1
                      2
                    
                  
                
              
              
                
                  
                    
                      1
                      4
                    
                  
                
                
                  −
                  1
                
                
                  
                    
                      1
                      4
                    
                  
                
                
                
                  
                    
                      1
                      4
                    
                  
                
                
                
                
                  
                    
                      1
                      4
                    
                  
                
              
              
                
                
                  
                    
                      1
                      2
                    
                  
                
                
                  −
                  1
                
                
                
                
                  
                    
                      1
                      2
                    
                  
                
              
              
                
                  
                    
                      1
                      3
                    
                  
                
                
                
                
                  −
                  1
                
                
                  
                    
                      1
                      3
                    
                  
                
                
                
                  
                    
                      1
                      3
                    
                  
                
              
              
                
                
                  
                    
                      1
                      4
                    
                  
                
                
                
                  
                    
                      1
                      4
                    
                  
                
                
                  −
                  1
                
                
                  
                    
                      1
                      4
                    
                  
                
                
                
                  
                    
                      1
                      4
                    
                  
                
              
              
                
                
                
                  
                    
                      1
                      3
                    
                  
                
                
                
                  
                    
                      1
                      3
                    
                  
                
                
                  −
                  1
                
                
                
                
                  
                    
                      1
                      3
                    
                  
                
              
              
                
                
                
                
                  
                    
                      1
                      2
                    
                  
                
                
                
                
                  −
                  1
                
                
                  
                    
                      1
                      2
                    
                  
                
              
              
                
                
                  
                    
                      1
                      4
                    
                  
                
                
                
                
                  
                    
                      1
                      4
                    
                  
                
                
                
                  
                    
                      1
                      4
                    
                  
                
                
                  −
                  1
                
                
                  
                    
                      1
                      4
                    
                  
                
              
              
                
                
                
                
                
                
                  
                    
                      1
                      2
                    
                  
                
                
                
                  
                    
                      1
                      2
                    
                  
                
                
                  −
                  1
                
              
            
            )
          
        
      
    
    {\displaystyle Q={\begin{pmatrix}-1&{\frac {1}{2}}&&{\frac {1}{2}}\\{\frac {1}{4}}&-1&{\frac {1}{4}}&&{\frac {1}{4}}&&&{\frac {1}{4}}\\&{\frac {1}{2}}&-1&&&{\frac {1}{2}}\\{\frac {1}{3}}&&&-1&{\frac {1}{3}}&&{\frac {1}{3}}\\&{\frac {1}{4}}&&{\frac {1}{4}}&-1&{\frac {1}{4}}&&{\frac {1}{4}}\\&&{\frac {1}{3}}&&{\frac {1}{3}}&-1&&&{\frac {1}{3}}\\&&&{\frac {1}{2}}&&&-1&{\frac {1}{2}}\\&{\frac {1}{4}}&&&{\frac {1}{4}}&&{\frac {1}{4}}&-1&{\frac {1}{4}}\\&&&&&{\frac {1}{2}}&&{\frac {1}{2}}&-1\end{pmatrix}}}
  

This Markov chain is irreducible, because the ghosts can fly from every state to every state in a finite amount of time. Due to the secret passageway, the Markov chain is also aperiodic, because the ghosts can move from any state to any state both in an even and in an uneven number of state transitions. Therefore, a unique stationary distribution exists and can be found by solving 
  
    
      
        π
        Q
        =
        0
      
    
    {\displaystyle \pi Q=0}
  
, subject to the constraint that elements must sum to 1. The solution of this linear equation subject to the constraint is 
  
    
      
        π
        =
        (
        7.7
        ,
        15.4
        ,
        7.7
        ,
        11.5
        ,
        15.4
        ,
        11.5
        ,
        7.7
        ,
        15.4
        ,
        7.7
        )
        %
        .
      
    
    {\displaystyle \pi =(7.7,15.4,7.7,11.5,15.4,11.5,7.7,15.4,7.7)\%.}
  

The central state and the border states 2 and 8 of the adjacent secret passageway are visited most and the corner states are visited least.


=== Time reversal ===
For a CTMC Xt, the time-reversed process is defined to be 
  
    
      
        
          
            
              
                X
                ^
              
            
          
          
            t
          
        
        =
        
          X
          
            T
            −
            t
          
        
      
    
    {\displaystyle {\hat {X}}_{t}=X_{T-t}}
  
. By Kelly's lemma this process has the same stationary distribution as the forward process.
A chain is said to be reversible if the reversed process is the same as the forward process. Kolmogorov's criterion states that the necessary and sufficient condition for a process to be reversible is that the product of transition rates around a closed loop must be the same in both directions.


=== Embedded Markov chain ===
One method of finding the stationary probability distribution, π, of an ergodic continuous-time Markov chain, Q, is by first finding its embedded Markov chain (EMC). Strictly speaking, the EMC is a regular discrete-time Markov chain. Each element of the one-step transition probability matrix of the EMC, S, is denoted by sij, and represents the conditional probability of transitioning from state i into state j. These conditional probabilities may be found by

  
    
      
        
          s
          
            i
            j
          
        
        =
        
          
            {
            
              
                
                  
                    
                      
                        q
                        
                          i
                          j
                        
                      
                      
                        
                          ∑
                          
                            k
                            ≠
                            i
                          
                        
                        
                          q
                          
                            i
                            k
                          
                        
                      
                    
                  
                
                
                  
                    if 
                  
                  i
                  ≠
                  j
                  ,
                
              
              
                
                  0
                
                
                  
                    otherwise
                  
                  .
                
              
            
            
          
        
      
    
    {\displaystyle s_{ij}={\begin{cases}{\frac {q_{ij}}{\sum _{k\neq i}q_{ik}}}&{\text{if }}i\neq j,\\0&{\text{otherwise}}.\end{cases}}}
  

From this, S may be written as

  
    
      
        S
        =
        I
        −
        
          
            (
            
              diag
              ⁡
              (
              Q
              )
            
            )
          
          
            −
            1
          
        
        Q
      
    
    {\displaystyle S=I-\left(\operatorname {diag} (Q)\right)^{-1}Q}
  

where I is the identity matrix and diag(Q) is the diagonal matrix formed by selecting the main diagonal from the matrix Q and setting all other elements to zero.
To find the stationary probability distribution vector, we must next find 
  
    
      
        φ
      
    
    {\displaystyle \varphi }
  
 such that

  
    
      
        φ
        S
        =
        φ
        ,
      
    
    {\displaystyle \varphi S=\varphi ,}
  

with 
  
    
      
        φ
      
    
    {\displaystyle \varphi }
  
 being a row vector, such that all elements in 
  
    
      
        φ
      
    
    {\displaystyle \varphi }
  
 are greater than 0 and 
  
    
      
        ‖
        φ
        
          ‖
          
            1
          
        
      
    
    {\displaystyle \|\varphi \|_{1}}
  
 = 1. From this, π may be found as

  
    
      
        π
        =
        
          
            
              −
              φ
              (
              diag
              ⁡
              (
              Q
              )
              
                )
                
                  −
                  1
                
              
            
            
              
                ‖
                
                  φ
                  (
                  diag
                  ⁡
                  (
                  Q
                  )
                  
                    )
                    
                      −
                      1
                    
                  
                
                ‖
              
              
                1
              
            
          
        
        .
      
    
    {\displaystyle \pi ={-\varphi (\operatorname {diag} (Q))^{-1} \over \left\|\varphi (\operatorname {diag} (Q))^{-1}\right\|_{1}}.}
  

(S may be periodic, even if Q is not. Once π is found, it must be normalized to a unit vector.)
Another discrete-time process that may be derived from a continuous-time Markov chain is a δ-skeleton—the (discrete-time) Markov chain formed by observing X(t) at intervals of δ units of time. The random variables X(0), X(δ), X(2δ), ... give the sequence of states visited by the δ-skeleton.


== See also ==
Kolmogorov equations (Markov jump process)


== Notes ==


== References ==