In statistics, machine learning and algorithms, a tensor sketch is a type of dimensionality reduction that is particularly efficient when applied to vectors that have tensor structure. Such a sketch can be used to speed up explicit kernel methods, bilinear pooling in neural networks and is a cornerstone in many numerical linear algebra algorithms.


== Mathematical definition ==
Mathematically, a dimensionality reduction or sketching matrix is a matrix 
  
    
      
        M
        ∈
        
          
            R
          
          
            k
            ×
            d
          
        
      
    
    {\displaystyle M\in \mathbb {R} ^{k\times d}}
  
, where 
  
    
      
        k
        <
        d
      
    
    {\displaystyle k<d}
  
, such that for any vector 
  
    
      
        x
        ∈
        
          
            R
          
          
            d
          
        
      
    
    {\displaystyle x\in \mathbb {R} ^{d}}
  

  
    
      
        
          |
        
        ‖
        M
        x
        
          ‖
          
            2
          
        
        −
        ‖
        x
        
          ‖
          
            2
          
        
        
          |
        
        <
        ε
        ‖
        x
        
          ‖
          
            2
          
        
      
    
    {\displaystyle |\|Mx\|_{2}-\|x\|_{2}|<\varepsilon \|x\|_{2}}
  

with high probability.
In other words, 
  
    
      
        M
      
    
    {\displaystyle M}
  
 preserves the norm of vectors up to a small error.
A tensor sketch has the extra property that if 
  
    
      
        x
        =
        y
        ⊗
        z
      
    
    {\displaystyle x=y\otimes z}
  
 for some vectors 
  
    
      
        y
        ∈
        
          
            R
          
          
            
              d
              
                1
              
            
          
        
        ,
        z
        ∈
        
          
            R
          
          
            
              d
              
                2
              
            
          
        
      
    
    {\displaystyle y\in \mathbb {R} ^{d_{1}},z\in \mathbb {R} ^{d_{2}}}
  
 such that 
  
    
      
        
          d
          
            1
          
        
        
          d
          
            2
          
        
        =
        d
      
    
    {\displaystyle d_{1}d_{2}=d}
  
, the transformation 
  
    
      
        M
        (
        y
        ⊗
        z
        )
      
    
    {\displaystyle M(y\otimes z)}
  
 can be computed more efficiently. Here 
  
    
      
        ⊗
      
    
    {\displaystyle \otimes }
  
 denotes the Kronecker product, rather than the outer product, though the two are related by a flattening.
The speedup is achieved by first rewriting 
  
    
      
        M
        (
        y
        ⊗
        z
        )
        =
        
          M
          ′
        
        y
        ∘
        
          M
          ″
        
        z
      
    
    {\displaystyle M(y\otimes z)=M'y\circ M''z}
  
, where 
  
    
      
        ∘
      
    
    {\displaystyle \circ }
  
 denotes the elementwise (Hadamard) product.
Each of 
  
    
      
        
          M
          ′
        
        y
      
    
    {\displaystyle M'y}
  
 and 
  
    
      
        
          M
          ″
        
        z
      
    
    {\displaystyle M''z}
  
 can be computed in time 
  
    
      
        O
        (
        k
        
          d
          
            1
          
        
        )
      
    
    {\displaystyle O(kd_{1})}
  
 and 
  
    
      
        O
        (
        k
        
          d
          
            2
          
        
        )
      
    
    {\displaystyle O(kd_{2})}
  
, respectively; including the Hadamard product gives overall time 
  
    
      
        O
        (
        
          d
          
            1
          
        
        
          d
          
            2
          
        
        +
        k
        
          d
          
            1
          
        
        +
        k
        
          d
          
            2
          
        
        )
      
    
    {\displaystyle O(d_{1}d_{2}+kd_{1}+kd_{2})}
  
. In most use cases this method is significantly faster than the full 
  
    
      
        M
        (
        y
        ⊗
        z
        )
      
    
    {\displaystyle M(y\otimes z)}
  
 requiring 
  
    
      
        O
        (
        k
        d
        )
        =
        O
        (
        k
        
          d
          
            1
          
        
        
          d
          
            2
          
        
        )
      
    
    {\displaystyle O(kd)=O(kd_{1}d_{2})}
  
 time.
For higher-order tensors, such as 
  
    
      
        x
        =
        y
        ⊗
        z
        ⊗
        t
      
    
    {\displaystyle x=y\otimes z\otimes t}
  
, the savings are even more impressive.


== History ==
The term tensor sketch was coined in 2013 describing a technique by Rasmus Pagh from the same year.
Originally it was understood using the fast Fourier transform to do fast convolution of count sketches.
Later research works generalized it to a much larger class of dimensionality reductions via Tensor random embeddings.
Tensor random embeddings were introduced in 2010 in a paper on differential privacy and were first analyzed by Rudelson et al. in 2012 in the context of sparse recovery.
Avron et al.
were the first to study the subspace embedding properties of tensor sketches, particularly focused on applications to polynomial kernels.
In this context, the sketch is required not only to preserve the norm of each individual vector with a certain probability but to preserve the norm of all vectors in each individual linear subspace.
This is a much stronger property, and it requires larger sketch sizes, but it allows the kernel methods to be used very broadly as explored in the book by David Woodruff.


== Tensor random projections ==
The face-splitting product is defined as the tensor products of the rows (was proposed by V. Slyusar in 1996 for radar and digital antenna array applications).
More directly, let 
  
    
      
        
          C
        
        ∈
        
          
            R
          
          
            3
            ×
            3
          
        
      
    
    {\displaystyle \mathbf {C} \in \mathbb {R} ^{3\times 3}}
  
 and 
  
    
      
        
          D
        
        ∈
        
          
            R
          
          
            3
            ×
            3
          
        
      
    
    {\displaystyle \mathbf {D} \in \mathbb {R} ^{3\times 3}}
  
 be two matrices.
Then the face-splitting product 
  
    
      
        
          C
        
        ∙
        
          D
        
      
    
    {\displaystyle \mathbf {C} \bullet \mathbf {D} }
  
 is

  
    
      
        
          C
        
        ∙
        
          D
        
        =
        
          [
          
            
              
                
                  
                    
                      C
                    
                    
                      1
                    
                  
                  ⊗
                  
                    
                      D
                    
                    
                      1
                    
                  
                
              
              
                
                  
                    
                      C
                    
                    
                      2
                    
                  
                  ⊗
                  
                    
                      D
                    
                    
                      2
                    
                  
                
              
              
                
                  
                    
                      C
                    
                    
                      3
                    
                  
                  ⊗
                  
                    
                      D
                    
                    
                      3
                    
                  
                
              
            
          
          ]
        
        =
        
          [
          
            
              
                
                  
                    
                      C
                    
                    
                      1
                      ,
                      1
                    
                  
                  
                    
                      D
                    
                    
                      1
                      ,
                      1
                    
                  
                
                
                  
                    
                      C
                    
                    
                      1
                      ,
                      1
                    
                  
                  
                    
                      D
                    
                    
                      1
                      ,
                      2
                    
                  
                
                
                  
                    
                      C
                    
                    
                      1
                      ,
                      1
                    
                  
                  
                    
                      D
                    
                    
                      1
                      ,
                      3
                    
                  
                
                
                  
                    
                      C
                    
                    
                      1
                      ,
                      2
                    
                  
                  
                    
                      D
                    
                    
                      1
                      ,
                      1
                    
                  
                
                
                  
                    
                      C
                    
                    
                      1
                      ,
                      2
                    
                  
                  
                    
                      D
                    
                    
                      1
                      ,
                      2
                    
                  
                
                
                  
                    
                      C
                    
                    
                      1
                      ,
                      2
                    
                  
                  
                    
                      D
                    
                    
                      1
                      ,
                      3
                    
                  
                
                
                  
                    
                      C
                    
                    
                      1
                      ,
                      3
                    
                  
                  
                    
                      D
                    
                    
                      1
                      ,
                      1
                    
                  
                
                
                  
                    
                      C
                    
                    
                      1
                      ,
                      3
                    
                  
                  
                    
                      D
                    
                    
                      1
                      ,
                      2
                    
                  
                
                
                  
                    
                      C
                    
                    
                      1
                      ,
                      3
                    
                  
                  
                    
                      D
                    
                    
                      1
                      ,
                      3
                    
                  
                
              
              
                
                  
                    
                      C
                    
                    
                      2
                      ,
                      1
                    
                  
                  
                    
                      D
                    
                    
                      2
                      ,
                      1
                    
                  
                
                
                  
                    
                      C
                    
                    
                      2
                      ,
                      1
                    
                  
                  
                    
                      D
                    
                    
                      2
                      ,
                      2
                    
                  
                
                
                  
                    
                      C
                    
                    
                      2
                      ,
                      1
                    
                  
                  
                    
                      D
                    
                    
                      2
                      ,
                      3
                    
                  
                
                
                  
                    
                      C
                    
                    
                      2
                      ,
                      2
                    
                  
                  
                    
                      D
                    
                    
                      2
                      ,
                      1
                    
                  
                
                
                  
                    
                      C
                    
                    
                      2
                      ,
                      2
                    
                  
                  
                    
                      D
                    
                    
                      2
                      ,
                      2
                    
                  
                
                
                  
                    
                      C
                    
                    
                      2
                      ,
                      2
                    
                  
                  
                    
                      D
                    
                    
                      2
                      ,
                      3
                    
                  
                
                
                  
                    
                      C
                    
                    
                      2
                      ,
                      3
                    
                  
                  
                    
                      D
                    
                    
                      2
                      ,
                      1
                    
                  
                
                
                  
                    
                      C
                    
                    
                      2
                      ,
                      3
                    
                  
                  
                    
                      D
                    
                    
                      2
                      ,
                      2
                    
                  
                
                
                  
                    
                      C
                    
                    
                      2
                      ,
                      3
                    
                  
                  
                    
                      D
                    
                    
                      2
                      ,
                      3
                    
                  
                
              
              
                
                  
                    
                      C
                    
                    
                      3
                      ,
                      1
                    
                  
                  
                    
                      D
                    
                    
                      3
                      ,
                      1
                    
                  
                
                
                  
                    
                      C
                    
                    
                      3
                      ,
                      1
                    
                  
                  
                    
                      D
                    
                    
                      3
                      ,
                      2
                    
                  
                
                
                  
                    
                      C
                    
                    
                      3
                      ,
                      1
                    
                  
                  
                    
                      D
                    
                    
                      3
                      ,
                      3
                    
                  
                
                
                  
                    
                      C
                    
                    
                      3
                      ,
                      2
                    
                  
                  
                    
                      D
                    
                    
                      3
                      ,
                      1
                    
                  
                
                
                  
                    
                      C
                    
                    
                      3
                      ,
                      2
                    
                  
                  
                    
                      D
                    
                    
                      3
                      ,
                      2
                    
                  
                
                
                  
                    
                      C
                    
                    
                      3
                      ,
                      2
                    
                  
                  
                    
                      D
                    
                    
                      3
                      ,
                      3
                    
                  
                
                
                  
                    
                      C
                    
                    
                      3
                      ,
                      3
                    
                  
                  
                    
                      D
                    
                    
                      3
                      ,
                      1
                    
                  
                
                
                  
                    
                      C
                    
                    
                      3
                      ,
                      3
                    
                  
                  
                    
                      D
                    
                    
                      3
                      ,
                      2
                    
                  
                
                
                  
                    
                      C
                    
                    
                      3
                      ,
                      3
                    
                  
                  
                    
                      D
                    
                    
                      3
                      ,
                      3
                    
                  
                
              
            
          
          ]
        
        .
      
    
    {\displaystyle \mathbf {C} \bullet \mathbf {D} =\left[{\begin{array}{c }\mathbf {C} _{1}\otimes \mathbf {D} _{1}\\\hline \mathbf {C} _{2}\otimes \mathbf {D} _{2}\\\hline \mathbf {C} _{3}\otimes \mathbf {D} _{3}\\\end{array}}\right]=\left[{\begin{array}{c  c  c  c  c  c  c  c  c }\mathbf {C} _{1,1}\mathbf {D} _{1,1}&\mathbf {C} _{1,1}\mathbf {D} _{1,2}&\mathbf {C} _{1,1}\mathbf {D} _{1,3}&\mathbf {C} _{1,2}\mathbf {D} _{1,1}&\mathbf {C} _{1,2}\mathbf {D} _{1,2}&\mathbf {C} _{1,2}\mathbf {D} _{1,3}&\mathbf {C} _{1,3}\mathbf {D} _{1,1}&\mathbf {C} _{1,3}\mathbf {D} _{1,2}&\mathbf {C} _{1,3}\mathbf {D} _{1,3}\\\hline \mathbf {C} _{2,1}\mathbf {D} _{2,1}&\mathbf {C} _{2,1}\mathbf {D} _{2,2}&\mathbf {C} _{2,1}\mathbf {D} _{2,3}&\mathbf {C} _{2,2}\mathbf {D} _{2,1}&\mathbf {C} _{2,2}\mathbf {D} _{2,2}&\mathbf {C} _{2,2}\mathbf {D} _{2,3}&\mathbf {C} _{2,3}\mathbf {D} _{2,1}&\mathbf {C} _{2,3}\mathbf {D} _{2,2}&\mathbf {C} _{2,3}\mathbf {D} _{2,3}\\\hline \mathbf {C} _{3,1}\mathbf {D} _{3,1}&\mathbf {C} _{3,1}\mathbf {D} _{3,2}&\mathbf {C} _{3,1}\mathbf {D} _{3,3}&\mathbf {C} _{3,2}\mathbf {D} _{3,1}&\mathbf {C} _{3,2}\mathbf {D} _{3,2}&\mathbf {C} _{3,2}\mathbf {D} _{3,3}&\mathbf {C} _{3,3}\mathbf {D} _{3,1}&\mathbf {C} _{3,3}\mathbf {D} _{3,2}&\mathbf {C} _{3,3}\mathbf {D} _{3,3}\end{array}}\right].}
  

The reason this product is useful is the following identity:

  
    
      
        (
        
          C
        
        ∙
        
          D
        
        )
        (
        x
        ⊗
        y
        )
        =
        
          C
        
        x
        ∘
        
          D
        
        y
        =
        
          [
          
            
              
                
                  (
                  
                    C
                  
                  x
                  
                    )
                    
                      1
                    
                  
                  (
                  
                    D
                  
                  y
                  
                    )
                    
                      1
                    
                  
                
              
              
                
                  (
                  
                    C
                  
                  x
                  
                    )
                    
                      2
                    
                  
                  (
                  
                    D
                  
                  y
                  
                    )
                    
                      2
                    
                  
                
              
              
                
                  ⋮
                
              
            
          
          ]
        
        ,
      
    
    {\displaystyle (\mathbf {C} \bullet \mathbf {D} )(x\otimes y)=\mathbf {C} x\circ \mathbf {D} y=\left[{\begin{array}{c }(\mathbf {C} x)_{1}(\mathbf {D} y)_{1}\\(\mathbf {C} x)_{2}(\mathbf {D} y)_{2}\\\vdots \end{array}}\right],}
  

where 
  
    
      
        ∘
      
    
    {\displaystyle \circ }
  
 is the element-wise (Hadamard) product.
Since this operation can be computed in linear time, 
  
    
      
        
          C
        
        ∙
        
          D
        
      
    
    {\displaystyle \mathbf {C} \bullet \mathbf {D} }
  
 can be multiplied on vectors with tensor structure much faster than normal matrices.


=== Construction with fast Fourier transform ===
The tensor sketch of Pham and Pagh computes

  
    
      
        
          C
          
            (
            1
            )
          
        
        x
        ∗
        
          C
          
            (
            2
            )
          
        
        y
      
    
    {\displaystyle C^{(1)}x\ast C^{(2)}y}
  
, where 
  
    
      
        
          C
          
            (
            1
            )
          
        
      
    
    {\displaystyle C^{(1)}}
  
 and 
  
    
      
        
          C
          
            (
            2
            )
          
        
      
    
    {\displaystyle C^{(2)}}
  
 are independent count sketch matrices and 
  
    
      
        ∗
      
    
    {\displaystyle \ast }
  
 is vector convolution.
They show that, amazingly, this equals 
  
    
      
        C
        (
        x
        ⊗
        y
        )
      
    
    {\displaystyle C(x\otimes y)}
  
 – a count sketch of the tensor product!
It turns out that this relation can be seen in terms of the face-splitting product as

  
    
      
        
          C
          
            (
            1
            )
          
        
        x
        ∗
        
          C
          
            (
            2
            )
          
        
        y
        =
        
          
            
              F
            
          
          
            −
            1
          
        
        (
        
          
            F
          
        
        
          C
          
            (
            1
            )
          
        
        x
        ∘
        
          
            F
          
        
        
          C
          
            (
            2
            )
          
        
        y
        )
      
    
    {\displaystyle C^{(1)}x\ast C^{(2)}y={\mathcal {F}}^{-1}({\mathcal {F}}C^{(1)}x\circ {\mathcal {F}}C^{(2)}y)}
  
, where 
  
    
      
        
          
            F
          
        
      
    
    {\displaystyle {\mathcal {F}}}
  
 is the Fourier transform matrix.
Since 
  
    
      
        
          
            F
          
        
      
    
    {\displaystyle {\mathcal {F}}}
  
 is an orthonormal matrix, 
  
    
      
        
          
            
              F
            
          
          
            −
            1
          
        
      
    
    {\displaystyle {\mathcal {F}}^{-1}}
  
 doesn't impact the norm of 
  
    
      
        C
        x
      
    
    {\displaystyle Cx}
  
 and may be ignored.
What's left is that 
  
    
      
        C
        ∼
        
          
            
              C
            
          
          
            (
            1
            )
          
        
        ∙
        
          
            
              C
            
          
          
            (
            2
            )
          
        
      
    
    {\displaystyle C\sim {\mathcal {C}}^{(1)}\bullet {\mathcal {C}}^{(2)}}
  
.
On the other hand,

  
    
      
        
          
            F
          
        
        (
        
          C
          
            (
            1
            )
          
        
        x
        ∗
        
          C
          
            (
            2
            )
          
        
        y
        )
        =
        
          
            F
          
        
        
          C
          
            (
            1
            )
          
        
        x
        ∘
        
          
            F
          
        
        
          C
          
            (
            2
            )
          
        
        y
        =
        (
        
          
            F
          
        
        
          C
          
            (
            1
            )
          
        
        ∙
        
          
            F
          
        
        
          C
          
            (
            2
            )
          
        
        )
        (
        x
        ⊗
        y
        )
      
    
    {\displaystyle {\mathcal {F}}(C^{(1)}x\ast C^{(2)}y)={\mathcal {F}}C^{(1)}x\circ {\mathcal {F}}C^{(2)}y=({\mathcal {F}}C^{(1)}\bullet {\mathcal {F}}C^{(2)})(x\otimes y)}
  
.


=== Application to general matrices ===
The problem with the original tensor sketch algorithm was that it used count sketch matrices, which aren't always very good dimensionality reductions.
In 2020 it was shown that any matrices with random enough independent rows suffice to create a tensor sketch.
This allows using matrices with stronger guarantees, such as real Gaussian Johnson Lindenstrauss matrices.
In particular, we get the following theorem

Consider a matrix 
  
    
      
        T
      
    
    {\displaystyle T}
  
 with i.i.d. rows 
  
    
      
        
          T
          
            1
          
        
        ,
        …
        ,
        
          T
          
            m
          
        
        ∈
        
          
            R
          
          
            d
          
        
      
    
    {\displaystyle T_{1},\dots ,T_{m}\in \mathbb {R} ^{d}}
  
, such that 
  
    
      
        E
        [
        (
        
          T
          
            1
          
        
        x
        
          )
          
            2
          
        
        ]
        =
        ‖
        x
        
          ‖
          
            2
          
          
            2
          
        
      
    
    {\displaystyle E[(T_{1}x)^{2}]=\|x\|_{2}^{2}}
  
 and 
  
    
      
        E
        [
        (
        
          T
          
            1
          
        
        x
        
          )
          
            p
          
        
        
          ]
          
            1
            
              /
            
            p
          
        
        ≤
        
          
            a
            p
          
        
        ‖
        x
        
          ‖
          
            2
          
        
      
    
    {\displaystyle E[(T_{1}x)^{p}]^{1/p}\leq {\sqrt {ap}}\|x\|_{2}}
  
. Let 
  
    
      
        
          T
          
            (
            1
            )
          
        
        ,
        …
        ,
        
          T
          
            (
            c
            )
          
        
      
    
    {\displaystyle T^{(1)},\dots ,T^{(c)}}
  
 be independent consisting of 
  
    
      
        T
      
    
    {\displaystyle T}
  
 and 
  
    
      
        M
        =
        
          T
          
            (
            1
            )
          
        
        ∙
        ⋯
        ∙
        
          T
          
            (
            c
            )
          
        
      
    
    {\displaystyle M=T^{(1)}\bullet \dots \bullet T^{(c)}}
  
.
Then 
  
    
      
        
          |
        
        ‖
        M
        x
        
          ‖
          
            2
          
        
        −
        ‖
        x
        
          ‖
          
            2
          
        
        
          |
        
        <
        ε
        ‖
        x
        
          ‖
          
            2
          
        
      
    
    {\displaystyle |\|Mx\|_{2}-\|x\|_{2}|<\varepsilon \|x\|_{2}}
  
 with probability 
  
    
      
        1
        −
        δ
      
    
    {\displaystyle 1-\delta }
  
 for any vector 
  
    
      
        x
      
    
    {\displaystyle x}
  
 if

  
    
      
        m
        =
        (
        4
        a
        
          )
          
            2
            c
          
        
        
          ε
          
            −
            2
          
        
        log
        ⁡
        1
        
          /
        
        δ
        +
        (
        2
        a
        e
        )
        
          ε
          
            −
            1
          
        
        (
        log
        ⁡
        1
        
          /
        
        δ
        
          )
          
            c
          
        
      
    
    {\displaystyle m=(4a)^{2c}\varepsilon ^{-2}\log 1/\delta +(2ae)\varepsilon ^{-1}(\log 1/\delta )^{c}}
  
.
In particular, if the entries of 
  
    
      
        T
      
    
    {\displaystyle T}
  
 are 
  
    
      
        ±
        1
      
    
    {\displaystyle \pm 1}
  
  we get 
  
    
      
        m
        =
        O
        (
        
          ε
          
            −
            2
          
        
        log
        ⁡
        1
        
          /
        
        δ
        +
        
          ε
          
            −
            1
          
        
        (
        
          
            
              1
              c
            
          
        
        log
        ⁡
        1
        
          /
        
        δ
        
          )
          
            c
          
        
        )
      
    
    {\displaystyle m=O(\varepsilon ^{-2}\log 1/\delta +\varepsilon ^{-1}({\tfrac {1}{c}}\log 1/\delta )^{c})}
  
 which matches the normal Johnson Lindenstrauss theorem of 
  
    
      
        m
        =
        O
        (
        
          ε
          
            −
            2
          
        
        log
        ⁡
        1
        
          /
        
        δ
        )
      
    
    {\displaystyle m=O(\varepsilon ^{-2}\log 1/\delta )}
  
 when 
  
    
      
        ε
      
    
    {\displaystyle \varepsilon }
  
 is small.
The paper also shows that the dependency on 
  
    
      
        
          ε
          
            −
            1
          
        
        (
        
          
            
              1
              c
            
          
        
        log
        ⁡
        1
        
          /
        
        δ
        
          )
          
            c
          
        
      
    
    {\displaystyle \varepsilon ^{-1}({\tfrac {1}{c}}\log 1/\delta )^{c}}
  
 is necessary for constructions using tensor randomized projections with Gaussian entries.


== Variations ==


=== Recursive construction ===
Because of the exponential dependency on 
  
    
      
        c
      
    
    {\displaystyle c}
  
 in tensor sketches based on  the face-splitting product, a different approach was developed in 2020 which applies

  
    
      
        M
        (
        x
        ⊗
        y
        ⊗
        ⋯
        )
        =
        
          M
          
            (
            1
            )
          
        
        (
        x
        ⊗
        (
        
          M
          
            (
            2
            )
          
        
        y
        ⊗
        ⋯
        )
        )
      
    
    {\displaystyle M(x\otimes y\otimes \cdots )=M^{(1)}(x\otimes (M^{(2)}y\otimes \cdots ))}
  

We can achieve such an 
  
    
      
        M
      
    
    {\displaystyle M}
  
 by letting

  
    
      
        M
        =
        
          M
          
            (
            c
            )
          
        
        (
        
          M
          
            (
            c
            −
            1
            )
          
        
        ⊗
        
          I
          
            d
          
        
        )
        (
        
          M
          
            (
            c
            −
            2
            )
          
        
        ⊗
        
          I
          
            
              d
              
                2
              
            
          
        
        )
        ⋯
        (
        
          M
          
            (
            1
            )
          
        
        ⊗
        
          I
          
            
              d
              
                c
                −
                1
              
            
          
        
        )
      
    
    {\displaystyle M=M^{(c)}(M^{(c-1)}\otimes I_{d})(M^{(c-2)}\otimes I_{d^{2}})\cdots (M^{(1)}\otimes I_{d^{c-1}})}
  
.
With this method, we only apply the general tensor sketch method to order 2 tensors, which avoids the exponential dependency in the number of rows.
It can be proved that combining 
  
    
      
        c
      
    
    {\displaystyle c}
  
 dimensionality reductions like this only increases 
  
    
      
        ε
      
    
    {\displaystyle \varepsilon }
  
 by a factor 
  
    
      
        
          
            c
          
        
      
    
    {\displaystyle {\sqrt {c}}}
  
.


=== Fast constructions ===
The fast Johnson–Lindenstrauss transform is a dimensionality reduction matrix
Given a matrix 
  
    
      
        M
        ∈
        
          
            R
          
          
            k
            ×
            d
          
        
      
    
    {\displaystyle M\in \mathbb {R} ^{k\times d}}
  
, computing the matrix vector product 
  
    
      
        M
        x
      
    
    {\displaystyle Mx}
  
 takes 
  
    
      
        k
        d
      
    
    {\displaystyle kd}
  
 time.
The Fast Johnson Lindenstrauss Transform (FJLT), was introduced by Ailon and Chazelle in 2006.
A version of this method takes

  
    
      
        M
        =
        SHD
      
    
    {\displaystyle M=\operatorname {SHD} }
  

where

  
    
      
        D
      
    
    {\displaystyle D}
  
 is a diagonal matrix where each diagonal entry 
  
    
      
        
          D
          
            i
            ,
            i
          
        
      
    
    {\displaystyle D_{i,i}}
  
 is 
  
    
      
        ±
        1
      
    
    {\displaystyle \pm 1}
  
 independently.
The matrix-vector multiplication 
  
    
      
        D
        x
      
    
    {\displaystyle Dx}
  
 can be computed in 
  
    
      
        O
        (
        d
        )
      
    
    {\displaystyle O(d)}
  
 time.

  
    
      
        H
      
    
    {\displaystyle H}
  
 is a Hadamard matrix, which allows matrix-vector multiplication in time 
  
    
      
        O
        (
        d
        log
        ⁡
        d
        )
      
    
    {\displaystyle O(d\log d)}
  

  
    
      
        S
      
    
    {\displaystyle S}
  
 is a 
  
    
      
        k
        ×
        d
      
    
    {\displaystyle k\times d}
  
 sampling matrix which is all zeros, except a single 1 in each row.
If the diagonal matrix is replaced by one which has a tensor product of 
  
    
      
        ±
        1
      
    
    {\displaystyle \pm 1}
  
 values on the diagonal, instead of being fully independent, it is possible to compute 
  
    
      
        SHD
        ⁡
        (
        x
        ⊗
        y
        )
      
    
    {\displaystyle \operatorname {SHD} (x\otimes y)}
  
 fast.
For an example of this, let 
  
    
      
        ρ
        ,
        σ
        ∈
        {
        −
        1
        ,
        1
        
          }
          
            2
          
        
      
    
    {\displaystyle \rho ,\sigma \in \{-1,1\}^{2}}
  
 be two independent 
  
    
      
        ±
        1
      
    
    {\displaystyle \pm 1}
  
 vectors and let 
  
    
      
        D
      
    
    {\displaystyle D}
  
 be a diagonal matrix with 
  
    
      
        ρ
        ⊗
        σ
      
    
    {\displaystyle \rho \otimes \sigma }
  
 on the diagonal.
We can then split up 
  
    
      
        SHD
        ⁡
        (
        x
        ⊗
        y
        )
      
    
    {\displaystyle \operatorname {SHD} (x\otimes y)}
  
 as follows:

  
    
      
        
          
            
              
              
                SHD
                ⁡
                (
                x
                ⊗
                y
                )
              
            
            
              
              
                
                
                =
                
                  
                    [
                    
                      
                        
                          1
                        
                        
                          0
                        
                        
                          0
                        
                        
                          0
                        
                      
                      
                        
                          0
                        
                        
                          0
                        
                        
                          1
                        
                        
                          0
                        
                      
                      
                        
                          0
                        
                        
                          1
                        
                        
                          0
                        
                        
                          0
                        
                      
                    
                    ]
                  
                
                
                  
                    [
                    
                      
                        
                          1
                        
                        
                          1
                        
                        
                          1
                        
                        
                          1
                        
                      
                      
                        
                          1
                        
                        
                          −
                          1
                        
                        
                          1
                        
                        
                          −
                          1
                        
                      
                      
                        
                          1
                        
                        
                          1
                        
                        
                          −
                          1
                        
                        
                          −
                          1
                        
                      
                      
                        
                          1
                        
                        
                          −
                          1
                        
                        
                          −
                          1
                        
                        
                          1
                        
                      
                    
                    ]
                  
                
                
                  
                    [
                    
                      
                        
                          
                            σ
                            
                              1
                            
                          
                          
                            ρ
                            
                              1
                            
                          
                        
                        
                          0
                        
                        
                          0
                        
                        
                          0
                        
                      
                      
                        
                          0
                        
                        
                          
                            σ
                            
                              1
                            
                          
                          
                            ρ
                            
                              2
                            
                          
                        
                        
                          0
                        
                        
                          0
                        
                      
                      
                        
                          0
                        
                        
                          0
                        
                        
                          
                            σ
                            
                              2
                            
                          
                          
                            ρ
                            
                              1
                            
                          
                        
                        
                          0
                        
                      
                      
                        
                          0
                        
                        
                          0
                        
                        
                          0
                        
                        
                          
                            σ
                            
                              2
                            
                          
                          
                            ρ
                            
                              2
                            
                          
                        
                      
                    
                    ]
                  
                
                
                  
                    [
                    
                      
                        
                          
                            x
                            
                              1
                            
                          
                          
                            y
                            
                              1
                            
                          
                        
                      
                      
                        
                          
                            x
                            
                              2
                            
                          
                          
                            y
                            
                              1
                            
                          
                        
                      
                      
                        
                          
                            x
                            
                              1
                            
                          
                          
                            y
                            
                              2
                            
                          
                        
                      
                      
                        
                          
                            x
                            
                              2
                            
                          
                          
                            y
                            
                              2
                            
                          
                        
                      
                    
                    ]
                  
                
              
            
            
              
              
                
                
                =
                
                  (
                  
                    
                      
                        [
                        
                          
                            
                              1
                            
                            
                              0
                            
                          
                          
                            
                              0
                            
                            
                              1
                            
                          
                          
                            
                              1
                            
                            
                              0
                            
                          
                        
                        ]
                      
                    
                    ∙
                    
                      
                        [
                        
                          
                            
                              1
                            
                            
                              0
                            
                          
                          
                            
                              1
                            
                            
                              0
                            
                          
                          
                            
                              0
                            
                            
                              1
                            
                          
                        
                        ]
                      
                    
                  
                  )
                
                
                  (
                  
                    
                      
                        [
                        
                          
                            
                              1
                            
                            
                              1
                            
                          
                          
                            
                              1
                            
                            
                              −
                              1
                            
                          
                        
                        ]
                      
                    
                    ⊗
                    
                      
                        [
                        
                          
                            
                              1
                            
                            
                              1
                            
                          
                          
                            
                              1
                            
                            
                              −
                              1
                            
                          
                        
                        ]
                      
                    
                  
                  )
                
                
                  (
                  
                    
                      
                        [
                        
                          
                            
                              
                                σ
                                
                                  1
                                
                              
                            
                            
                              0
                            
                          
                          
                            
                              0
                            
                            
                              
                                σ
                                
                                  2
                                
                              
                            
                          
                        
                        ]
                      
                    
                    ⊗
                    
                      
                        [
                        
                          
                            
                              
                                ρ
                                
                                  1
                                
                              
                            
                            
                              0
                            
                          
                          
                            
                              0
                            
                            
                              
                                ρ
                                
                                  2
                                
                              
                            
                          
                        
                        ]
                      
                    
                  
                  )
                
                
                  (
                  
                    
                      
                        [
                        
                          
                            
                              
                                x
                                
                                  1
                                
                              
                            
                          
                          
                            
                              
                                x
                                
                                  2
                                
                              
                            
                          
                        
                        ]
                      
                    
                    ⊗
                    
                      
                        [
                        
                          
                            
                              
                                y
                                
                                  1
                                
                              
                            
                          
                          
                            
                              
                                y
                                
                                  2
                                
                              
                            
                          
                        
                        ]
                      
                    
                  
                  )
                
              
            
            
              
              
                
                
                =
                
                  (
                  
                    
                      
                        [
                        
                          
                            
                              1
                            
                            
                              0
                            
                          
                          
                            
                              0
                            
                            
                              1
                            
                          
                          
                            
                              1
                            
                            
                              0
                            
                          
                        
                        ]
                      
                    
                    ∙
                    
                      
                        [
                        
                          
                            
                              1
                            
                            
                              0
                            
                          
                          
                            
                              1
                            
                            
                              0
                            
                          
                          
                            
                              0
                            
                            
                              1
                            
                          
                        
                        ]
                      
                    
                  
                  )
                
                
                  (
                  
                    
                      
                        [
                        
                          
                            
                              1
                            
                            
                              1
                            
                          
                          
                            
                              1
                            
                            
                              −
                              1
                            
                          
                        
                        ]
                      
                    
                    
                      
                        [
                        
                          
                            
                              
                                σ
                                
                                  1
                                
                              
                            
                            
                              0
                            
                          
                          
                            
                              0
                            
                            
                              
                                σ
                                
                                  2
                                
                              
                            
                          
                        
                        ]
                      
                    
                    
                      
                        [
                        
                          
                            
                              
                                x
                                
                                  1
                                
                              
                            
                          
                          
                            
                              
                                x
                                
                                  2
                                
                              
                            
                          
                        
                        ]
                      
                    
                    
                    ⊗
                    
                    
                      
                        [
                        
                          
                            
                              1
                            
                            
                              1
                            
                          
                          
                            
                              1
                            
                            
                              −
                              1
                            
                          
                        
                        ]
                      
                    
                    
                      
                        [
                        
                          
                            
                              
                                ρ
                                
                                  1
                                
                              
                            
                            
                              0
                            
                          
                          
                            
                              0
                            
                            
                              
                                ρ
                                
                                  2
                                
                              
                            
                          
                        
                        ]
                      
                    
                    
                      
                        [
                        
                          
                            
                              
                                y
                                
                                  1
                                
                              
                            
                          
                          
                            
                              
                                y
                                
                                  2
                                
                              
                            
                          
                        
                        ]
                      
                    
                  
                  )
                
              
            
            
              
              
                
                
                =
                
                  
                    [
                    
                      
                        
                          1
                        
                        
                          0
                        
                      
                      
                        
                          0
                        
                        
                          1
                        
                      
                      
                        
                          1
                        
                        
                          0
                        
                      
                    
                    ]
                  
                
                
                  
                    [
                    
                      
                        
                          1
                        
                        
                          1
                        
                      
                      
                        
                          1
                        
                        
                          −
                          1
                        
                      
                    
                    ]
                  
                
                
                  
                    [
                    
                      
                        
                          
                            σ
                            
                              1
                            
                          
                        
                        
                          0
                        
                      
                      
                        
                          0
                        
                        
                          
                            σ
                            
                              2
                            
                          
                        
                      
                    
                    ]
                  
                
                
                  
                    [
                    
                      
                        
                          
                            x
                            
                              1
                            
                          
                        
                      
                      
                        
                          
                            x
                            
                              2
                            
                          
                        
                      
                    
                    ]
                  
                
                
                ∘
                
                
                  
                    [
                    
                      
                        
                          1
                        
                        
                          0
                        
                      
                      
                        
                          1
                        
                        
                          0
                        
                      
                      
                        
                          0
                        
                        
                          1
                        
                      
                    
                    ]
                  
                
                
                  
                    [
                    
                      
                        
                          1
                        
                        
                          1
                        
                      
                      
                        
                          1
                        
                        
                          −
                          1
                        
                      
                    
                    ]
                  
                
                
                  
                    [
                    
                      
                        
                          
                            ρ
                            
                              1
                            
                          
                        
                        
                          0
                        
                      
                      
                        
                          0
                        
                        
                          
                            ρ
                            
                              2
                            
                          
                        
                      
                    
                    ]
                  
                
                
                  
                    [
                    
                      
                        
                          
                            y
                            
                              1
                            
                          
                        
                      
                      
                        
                          
                            y
                            
                              2
                            
                          
                        
                      
                    
                    ]
                  
                
                .
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}&\operatorname {SHD} (x\otimes y)\\&\quad ={\begin{bmatrix}1&0&0&0\\0&0&1&0\\0&1&0&0\end{bmatrix}}{\begin{bmatrix}1&1&1&1\\1&-1&1&-1\\1&1&-1&-1\\1&-1&-1&1\end{bmatrix}}{\begin{bmatrix}\sigma _{1}\rho _{1}&0&0&0\\0&\sigma _{1}\rho _{2}&0&0\\0&0&\sigma _{2}\rho _{1}&0\\0&0&0&\sigma _{2}\rho _{2}\\\end{bmatrix}}{\begin{bmatrix}x_{1}y_{1}\\x_{2}y_{1}\\x_{1}y_{2}\\x_{2}y_{2}\end{bmatrix}}\\[5pt]&\quad =\left({\begin{bmatrix}1&0\\0&1\\1&0\end{bmatrix}}\bullet {\begin{bmatrix}1&0\\1&0\\0&1\end{bmatrix}}\right)\left({\begin{bmatrix}1&1\\1&-1\end{bmatrix}}\otimes {\begin{bmatrix}1&1\\1&-1\end{bmatrix}}\right)\left({\begin{bmatrix}\sigma _{1}&0\\0&\sigma _{2}\\\end{bmatrix}}\otimes {\begin{bmatrix}\rho _{1}&0\\0&\rho _{2}\\\end{bmatrix}}\right)\left({\begin{bmatrix}x_{1}\\x_{2}\end{bmatrix}}\otimes {\begin{bmatrix}y_{1}\\y_{2}\end{bmatrix}}\right)\\[5pt]&\quad =\left({\begin{bmatrix}1&0\\0&1\\1&0\end{bmatrix}}\bullet {\begin{bmatrix}1&0\\1&0\\0&1\end{bmatrix}}\right)\left({\begin{bmatrix}1&1\\1&-1\end{bmatrix}}{\begin{bmatrix}\sigma _{1}&0\\0&\sigma _{2}\\\end{bmatrix}}{\begin{bmatrix}x_{1}\\x_{2}\end{bmatrix}}\,\otimes \,{\begin{bmatrix}1&1\\1&-1\end{bmatrix}}{\begin{bmatrix}\rho _{1}&0\\0&\rho _{2}\\\end{bmatrix}}{\begin{bmatrix}y_{1}\\y_{2}\end{bmatrix}}\right)\\[5pt]&\quad ={\begin{bmatrix}1&0\\0&1\\1&0\end{bmatrix}}{\begin{bmatrix}1&1\\1&-1\end{bmatrix}}{\begin{bmatrix}\sigma _{1}&0\\0&\sigma _{2}\\\end{bmatrix}}{\begin{bmatrix}x_{1}\\x_{2}\end{bmatrix}}\,\circ \,{\begin{bmatrix}1&0\\1&0\\0&1\end{bmatrix}}{\begin{bmatrix}1&1\\1&-1\end{bmatrix}}{\begin{bmatrix}\rho _{1}&0\\0&\rho _{2}\\\end{bmatrix}}{\begin{bmatrix}y_{1}\\y_{2}\end{bmatrix}}.\end{aligned}}}
  

In other words, 
  
    
      
        SHD
        =
        
          S
          
            (
            1
            )
          
        
        H
        
          D
          
            (
            1
            )
          
        
        ∙
        
          S
          
            (
            2
            )
          
        
        H
        
          D
          
            (
            2
            )
          
        
      
    
    {\displaystyle \operatorname {SHD} =S^{(1)}HD^{(1)}\bullet S^{(2)}HD^{(2)}}
  
, splits up into two Fast Johnson–Lindenstrauss transformations, and the total reduction takes time 
  
    
      
        O
        (
        
          d
          
            1
          
        
        log
        ⁡
        
          d
          
            1
          
        
        +
        
          d
          
            2
          
        
        log
        ⁡
        
          d
          
            2
          
        
        )
      
    
    {\displaystyle O(d_{1}\log d_{1}+d_{2}\log d_{2})}
  
 rather than 
  
    
      
        
          d
          
            1
          
        
        
          d
          
            2
          
        
        log
        ⁡
        (
        
          d
          
            1
          
        
        
          d
          
            2
          
        
        )
      
    
    {\displaystyle d_{1}d_{2}\log(d_{1}d_{2})}
  
 as with the direct approach.
The same approach can be extended to compute higher degree products, such as 
  
    
      
        SHD
        ⁡
        (
        x
        ⊗
        y
        ⊗
        z
        )
      
    
    {\displaystyle \operatorname {SHD} (x\otimes y\otimes z)}
  

Ahle et al. shows that if 
  
    
      
        SHD
      
    
    {\displaystyle \operatorname {SHD} }
  
 has 
  
    
      
        
          ε
          
            −
            2
          
        
        (
        log
        ⁡
        1
        
          /
        
        δ
        
          )
          
            c
            +
            1
          
        
      
    
    {\displaystyle \varepsilon ^{-2}(\log 1/\delta )^{c+1}}
  
 rows, then 
  
    
      
        
          |
        
        ‖
        SHD
        ⁡
        x
        
          ‖
          
            2
          
        
        −
        ‖
        x
        ‖
        
          |
        
        ≤
        ε
        ‖
        x
        
          ‖
          
            2
          
        
      
    
    {\displaystyle |\|\operatorname {SHD} x\|_{2}-\|x\||\leq \varepsilon \|x\|_{2}}
  
 for any vector 
  
    
      
        x
        ∈
        
          
            R
          
          
            
              d
              
                c
              
            
          
        
      
    
    {\displaystyle x\in \mathbb {R} ^{d^{c}}}
  
 with probability 
  
    
      
        1
        −
        δ
      
    
    {\displaystyle 1-\delta }
  
, while allowing fast multiplication with degree 
  
    
      
        c
      
    
    {\displaystyle c}
  
 tensors.
Jin et al., the same year, showed a similar result for the more general class of matrices call RIP, which includes the subsampled Hadamard matrices.
They showed that these matrices allow splitting into tensors provided the number of rows is 
  
    
      
        
          ε
          
            −
            2
          
        
        (
        log
        ⁡
        1
        
          /
        
        δ
        
          )
          
            2
            c
            −
            1
          
        
        log
        ⁡
        d
      
    
    {\displaystyle \varepsilon ^{-2}(\log 1/\delta )^{2c-1}\log d}
  
.
In the case 
  
    
      
        c
        =
        2
      
    
    {\displaystyle c=2}
  
 this matches the previous result.
These fast constructions can again be combined with the recursion approach mentioned above, giving the fastest overall tensor sketch.


== Data aware sketching ==
It is also possible to do so-called "data aware" tensor sketching.
Instead of multiplying a random matrix on the data, the data points are sampled independently with a certain probability depending on the norm of the point.


== Applications ==


=== Explicit polynomial kernels ===
Kernel methods are popular in machine learning as they give the algorithm designed the freedom to design a "feature space" in which to measure the similarity of their data points.
A simple kernel-based binary classifier is based on the following computation:

  
    
      
        
          
            
              y
              ^
            
          
        
        (
        
          
            x
            ′
          
        
        )
        =
        sgn
        ⁡
        
          ∑
          
            i
            =
            1
          
          
            n
          
        
        
          y
          
            i
          
        
        k
        (
        
          
            x
          
          
            i
          
        
        ,
        
          
            x
            ′
          
        
        )
        ,
      
    
    {\displaystyle {\hat {y}}(\mathbf {x'} )=\operatorname {sgn} \sum _{i=1}^{n}y_{i}k(\mathbf {x} _{i},\mathbf {x'} ),}
  

where 
  
    
      
        
          
            x
          
          
            i
          
        
        ∈
        
          
            R
          
          
            d
          
        
      
    
    {\displaystyle \mathbf {x} _{i}\in \mathbb {R} ^{d}}
  
 are the data points, 
  
    
      
        
          y
          
            i
          
        
      
    
    {\displaystyle y_{i}}
  
 is the label of the 
  
    
      
        i
      
    
    {\displaystyle i}
  
th point (either −1 or +1), and 
  
    
      
        
          
            
              y
              ^
            
          
        
        (
        
          
            x
            ′
          
        
        )
      
    
    {\displaystyle {\hat {y}}(\mathbf {x'} )}
  
 is the prediction of the class of 
  
    
      
        
          
            x
            ′
          
        
      
    
    {\displaystyle \mathbf {x'} }
  
.
The function 
  
    
      
        k
        :
        
          
            R
          
          
            d
          
        
        ×
        
          
            R
          
          
            d
          
        
        →
        
          R
        
      
    
    {\displaystyle k:\mathbb {R} ^{d}\times \mathbb {R} ^{d}\to \mathbb {R} }
  
 is the kernel.
Typical examples are the radial basis function kernel, 
  
    
      
        k
        (
        x
        ,
        
          x
          ′
        
        )
        =
        exp
        ⁡
        (
        −
        ‖
        x
        −
        
          x
          ′
        
        
          ‖
          
            2
          
          
            2
          
        
        )
      
    
    {\displaystyle k(x,x')=\exp(-\|x-x'\|_{2}^{2})}
  
, and polynomial kernels such as 
  
    
      
        k
        (
        x
        ,
        
          x
          ′
        
        )
        =
        (
        1
        +
        ⟨
        x
        ,
        
          x
          ′
        
        ⟩
        
          )
          
            2
          
        
      
    
    {\displaystyle k(x,x')=(1+\langle x,x'\rangle )^{2}}
  
.
When used this way, the kernel method is called "implicit".
Sometimes it is faster to do an "explicit" kernel method, in which a pair of functions 
  
    
      
        f
        ,
        g
        :
        
          
            R
          
          
            d
          
        
        →
        
          
            R
          
          
            D
          
        
      
    
    {\displaystyle f,g:\mathbb {R} ^{d}\to \mathbb {R} ^{D}}
  
 are found, such that 
  
    
      
        k
        (
        x
        ,
        
          x
          ′
        
        )
        =
        ⟨
        f
        (
        x
        )
        ,
        g
        (
        
          x
          ′
        
        )
        ⟩
      
    
    {\displaystyle k(x,x')=\langle f(x),g(x')\rangle }
  
.
This allows the above computation to be expressed as

  
    
      
        
          
            
              y
              ^
            
          
        
        (
        
          
            x
            ′
          
        
        )
        =
        sgn
        ⁡
        
          ∑
          
            i
            =
            1
          
          
            n
          
        
        
          y
          
            i
          
        
        ⟨
        f
        (
        
          
            x
          
          
            i
          
        
        )
        ,
        g
        (
        
          
            x
            ′
          
        
        )
        ⟩
        =
        sgn
        ⁡
        
          ⟨
          
            
              (
              
                
                  ∑
                  
                    i
                    =
                    1
                  
                  
                    n
                  
                
                
                  y
                  
                    i
                  
                
                f
                (
                
                  
                    x
                  
                  
                    i
                  
                
                )
              
              )
            
            ,
            g
            (
            
              
                x
                ′
              
            
            )
          
          ⟩
        
        ,
      
    
    {\displaystyle {\hat {y}}(\mathbf {x'} )=\operatorname {sgn} \sum _{i=1}^{n}y_{i}\langle f(\mathbf {x} _{i}),g(\mathbf {x'} )\rangle =\operatorname {sgn} \left\langle \left(\sum _{i=1}^{n}y_{i}f(\mathbf {x} _{i})\right),g(\mathbf {x'} )\right\rangle ,}
  

where the value 
  
    
      
        
          ∑
          
            i
            =
            1
          
          
            n
          
        
        
          y
          
            i
          
        
        f
        (
        
          
            x
          
          
            i
          
        
        )
      
    
    {\displaystyle \sum _{i=1}^{n}y_{i}f(\mathbf {x} _{i})}
  
 can be computed in advance.
The problem with this method is that the feature space can be very large. That is 
  
    
      
        D
        >>
        d
      
    
    {\displaystyle D>>d}
  
.
For example, for the polynomial kernel 
  
    
      
        k
        (
        x
        ,
        
          x
          ′
        
        )
        =
        ⟨
        x
        ,
        
          x
          ′
        
        
          ⟩
          
            3
          
        
      
    
    {\displaystyle k(x,x')=\langle x,x'\rangle ^{3}}
  
 we get 
  
    
      
        f
        (
        x
        )
        =
        x
        ⊗
        x
        ⊗
        x
      
    
    {\displaystyle f(x)=x\otimes x\otimes x}
  
 and 
  
    
      
        g
        (
        
          x
          ′
        
        )
        =
        
          x
          ′
        
        ⊗
        
          x
          ′
        
        ⊗
        
          x
          ′
        
      
    
    {\displaystyle g(x')=x'\otimes x'\otimes x'}
  
, where 
  
    
      
        ⊗
      
    
    {\displaystyle \otimes }
  
 is the tensor product and 
  
    
      
        f
        (
        x
        )
        ,
        g
        (
        
          x
          ′
        
        )
        ∈
        
          
            R
          
          
            D
          
        
      
    
    {\displaystyle f(x),g(x')\in \mathbb {R} ^{D}}
  
 where 
  
    
      
        D
        =
        
          d
          
            3
          
        
      
    
    {\displaystyle D=d^{3}}
  
.
If 
  
    
      
        d
      
    
    {\displaystyle d}
  
 is already large, 
  
    
      
        D
      
    
    {\displaystyle D}
  
 can be much larger than the number of data points (
  
    
      
        n
      
    
    {\displaystyle n}
  
) and so the explicit method is inefficient.
The idea of tensor sketch is that we can compute approximate functions 
  
    
      
        
          f
          ′
        
        ,
        
          g
          ′
        
        :
        
          
            R
          
          
            d
          
        
        →
        
          
            R
          
          
            t
          
        
      
    
    {\displaystyle f',g':\mathbb {R} ^{d}\to \mathbb {R} ^{t}}
  
 where 
  
    
      
        t
      
    
    {\displaystyle t}
  
 can even be smaller than 
  
    
      
        d
      
    
    {\displaystyle d}
  
, and which still have the property that 
  
    
      
        ⟨
        
          f
          ′
        
        (
        x
        )
        ,
        
          g
          ′
        
        (
        
          x
          ′
        
        )
        ⟩
        ≈
        k
        (
        x
        ,
        
          x
          ′
        
        )
      
    
    {\displaystyle \langle f'(x),g'(x')\rangle \approx k(x,x')}
  
.
This method was shown in 2020 to work even for high degree polynomials and radial basis function kernels.


=== Compressed matrix multiplication ===
Assume we have two large datasets, represented as matrices 
  
    
      
        X
        ,
        Y
        ∈
        
          
            R
          
          
            n
            ×
            d
          
        
      
    
    {\displaystyle X,Y\in \mathbb {R} ^{n\times d}}
  
, and we want to find the rows 
  
    
      
        i
        ,
        j
      
    
    {\displaystyle i,j}
  
 with the largest inner products 
  
    
      
        ⟨
        
          X
          
            i
          
        
        ,
        
          Y
          
            j
          
        
        ⟩
      
    
    {\displaystyle \langle X_{i},Y_{j}\rangle }
  
.
We could compute 
  
    
      
        Z
        =
        X
        
          Y
          
            T
          
        
        ∈
        
          
            R
          
          
            n
            ×
            n
          
        
      
    
    {\displaystyle Z=XY^{T}\in \mathbb {R} ^{n\times n}}
  
 and simply look at all 
  
    
      
        
          n
          
            2
          
        
      
    
    {\displaystyle n^{2}}
  
 possibilities.
However, this would take at least 
  
    
      
        
          n
          
            2
          
        
      
    
    {\displaystyle n^{2}}
  
 time, and probably closer to 
  
    
      
        
          n
          
            2
          
        
        d
      
    
    {\displaystyle n^{2}d}
  
 using standard matrix multiplication techniques.
The idea of Compressed Matrix Multiplication is the general identity

  
    
      
        X
        
          Y
          
            T
          
        
        =
        
          ∑
          
            i
            =
            1
          
          
            d
          
        
        
          X
          
            i
          
        
        ⊗
        
          Y
          
            i
          
        
      
    
    {\displaystyle XY^{T}=\sum _{i=1}^{d}X_{i}\otimes Y_{i}}
  

where 
  
    
      
        ⊗
      
    
    {\displaystyle \otimes }
  
 is the tensor product.
Since we can compute a (linear) approximation to 
  
    
      
        
          X
          
            i
          
        
        ⊗
        
          Y
          
            i
          
        
      
    
    {\displaystyle X_{i}\otimes Y_{i}}
  
 efficiently, we can sum those up to get an approximation for the complete product.


=== Compact multilinear pooling ===

Bilinear pooling is the technique of taking two input vectors, 
  
    
      
        x
        ,
        y
      
    
    {\displaystyle x,y}
  
 from different sources, and using the tensor product 
  
    
      
        x
        ⊗
        y
      
    
    {\displaystyle x\otimes y}
  
 as the input layer to a neural network.
In the authors considered using tensor sketch to reduce the number of variables needed.
In 2017 another paper takes the FFT of the input features, before they are combined using the element-wise product.
This again corresponds to the original tensor sketch.


== References ==


== Further reading ==
Ahle, Thomas; Knudsen, Jakob (2019-09-03). "Almost Optimal Tensor Sketch". ResearchGate. Retrieved 2020-07-11.
Slyusar, V. I. (1998). "End products in matrices in radar applications" (PDF). Radioelectronics and Communications Systems. 41 (3): 50–53.
Slyusar, V. I. (1997-05-20). "Analytical model of the digital antenna array on a basis of face-splitting matrix products" (PDF). Proc. ICATT-97, Kyiv: 108–109.
Slyusar, V. I. (1997-09-15). "New operations of matrices product for applications of radars" (PDF). Proc. Direct and Inverse Problems of Electromagnetic and Acoustic Wave Theory (DIPED-97), Lviv.: 73–74.
Slyusar, V. I. (March 13, 1998). "A Family of Face Products of Matrices and its Properties" (PDF). Cybernetics and Systems Analysis C/C of Kibernetika I Sistemnyi Analiz.- 1999. 35 (3): 379–384. doi:10.1007/BF02733426. S2CID 119661450.