The switching Kalman filtering (SKF) method is a variant of the Kalman filter. In its generalised form, it is often attributed to Kevin P. Murphy, but related switching state-space models have been in use.


== Applications ==
Applications of the switching Kalman filter include: Brain–computer interfaces and neural decoding, real-time decoding for continuous neural-prosthetic control, and sensorimotor learning in humans.
It also has application in econometrics, signal processing, tracking, computer vision, etc. It is an alternative to the Kalman filter when the system's state has a discrete component. The additional error when using a Kalman filter instead of a Switching Kalman filter may be quantified in terms of the switching system's parameters. For example, when an industrial plant has "multiple discrete modes of behaviour, each of which having a linear (Gaussian) dynamics".


== Model ==
There are several variants of SKF discussed in.


=== Special case ===
In the simpler case, switching state-space models are defined based on a switching variable which evolves independent of the hidden variable. The probabilistic model of such variant of SKF is as the following:
[This section is badly written: It does not explain the notation used below.]

  
    
      
        
          
            
              
              
                
                Pr
                (
                {
                
                  S
                  
                    t
                  
                
                ,
                
                  X
                  
                    t
                  
                  
                    (
                    1
                    )
                  
                
                ,
                …
                ,
                
                  X
                  
                    t
                  
                  
                    (
                    M
                    )
                  
                
                ,
                
                  Y
                  
                    t
                  
                
                }
                )
              
            
            
              
                =
                

                
              
              
                
                Pr
                (
                
                  S
                  
                    1
                  
                
                )
                
                  ∏
                  
                    t
                    =
                    2
                  
                  
                    T
                  
                
                Pr
                (
                
                  S
                  
                    t
                  
                
                ∣
                
                  S
                  
                    t
                    −
                    1
                  
                
                )
                ×
                
                  ∏
                  
                    m
                    =
                    1
                  
                  
                    M
                  
                
                Pr
                (
                
                  X
                  
                    1
                  
                  
                    (
                    m
                    )
                  
                
                )
                
                  ∏
                  
                    t
                    =
                    2
                  
                  
                    T
                  
                
                Pr
                (
                
                  X
                  
                    t
                  
                  
                    (
                    m
                    )
                  
                
                ∣
                
                  X
                  
                    t
                    −
                    1
                  
                  
                    (
                    m
                    )
                  
                
                )
                ×
                
                  ∏
                  
                    t
                    =
                    1
                  
                  
                    T
                  
                
                Pr
                (
                
                  Y
                  
                    t
                  
                
                ∣
                
                  X
                  
                    t
                  
                  
                    (
                    1
                    )
                  
                
                ,
                …
                ,
                
                  X
                  
                    t
                  
                  
                    (
                    M
                    )
                  
                
                ,
                
                  S
                  
                    t
                  
                
                )
                .
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}&\Pr(\{S_{t},X_{t}^{(1)},\ldots ,X_{t}^{(M)},Y_{t}\})\\={}&\Pr(S_{1})\prod _{t=2}^{T}\Pr(S_{t}\mid S_{t-1})\times \prod _{m=1}^{M}\Pr(X_{1}^{(m)})\prod _{t=2}^{T}\Pr(X_{t}^{(m)}\mid X_{t-1}^{(m)})\times \prod _{t=1}^{T}\Pr(Y_{t}\mid X_{t}^{(1)},\ldots ,X_{t}^{(M)},S_{t}).\end{aligned}}}
  

The hidden variables include not only the continuous 
  
    
      
        X
      
    
    {\displaystyle X}
  
, but also a discrete *switch* (or switching) variable 
  
    
      
        
          S
          
            t
          
        
      
    
    {\displaystyle S_{t}}
  
.  The dynamics of the switch variable are defined by the term 
  
    
      
        Pr
        (
        
          S
          
            t
          
        
        ∣
        
          S
          
            t
            −
            1
          
        
        )
      
    
    {\displaystyle \Pr(S_{t}\mid S_{t-1})}
  
. The probability model of 
  
    
      
        X
      
    
    {\displaystyle X}
  
 and 
  
    
      
        Y
      
    
    {\displaystyle Y}
  
 can depend on 
  
    
      
        
          S
          
            t
          
        
      
    
    {\displaystyle S_{t}}
  
.
The switch variable can take its values from a set 
  
    
      
        
          S
          
            t
          
        
        ∈
        {
        1
        ,
        2
        ,
        …
        ,
        M
        }
      
    
    {\displaystyle S_{t}\in \{1,2,\ldots ,M\}}
  
. This changes the joint distribution 
  
    
      
        (
        
          X
          
            t
          
        
        ,
        
          Y
          
            t
          
        
        )
      
    
    {\displaystyle (X_{t},Y_{t})}
  
 which is a separate multivariate Gaussian distribution in case of each value of 
  
    
      
        
          S
          
            t
          
        
      
    
    {\displaystyle S_{t}}
  
.


=== General case ===
In more generalised variants, the switch variable affects the dynamics of 
  
    
      
        
          X
          
            t
          
        
      
    
    {\displaystyle X_{t}}
  
, e.g. through 
  
    
      
        Pr
        (
        
          X
          
            t
          
        
        ∣
        
          X
          
            t
            −
            1
          
        
        ,
        
          S
          
            t
          
        
        )
      
    
    {\displaystyle \Pr(X_{t}\mid X_{t-1},S_{t})}
  
.
The filtering and smoothing procedure for general cases is discussed in.


== References ==