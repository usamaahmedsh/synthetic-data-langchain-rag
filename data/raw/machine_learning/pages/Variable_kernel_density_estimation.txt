In statistics, adaptive or "variable-bandwidth" kernel density estimation is a form of kernel density estimation in which the size of the kernels used in the estimate are varied
depending upon either the location of the samples or the location of the test point.
It is a particularly effective technique when the sample space is multi-dimensional.


== Rationale ==
Given a set of samples, 
  
    
      
        {
        
          
            
              
                x
                →
              
            
          
          
            i
          
        
        }
      
    
    {\displaystyle \lbrace {\vec {x}}_{i}\rbrace }
  
, we wish to estimate the
density, 
  
    
      
        P
        (
        
          
            
              x
              →
            
          
        
        )
      
    
    {\displaystyle P({\vec {x}})}
  
, at a test point, 
  
    
      
        
          
            
              x
              →
            
          
        
      
    
    {\displaystyle {\vec {x}}}
  
:

  
    
      
        P
        (
        
          
            
              x
              →
            
          
        
        )
        ≈
        
          
            W
            
              n
              
                h
                
                  D
                
              
            
          
        
      
    
    {\displaystyle P({\vec {x}})\approx {\frac {W}{nh^{D}}}}
  

  
    
      
        W
        =
        
          ∑
          
            i
            =
            1
          
          
            n
          
        
        
          w
          
            i
          
        
      
    
    {\displaystyle W=\sum _{i=1}^{n}w_{i}}
  

  
    
      
        
          w
          
            i
          
        
        =
        K
        
          (
          
            
              
                
                  
                    
                      x
                      →
                    
                  
                
                −
                
                  
                    
                      
                        x
                        →
                      
                    
                  
                  
                    i
                  
                
              
              h
            
          
          )
        
      
    
    {\displaystyle w_{i}=K\left({\frac {{\vec {x}}-{\vec {x}}_{i}}{h}}\right)}
  

where n is the number of samples, K is the 
"kernel", h is its width and D is the number of dimensions in 
  
    
      
        
          
            
              x
              →
            
          
        
      
    
    {\displaystyle {\vec {x}}}
  
.
The kernel can be thought of as a simple, linear filter.
Using a fixed filter width may mean that in regions of low density, all samples
will fall in the tails of the filter with very low weighting, while regions of high
density will find an excessive number of samples in the central region with weighting
close to unity.  To fix this problem, we vary the width of the kernel in different
regions of the sample space.  
There are two methods of doing this: balloon and pointwise estimation.
In a balloon estimator, the kernel width is varied depending on the location 
of the test point.  In a pointwise estimator, the kernel width is varied depending
on the location of the sample.
For multivariate estimators, the parameter, h, can be generalized to
vary not just the size, but also the shape of the kernel.  This more complicated approach
will not be covered here.


== Balloon estimators ==
A common method of varying the kernel width is to make it inversely proportional to the density at the test point:

  
    
      
        h
        =
        
          
            k
            
              
                [
                
                  n
                  P
                  (
                  
                    
                      
                        x
                        →
                      
                    
                  
                  )
                
                ]
              
              
                1
                
                  /
                
                D
              
            
          
        
      
    
    {\displaystyle h={\frac {k}{\left[nP({\vec {x}})\right]^{1/D}}}}
  

where k is a constant.  
If we back-substitute the estimated PDF, and assuming a Gaussian kernel function,
we can show that W is a constant:

  
    
      
        W
        =
        
          k
          
            D
          
        
        (
        2
        π
        
          )
          
            D
            
              /
            
            2
          
        
      
    
    {\displaystyle W=k^{D}(2\pi )^{D/2}}
  

A similar derivation holds for any kernel whose normalising function is of the order hD, although with a different constant factor in place of the (2 π)D/2 term. This produces a generalization of the k-nearest neighbour algorithm.
That is, a uniform kernel function will return the 
KNN technique.
There are two components to the error: a variance term and a bias term.  The variance term is given as:

  
    
      
        
          e
          
            1
          
        
        =
        
          
            
              P
              ∫
              
                K
                
                  2
                
              
            
            
              n
              
                h
                
                  D
                
              
            
          
        
      
    
    {\displaystyle e_{1}={\frac {P\int K^{2}}{nh^{D}}}}
  
.
The bias term is found by evaluating the approximated function in the limit as the kernel
width becomes much larger than the sample spacing.  By using a Taylor expansion for the real function, the bias term drops out:

  
    
      
        
          e
          
            2
          
        
        =
        
          
            
              h
              
                2
              
            
            n
          
        
        
          ∇
          
            2
          
        
        P
      
    
    {\displaystyle e_{2}={\frac {h^{2}}{n}}\nabla ^{2}P}
  

An optimal kernel width that minimizes the error of each estimate can thus be derived.


== Use for statistical classification ==
The method is particularly effective when applied to statistical classification.
There are two ways we can proceed: the first is to compute the PDFs of
each class separately, using different bandwidth parameters, 
and then compare them as in Taylor.
Alternatively, we can divide up the sum based on the class of each sample:

  
    
      
        P
        (
        j
        ,
        
          
            
              x
              →
            
          
        
        )
        ≈
        
          
            1
            n
          
        
        
          ∑
          
            i
            =
            1
            ,
            
              c
              
                i
              
            
            =
            j
          
          
            n
          
        
        
          w
          
            i
          
        
      
    
    {\displaystyle P(j,{\vec {x}})\approx {\frac {1}{n}}\sum _{i=1,c_{i}=j}^{n}w_{i}}
  

where ci is the class of the ith sample.
The class of the test point may be estimated through maximum likelihood.


== External links ==
akde1d.m - Matlab m-file for one-dimensional adaptive kernel density estimation.
libAGF - A C++ library for multivariate adaptive kernel density estimation.
akde.m Archived 2017-02-09 at the Wayback Machine - Matlab function for  multivariate (high-dimensional) variable kernel density estimation.


== References ==