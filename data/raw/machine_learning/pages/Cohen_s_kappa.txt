Cohen's kappa coefficient ('κ', lowercase Greek kappa) is a statistic that is used to measure inter-rater reliability for qualitative (categorical) items. It is generally thought to be a more robust measure than simple percent agreement calculation, as κ incorporates the possibility of the agreement occurring by chance. There is controversy surrounding Cohen's kappa due to the difficulty in interpreting indices of agreement. Some researchers have suggested that it is conceptually simpler to evaluate disagreement between items.
Cohen's kappa coefficient ranges from -1 (complete disagreement) to 1 (complete agreement).


== History ==
The first mention of a kappa-like statistic is attributed to Galton in 1892.
The seminal paper introducing kappa as a new technique was published by Jacob Cohen in the journal Educational and Psychological Measurement in 1960.


== Definition ==
Cohen's kappa measures the agreement between two raters who each classify N items into C mutually exclusive categories. The definition of 
  
    
      
        κ
      
    
    {\textstyle \kappa }
  
 is

  
    
      
        κ
        ≡
        
          
            
              
                p
                
                  o
                
              
              −
              
                p
                
                  e
                
              
            
            
              1
              −
              
                p
                
                  e
                
              
            
          
        
        =
        1
        −
        
          
            
              1
              −
              
                p
                
                  o
                
              
            
            
              1
              −
              
                p
                
                  e
                
              
            
          
        
        ,
      
    
    {\displaystyle \kappa \equiv {\frac {p_{o}-p_{e}}{1-p_{e}}}=1-{\frac {1-p_{o}}{1-p_{e}}},}
  

where po is the relative observed agreement among raters, and pe is the hypothetical probability of chance agreement, using the observed data to calculate the probabilities of each observer randomly selecting each category. If the raters are in complete agreement then 
  
    
      
        κ
        =
        1
      
    
    {\textstyle \kappa =1}
  
. If there is no agreement among the raters other than what would be expected by chance (as given by pe), 
  
    
      
        κ
        =
        0
      
    
    {\textstyle \kappa =0}
  
. It is possible for the statistic to be negative, which can occur by chance if there is no relationship between the ratings of the two raters, or it may reflect a real tendency of the raters to give differing ratings.
For k categories, N observations to categorize and 
  
    
      
        
          n
          
            k
            i
          
        
      
    
    {\displaystyle n_{ki}}
  
 the number of times rater i predicted category k:

  
    
      
        
          p
          
            e
          
        
        =
        
          
            1
            
              N
              
                2
              
            
          
        
        
          ∑
          
            k
          
        
        
          n
          
            k
            1
          
        
        
          n
          
            k
            2
          
        
      
    
    {\displaystyle p_{e}={\frac {1}{N^{2}}}\sum _{k}n_{k1}n_{k2}}
  

This is derived from the following construction:

  
    
      
        
          p
          
            e
          
        
        =
        
          ∑
          
            k
          
        
        
          
            
              
                p
                
                  k
                  12
                
              
              ^
            
          
        
        
          
            =
            ind.
          
        
        
          ∑
          
            k
          
        
        
          
            
              
                p
                
                  k
                  1
                
              
              ^
            
          
        
        
          
            
              
                p
                
                  k
                  2
                
              
              ^
            
          
        
        =
        
          ∑
          
            k
          
        
        
          
            
              n
              
                k
                1
              
            
            N
          
        
        
          
            
              n
              
                k
                2
              
            
            N
          
        
        =
        
          
            1
            
              N
              
                2
              
            
          
        
        
          ∑
          
            k
          
        
        
          n
          
            k
            1
          
        
        
          n
          
            k
            2
          
        
      
    
    {\displaystyle p_{e}=\sum _{k}{\widehat {p_{k12}}}{\overset {\text{ind.}}{=}}\sum _{k}{\widehat {p_{k1}}}{\widehat {p_{k2}}}=\sum _{k}{\frac {n_{k1}}{N}}{\frac {n_{k2}}{N}}={\frac {1}{N^{2}}}\sum _{k}n_{k1}n_{k2}}
  

Where 
  
    
      
        
          
            
              
                p
                
                  k
                  12
                
              
              ^
            
          
        
      
    
    {\displaystyle {\widehat {p_{k12}}}}
  
 is the estimated probability that both rater 1 and rater 2 will classify the same item as k, while 
  
    
      
        
          
            
              
                p
                
                  k
                  1
                
              
              ^
            
          
        
      
    
    {\displaystyle {\widehat {p_{k1}}}}
  
 is the estimated probability that rater 1 will classify an item as k (and similarly for rater 2).
The relation 
  
    
      
        
          
            
              
                p
                
                  k
                
              
              ^
            
          
        
        =
        
          ∑
          
            k
          
        
        
          
            
              
                p
                
                  k
                  1
                
              
              ^
            
          
        
        
          
            
              
                p
                
                  k
                  2
                
              
              ^
            
          
        
      
    
    {\textstyle {\widehat {p_{k}}}=\sum _{k}{\widehat {p_{k1}}}{\widehat {p_{k2}}}}
  
 is based on using the assumption that the rating of the two raters are independent. The term 
  
    
      
        
          
            
              
                p
                
                  k
                  1
                
              
              ^
            
          
        
      
    
    {\displaystyle {\widehat {p_{k1}}}}
  
 is estimated by using the number of items classified as k by rater 1 (
  
    
      
        
          n
          
            k
            1
          
        
      
    
    {\displaystyle n_{k1}}
  
) divided by the total items to classify (
  
    
      
        N
      
    
    {\displaystyle N}
  
): 
  
    
      
        
          
            
              
                p
                
                  k
                  1
                
              
              ^
            
          
        
        =
        
          
            
              n
              
                k
                1
              
            
            N
          
        
      
    
    {\displaystyle {\widehat {p_{k1}}}={n_{k1} \over N}}
  
 (and similarly for rater 2).


=== Binary classification confusion matrix ===
In the traditional 2 × 2 confusion matrix employed in machine learning and statistics to evaluate binary classifications, the Cohen's Kappa formula can be written as:

  
    
      
        κ
        =
        
          
            
              2
              ×
              (
              T
              P
              ×
              T
              N
              −
              F
              N
              ×
              F
              P
              )
            
            
              (
              T
              P
              +
              F
              P
              )
              ×
              (
              F
              P
              +
              T
              N
              )
              +
              (
              T
              P
              +
              F
              N
              )
              ×
              (
              F
              N
              +
              T
              N
              )
            
          
        
      
    
    {\displaystyle \kappa ={\frac {2\times (TP\times TN-FN\times FP)}{(TP+FP)\times (FP+TN)+(TP+FN)\times (FN+TN)}}}
  

where TP are the true positives, FP are the false positives, TN are the true negatives, and FN are the false negatives. In this case, Cohen's Kappa is equivalent to the Heidke skill score known in Meteorology. The measure was first introduced by Myrick Haskell Doolittle in 1888.


== Examples ==


=== Simple example ===
Suppose that you were analyzing data related to a group of 50 people applying for a grant. Each grant proposal was read by two readers and each reader either said "Yes" or "No" to the proposal. Suppose the disagreement count data were as follows, where A and B are readers, data on the main diagonal of the matrix (a and d) count the number of agreements and off-diagonal data (b and c) count the number of disagreements:

e.g.

The observed proportionate agreement is:

  
    
      
        
          p
          
            o
          
        
        =
        
          
            
              a
              +
              d
            
            
              a
              +
              b
              +
              c
              +
              d
            
          
        
        =
        
          
            
              20
              +
              15
            
            50
          
        
        =
        0.7
      
    
    {\displaystyle p_{o}={\frac {a+d}{a+b+c+d}}={\frac {20+15}{50}}=0.7}
  

To calculate pe (the probability of random agreement) we note that:

Reader A said "Yes" to 25 applicants and "No" to 25 applicants. Thus reader A said "Yes" 50% of the time.
Reader B said "Yes" to 30 applicants and "No" to 20 applicants. Thus reader B said "Yes" 60% of the time.
So the expected probability that both would say yes at random is:

  
    
      
        
          p
          
            Yes
          
        
        =
        
          
            
              a
              +
              b
            
            
              a
              +
              b
              +
              c
              +
              d
            
          
        
        ⋅
        
          
            
              a
              +
              c
            
            
              a
              +
              b
              +
              c
              +
              d
            
          
        
        =
        0.5
        ×
        0.6
        =
        0.3
      
    
    {\displaystyle p_{\text{Yes}}={\frac {a+b}{a+b+c+d}}\cdot {\frac {a+c}{a+b+c+d}}=0.5\times 0.6=0.3}
  

Similarly:

  
    
      
        
          p
          
            No
          
        
        =
        
          
            
              c
              +
              d
            
            
              a
              +
              b
              +
              c
              +
              d
            
          
        
        ⋅
        
          
            
              b
              +
              d
            
            
              a
              +
              b
              +
              c
              +
              d
            
          
        
        =
        0.5
        ×
        0.4
        =
        0.2
      
    
    {\displaystyle p_{\text{No}}={\frac {c+d}{a+b+c+d}}\cdot {\frac {b+d}{a+b+c+d}}=0.5\times 0.4=0.2}
  

Overall random agreement probability is the probability that they agreed on either Yes or No, i.e.:

  
    
      
        
          p
          
            e
          
        
        =
        
          p
          
            Yes
          
        
        +
        
          p
          
            No
          
        
        =
        0.3
        +
        0.2
        =
        0.5
      
    
    {\displaystyle p_{e}=p_{\text{Yes}}+p_{\text{No}}=0.3+0.2=0.5}
  

So now applying our formula for Cohen's Kappa we get:

  
    
      
        κ
        =
        
          
            
              
                p
                
                  o
                
              
              −
              
                p
                
                  e
                
              
            
            
              1
              −
              
                p
                
                  e
                
              
            
          
        
        =
        
          
            
              0.7
              −
              0.5
            
            
              1
              −
              0.5
            
          
        
        =
        0.4
      
    
    {\displaystyle \kappa ={\frac {p_{o}-p_{e}}{1-p_{e}}}={\frac {0.7-0.5}{1-0.5}}=0.4}
  


=== Same percentages but different numbers ===
A case sometimes considered to be a problem with Cohen's Kappa occurs when comparing the Kappa calculated for two pairs of raters with the two raters in each pair having the same percentage agreement but one pair give a similar number of ratings in each class while the other pair give a very different number of ratings in each class. (In the cases below, notice B has 70 yeses and 30 nos, in the first case, but those numbers are reversed in the second.) For instance, in the following two cases there is equal agreement between A and B (60 out of 100 in both cases) in terms of agreement in each class, so we would expect the relative values of Cohen's Kappa to reflect this. However, calculating Cohen's Kappa for each:

  
    
      
        κ
        =
        
          
            
              0.60
              −
              0.54
            
            
              1
              −
              0.54
            
          
        
        =
        0.1304
      
    
    {\displaystyle \kappa ={\frac {0.60-0.54}{1-0.54}}=0.1304}
  

  
    
      
        κ
        =
        
          
            
              0.60
              −
              0.46
            
            
              1
              −
              0.46
            
          
        
        =
        0.2593
      
    
    {\displaystyle \kappa ={\frac {0.60-0.46}{1-0.46}}=0.2593}
  

we find that it shows greater similarity between A and B in the second case, compared to the first. This is because while the percentage agreement is the same, the percentage agreement that would occur 'by chance' is significantly higher in the first case (0.54 compared to 0.46).


== Properties ==


=== Hypothesis testing and confidence interval ===
P-value for kappa is rarely reported, probably because even relatively low values of kappa can nonetheless be significantly different from zero but not of sufficient magnitude to satisfy investigators.
Still, its standard error has been described
and is computed by various computer programs.
Confidence intervals for Kappa may be constructed, for the expected Kappa values if we had infinite number of items checked, using the following formula:

  
    
      
        C
        I
        :
        κ
        ±
        
          Z
          
            1
            −
            α
            
              /
            
            2
          
        
        S
        
          E
          
            κ
          
        
      
    
    {\displaystyle CI:\kappa \pm Z_{1-\alpha /2}SE_{\kappa }}
  

Where 
  
    
      
        
          Z
          
            1
            −
            α
            
              /
            
            2
          
        
        =
        1.960
      
    
    {\displaystyle Z_{1-\alpha /2}=1.960}
  
 is the standard normal percentile when 
  
    
      
        α
        =
        5
        %
      
    
    {\displaystyle \alpha =5\%}
  
, and 
  
    
      
        S
        
          E
          
            κ
          
        
      
    
    {\displaystyle SE_{\kappa }}
  
 is calculated by jackknife, bootstrap or the asymptotic formula described by Fleiss & Cohen.


=== Interpreting magnitude ===

If statistical significance is not a useful guide, what magnitude of kappa reflects adequate agreement? Guidelines would be helpful, but factors other than agreement can influence its magnitude, which makes interpretation of a given magnitude problematic. As Sim and Wright noted, two important factors are prevalence (are the codes equiprobable or do their probabilities vary) and bias (are the marginal probabilities for the two observers similar or different). Other things being equal, kappas are higher when codes are equiprobable. On the other hand, Kappas are higher when codes are distributed asymmetrically by the two observers. In contrast to probability variations, the effect of bias is greater when Kappa is small than when it is large.
Another factor is the number of codes. As number of codes increases, kappas become higher. Based on a simulation study, Bakeman and colleagues concluded that for fallible observers, values for kappa were lower when codes were fewer. And, in agreement with Sim & Wrights's statement concerning prevalence, kappas were higher when codes were roughly equiprobable. Thus Bakeman et al. concluded that "no one value of kappa can be regarded as universally acceptable." They also provide a computer program that lets users compute values for kappa specifying number of codes, their probability, and observer accuracy. For example, given equiprobable codes and observers who are 85% accurate, value of kappa are 0.49, 0.60, 0.66, and 0.69 when number of codes is 2, 3, 5, and 10, respectively.
Nonetheless, magnitude guidelines have appeared in the literature. Perhaps the first was Landis and Koch,
who characterized values < 0 as indicating no agreement and 0–0.20 as slight, 0.21–0.40 as fair, 0.41–0.60 as moderate, 0.61–0.80 as substantial, and 0.81–1 as almost perfect agreement. This set of guidelines is however by no means universally accepted; Landis and Koch supplied no evidence to support it, basing it instead on personal opinion. It has been noted that these guidelines may be more harmful than helpful. Fleiss's equally arbitrary guidelines characterize kappas over 0.75 as excellent, 0.40 to 0.75 as fair to good, and below 0.40 as poor.


=== Kappa maximum ===
Kappa assumes its theoretical maximum value of 1 only when both observers distribute codes the same, that is, when corresponding row and column sums are identical. Anything less is less than perfect agreement. Still, the maximum value kappa could achieve given unequal distributions helps interpret the value of kappa actually obtained. The equation for κ maximum is:

  
    
      
        
          κ
          
            max
          
        
        =
        
          
            
              
                P
                
                  max
                
              
              −
              
                P
                
                  exp
                
              
            
            
              1
              −
              
                P
                
                  exp
                
              
            
          
        
      
    
    {\displaystyle \kappa _{\max }={\frac {P_{\max }-P_{\exp }}{1-P_{\exp }}}}
  

where 
  
    
      
        
          P
          
            exp
          
        
        =
        
          ∑
          
            i
            =
            1
          
          
            k
          
        
        
          P
          
            i
            +
          
        
        
          P
          
            +
            i
          
        
      
    
    {\displaystyle P_{\exp }=\sum _{i=1}^{k}P_{i+}P_{+i}}
  
, as usual, 
  
    
      
        
          P
          
            max
          
        
        =
        
          ∑
          
            i
            =
            1
          
          
            k
          
        
        min
        (
        
          P
          
            i
            +
          
        
        ,
        
          P
          
            +
            i
          
        
        )
      
    
    {\displaystyle P_{\max }=\sum _{i=1}^{k}\min(P_{i+},P_{+i})}
  
,
k = number of codes, 
  
    
      
        
          P
          
            i
            +
          
        
      
    
    {\displaystyle P_{i+}}
  
 are the row probabilities, and 
  
    
      
        
          P
          
            +
            i
          
        
      
    
    {\displaystyle P_{+i}}
  
 are the column probabilities.


=== Limitations ===
Kappa is an index that considers observed agreement with respect to a baseline agreement. However, investigators must consider carefully whether Kappa's baseline agreement is relevant for the particular research question. Kappa's baseline is frequently described as the agreement due to chance, which is only partially correct. Kappa's baseline agreement is the agreement that would be expected due to random allocation, given the quantities specified by the marginal totals of square contingency table. Thus, κ = 0 when the observed allocation is apparently random, regardless of the quantity disagreement as constrained by the marginal totals. However, for many applications, investigators should be more interested in the quantity disagreement in the marginal totals than in the allocation disagreement as described by the additional information on the diagonal of the square contingency table. Thus for many applications, Kappa's baseline is more distracting than enlightening. Consider the following example:

The disagreement proportion is 14/16 or 0.875. The disagreement is due to quantity because allocation is optimal. κ is 0.01.

The disagreement proportion is 2/16 or 0.125. The disagreement is due to allocation because quantities are identical. Kappa is −0.07.

Here, reporting quantity and allocation disagreement is informative while Kappa obscures information. Furthermore, Kappa introduces some challenges in calculation and interpretation because Kappa is a ratio. It is possible for Kappa's ratio to return an undefined value due to zero in the denominator. Furthermore, a ratio does not reveal its numerator nor its denominator. It is more informative for researchers to report disagreement in two components, quantity and allocation. These two components describe the relationship between the categories more clearly than a single summary statistic. When predictive accuracy is the goal, researchers can more easily begin to think about ways to improve a prediction by using two components of quantity and allocation, rather than one ratio of Kappa.Some researchers have expressed concern over κ's tendency to take the observed categories' frequencies as givens, which can make it unreliable for measuring agreement in situations such as the diagnosis of rare diseases. In these situations, κ tends to underestimate the agreement on the rare category. For this reason, κ is considered an overly conservative measure of agreement. Others contest the assertion that kappa "takes into account" chance agreement. To do this effectively would require an explicit model of how chance affects rater decisions. The so-called chance adjustment of kappa statistics supposes that, when not completely certain, raters simply guess—a very unrealistic scenario. Moreover, some works have shown how kappa statistics can lead to a wrong conclusion for unbalanced data. 


== Related statistics ==


=== Scott's Pi ===
A similar statistic, called pi, was proposed by Scott (1955). Cohen's kappa and Scott's pi differ in terms of how pe is calculated.


=== Fleiss' kappa ===
Note that Cohen's kappa measures agreement between two raters only. For a similar measure of agreement (Fleiss' kappa) used when there are more than two raters, see Fleiss (1971). The Fleiss kappa, however, is a multi-rater generalization of Scott's pi statistic, not Cohen's kappa. Kappa is also used to compare performance in machine learning, but the directional version known as Informedness or Youden's J statistic is argued to be more appropriate for supervised learning.


=== Weighted kappa ===
The weighted kappa allows disagreements to be weighted differently and is especially useful when codes are ordered. Three matrices are involved, the matrix of observed scores, the matrix of expected scores based on chance agreement, and the weight matrix. Weight matrix cells located on the diagonal (upper-left to bottom-right) represent agreement and thus contain zeros. Off-diagonal cells contain weights indicating the seriousness of that disagreement. Often, cells one off the diagonal are weighted 1, those two off 2, etc.
The equation for weighted κ is:

  
    
      
        κ
        =
        1
        −
        
          
            
              
                ∑
                
                  i
                  =
                  1
                
                
                  k
                
              
              
                ∑
                
                  j
                  =
                  1
                
                
                  k
                
              
              
                w
                
                  i
                  j
                
              
              
                x
                
                  i
                  j
                
              
            
            
              
                ∑
                
                  i
                  =
                  1
                
                
                  k
                
              
              
                ∑
                
                  j
                  =
                  1
                
                
                  k
                
              
              
                w
                
                  i
                  j
                
              
              
                m
                
                  i
                  j
                
              
            
          
        
      
    
    {\displaystyle \kappa =1-{\frac {\sum _{i=1}^{k}\sum _{j=1}^{k}w_{ij}x_{ij}}{\sum _{i=1}^{k}\sum _{j=1}^{k}w_{ij}m_{ij}}}}
  

where k=number of codes and 
  
    
      
        
          w
          
            i
            j
          
        
      
    
    {\displaystyle w_{ij}}
  
, 
  
    
      
        
          x
          
            i
            j
          
        
      
    
    {\displaystyle x_{ij}}
  
, and 
  
    
      
        
          m
          
            i
            j
          
        
      
    
    {\displaystyle m_{ij}}
  
 are elements in the weight, observed, and expected matrices, respectively. When diagonal cells contain weights of 0 and all off-diagonal cells weights of 1, this formula produces the same value of kappa as the calculation given above.


== See also ==
Bangdiwala's B
Intraclass correlation
Krippendorff's alpha
Statistical classification


== Further reading ==
Banerjee, M.; Capozzoli, Michelle; McSweeney, Laura; Sinha, Debajyoti (1999). "Beyond Kappa: A Review of Interrater Agreement Measures". The Canadian Journal of Statistics. 27 (1): 3–23. doi:10.2307/3315487. JSTOR 3315487. S2CID 37082712.
Chicco, D.; Warrens, M.J.; Jurman, G. (2021). "The Matthews correlation coefficient (MCC) is more informative than Cohen's Kappa and Brier score in binary classification assessment". IEEE Access. 9: 78368–81. Bibcode:2021IEEEA...978368C. doi:10.1109/access.2021.3084050. hdl:10281/430460. S2CID 235308708.
Cohen, Jacob (1960). "A coefficient of agreement for nominal scales". Educational and Psychological Measurement. 20 (1): 37–46. doi:10.1177/001316446002000104. hdl:1942/28116. S2CID 15926286.
Cohen, J. (1968). "Weighted kappa: Nominal scale agreement with provision for scaled disagreement or partial credit". Psychological Bulletin. 70 (4): 213–220. doi:10.1037/h0026256. PMID 19673146.
Fleiss, J.L.; Cohen, J. (1973). "The equivalence of weighted kappa and the intraclass correlation coefficient as measures of reliability". Educational and Psychological Measurement. 33 (3): 613–9. doi:10.1177/001316447303300309. S2CID 145183399.
Sim, J.; Wright, C.C. (2005). "The Kappa Statistic in Reliability Studies: Use, Interpretation, and Sample Size Requirements". Physical Therapy. 85 (3): 257–268. doi:10.1093/ptj/85.3.257. PMID 15733050.
Warrens, J. (2011). "Cohen's kappa is a weighted average". Statistical Methodology. 8 (6): 473–484. doi:10.1016/j.stamet.2011.06.002. hdl:1887/18062.


== External links ==
Online Kappa Calculator
Cohen's Kappa Statistic for Measuring Agreement with SAS example


== References ==