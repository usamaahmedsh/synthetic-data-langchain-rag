In mathematics, matrix calculus is a specialized notation for doing multivariable calculus, especially over spaces of matrices.  It collects the various partial derivatives of a single function with respect to many variables, and/or of a multivariate function with respect to a single variable, into vectors and matrices that can be treated as single entities.  This greatly simplifies operations such as finding the maximum or minimum of a multivariate function and solving systems of differential equations. The notation used here is commonly used in statistics and engineering, while the tensor index notation is preferred in physics.
Two competing notational conventions split the field of matrix calculus into two separate groups. The two groups can be distinguished by whether they write the derivative of a scalar with respect to a vector as a column vector or a row vector. Both of these conventions are possible even when the common assumption is made that vectors should be treated as column vectors when combined with matrices (rather than row vectors). A single convention can be somewhat standard throughout a single field that commonly uses matrix calculus (e.g. econometrics, statistics, estimation theory and machine learning). However, even within a given field different authors can be found using competing conventions. Authors of both groups often write as though their specific conventions were standard. Serious mistakes can result when combining results from different authors without carefully verifying that compatible notations have been used. Definitions of these two conventions and comparisons between them are collected in the layout conventions section.


== Scope ==
Matrix calculus refers to a number of different notations that use matrices and vectors to collect the derivative of each component of the dependent variable with respect to each component of the independent variable. In general, the independent variable can be a scalar, a vector, or a matrix while the dependent variable can be any of these as well. Each different situation will lead to a different set of rules, or a separate calculus, using the broader sense of the term. Matrix notation serves as a convenient way to collect the many derivatives in an organized way.
As a first example, consider the gradient from vector calculus. For a scalar function of three independent variables, 
  
    
      
        f
        (
        
          x
          
            1
          
        
        ,
        
          x
          
            2
          
        
        ,
        
          x
          
            3
          
        
        )
      
    
    {\displaystyle f(x_{1},x_{2},x_{3})}
  
, the gradient is given by the vector equation

  
    
      
        ∇
        f
        =
        
          
            
              ∂
              f
            
            
              ∂
              
                x
                
                  1
                
              
            
          
        
        
          
            
              
                x
                ^
              
            
          
          
            1
          
        
        +
        
          
            
              ∂
              f
            
            
              ∂
              
                x
                
                  2
                
              
            
          
        
        
          
            
              
                x
                ^
              
            
          
          
            2
          
        
        +
        
          
            
              ∂
              f
            
            
              ∂
              
                x
                
                  3
                
              
            
          
        
        
          
            
              
                x
                ^
              
            
          
          
            3
          
        
        ,
      
    
    {\displaystyle \nabla f={\frac {\partial f}{\partial x_{1}}}{\hat {x}}_{1}+{\frac {\partial f}{\partial x_{2}}}{\hat {x}}_{2}+{\frac {\partial f}{\partial x_{3}}}{\hat {x}}_{3},}
  

where 
  
    
      
        
          
            
              
                x
                ^
              
            
          
          
            i
          
        
      
    
    {\displaystyle {\hat {x}}_{i}}
  
 represents a unit vector in the 
  
    
      
        
          x
          
            i
          
        
      
    
    {\displaystyle x_{i}}
  
 direction for 
  
    
      
        1
        ≤
        i
        ≤
        3
      
    
    {\displaystyle 1\leq i\leq 3}
  
. This type of generalized derivative can be seen as the derivative of a scalar, f, with respect to a vector, 
  
    
      
        
          x
        
      
    
    {\displaystyle \mathbf {x} }
  
, and its result can be easily collected in vector form.

  
    
      
        ∇
        f
        =
        
          
            (
            
              
                
                  ∂
                  f
                
                
                  ∂
                  
                    x
                  
                
              
            
            )
          
          
            
              T
            
          
        
        =
        
          
            
              [
              
                
                  
                    
                      
                        
                          
                            ∂
                            f
                          
                          
                            ∂
                            
                              x
                              
                                1
                              
                            
                          
                        
                      
                    
                  
                  
                    
                      
                        
                          
                            ∂
                            f
                          
                          
                            ∂
                            
                              x
                              
                                2
                              
                            
                          
                        
                      
                    
                  
                  
                    
                      
                        
                          
                            ∂
                            f
                          
                          
                            ∂
                            
                              x
                              
                                3
                              
                            
                          
                        
                      
                    
                  
                
              
              ]
            
          
          
            
              T
            
          
        
        .
      
    
    {\displaystyle \nabla f=\left({\frac {\partial f}{\partial \mathbf {x} }}\right)^{\mathsf {T}}={\begin{bmatrix}{\dfrac {\partial f}{\partial x_{1}}}&{\dfrac {\partial f}{\partial x_{2}}}&{\dfrac {\partial f}{\partial x_{3}}}\\\end{bmatrix}}^{\textsf {T}}.}
  

More complicated examples include the derivative of a scalar function with respect to a matrix, known as the gradient matrix, which collects the derivative with respect to each matrix element in the corresponding position in the resulting matrix. In that case the scalar must be a function of each of the independent variables in the matrix. As another example, if we have an n-vector of dependent variables, or functions, of m independent variables we might consider the derivative of the dependent vector with respect to the independent vector. The result could be collected in an m×n matrix consisting of all of the possible derivative combinations.
There are a total of nine possibilities using scalars, vectors, and matrices. Notice that as we consider higher numbers of components in each of the independent and dependent variables we can be left with a very large number of possibilities. The six kinds of derivatives that can be most neatly organized in matrix form are collected in the following table.

Here, we have used the term "matrix" in its most general sense, recognizing that vectors are simply matrices with one column (and scalars are simply vectors with one row). Moreover, we have used bold letters to indicate vectors and bold capital letters for matrices. This notation is used throughout.
Notice that we could also talk about the derivative of a vector with respect to a matrix, or any of the other unfilled cells in our table. However, these derivatives are most naturally organized in a tensor of rank higher than 2, so that they do not fit neatly into a matrix. In the following three sections we will define each one of these derivatives and relate them to other branches of mathematics. See the layout conventions section for a more detailed table.


=== Relation to other derivatives ===
The matrix derivative is a convenient notation for keeping track of partial derivatives for doing calculations. The Fréchet derivative is the standard way in the setting of functional analysis to take derivatives with respect to vectors. In the case that a matrix function of a matrix is Fréchet differentiable, the two derivatives will agree up to translation of notations. As is the case in general for partial derivatives, some formulae may extend under weaker analytic conditions than the existence of the derivative as approximating linear mapping.


=== Usages ===
Matrix calculus is used for deriving optimal stochastic estimators, often involving the use of Lagrange multipliers. This includes the derivation of:

Kalman filter
Wiener filter
Expectation-maximization algorithm for Gaussian mixture
Gradient descent


== Notation ==
The vector and matrix derivatives presented in the sections to follow take full advantage of matrix notation, using a single variable to represent a large number of variables. In what follows we will distinguish scalars, vectors and matrices by their typeface. We will let M(n,m) denote the space of real n×m matrices with n rows and m columns.  Such matrices will be denoted using bold capital letters: A, X, Y, etc.  An element of M(n,1), that is, a column vector, is denoted with a boldface lowercase letter: a, x, y, etc. An element of M(1,1) is a scalar, denoted with lowercase italic typeface: a, t, x, etc. XT denotes matrix transpose, tr(X) is the trace, and det(X) or |X| is the determinant. All functions are assumed to be of differentiability class C1 unless otherwise noted. Generally letters from the first half of the alphabet (a, b, c, ...) will be used to denote constants, and from the second half (t, x, y, ...) to denote variables.
NOTE: As mentioned above, there are competing notations for laying out systems of partial derivatives in vectors and matrices, and no standard appears to be emerging yet.  The next two introductory sections use the numerator layout convention simply for the purposes of convenience, to avoid overly complicating the discussion.  The section after them discusses layout conventions in more detail.  It is important to realize the following:

Despite the use of the terms "numerator layout" and "denominator layout", there are actually more than two possible notational choices involved.  The reason is that the choice of numerator vs. denominator (or in some situations, numerator vs. mixed) can be made independently for scalar-by-vector, vector-by-scalar, vector-by-vector, and scalar-by-matrix derivatives, and a number of authors mix and match their layout choices in various ways.
The choice of numerator layout in the introductory sections below does not imply that this is the "correct" or "superior" choice.  There are advantages and disadvantages to the various layout types.  Serious mistakes can result from carelessly combining formulas written in different layouts, and converting from one layout to another requires care to avoid errors.  As a result, when working with existing formulas the best policy is probably to identify whichever layout is used and maintain consistency with it, rather than attempting to use the same layout in all situations.


=== Alternatives ===
The tensor index notation with its Einstein summation convention is very similar to the matrix calculus, except one writes only a single component at a time.  It has the advantage that one can easily manipulate arbitrarily high rank tensors, whereas tensors of rank higher than two are quite unwieldy with matrix notation.  All of the work here can be done in this notation without use of the single-variable matrix notation. However, many problems in estimation theory and other areas of applied mathematics would result in too many indices to properly keep track of, pointing in favor of matrix calculus in those areas.  Also, Einstein notation can be very useful in proving the identities presented here (see section on differentiation) as an alternative to typical element notation, which can become cumbersome when the explicit sums are carried around. Note that a matrix can be considered a tensor of rank two.


== Derivatives with vectors ==

Because vectors are matrices with only one column, the simplest matrix derivatives are vector derivatives.
The notations developed here can accommodate the usual operations of vector calculus by identifying the space M(n,1) of n-vectors with the Euclidean space Rn, and the scalar M(1,1) is identified with R. The corresponding concept from vector calculus is indicated at the end of each subsection.
NOTE: The discussion in this section assumes the numerator layout convention for pedagogical purposes.  Some authors use different conventions.  The section on layout conventions discusses this issue in greater detail.  The identities given further down are presented in forms that can be used in conjunction with all common layout conventions.


=== Vector-by-scalar ===
The derivative of a vector 
  
    
      
        
          y
        
        =
        
          
            
              [
              
                
                  
                    
                      y
                      
                        1
                      
                    
                  
                  
                    
                      y
                      
                        2
                      
                    
                  
                  
                    ⋯
                  
                  
                    
                      y
                      
                        m
                      
                    
                  
                
              
              ]
            
          
          
            
              T
            
          
        
      
    
    {\displaystyle \mathbf {y} ={\begin{bmatrix}y_{1}&y_{2}&\cdots &y_{m}\end{bmatrix}}^{\mathsf {T}}}
  
, by a scalar x is written (in numerator layout notation) as

  
    
      
        
          
            
              d
              
                y
              
            
            
              d
              x
            
          
        
        =
        
          
            [
            
              
                
                  
                    
                      
                        d
                        
                          y
                          
                            1
                          
                        
                      
                      
                        d
                        x
                      
                    
                  
                
              
              
                
                  
                    
                      
                        d
                        
                          y
                          
                            2
                          
                        
                      
                      
                        d
                        x
                      
                    
                  
                
              
              
                
                  ⋮
                
              
              
                
                  
                    
                      
                        d
                        
                          y
                          
                            m
                          
                        
                      
                      
                        d
                        x
                      
                    
                  
                
              
            
            ]
          
        
        .
      
    
    {\displaystyle {\frac {d\mathbf {y} }{dx}}={\begin{bmatrix}{\frac {dy_{1}}{dx}}\\{\frac {dy_{2}}{dx}}\\\vdots \\{\frac {dy_{m}}{dx}}\\\end{bmatrix}}.}
  

In vector calculus the derivative of a vector y with respect to a scalar x is known as the tangent vector of the vector y, 
  
    
      
        
          
            
              ∂
              
                y
              
            
            
              ∂
              x
            
          
        
      
    
    {\displaystyle {\frac {\partial \mathbf {y} }{\partial x}}}
  
. Notice here that y: R1 → Rm.
Example Simple examples of this include the velocity vector in Euclidean space, which is the tangent vector of the position vector (considered as a function of time). Also, the acceleration is the tangent vector of the velocity.


=== Scalar-by-vector ===
The derivative of a scalar y by a vector 
  
    
      
        
          x
        
        =
        
          
            [
            
              
                
                  
                    x
                    
                      1
                    
                  
                
                
                  
                    x
                    
                      2
                    
                  
                
                
                  ⋯
                
                
                  
                    x
                    
                      n
                    
                  
                
              
            
            ]
          
        
      
    
    {\displaystyle \mathbf {x} ={\begin{bmatrix}x_{1}&x_{2}&\cdots &x_{n}\end{bmatrix}}}
  
, is written (in numerator layout notation) as

  
    
      
        
          
            
              ∂
              y
            
            
              ∂
              
                x
              
            
          
        
        =
        
          
            [
            
              
                
                  
                    
                      
                        
                          ∂
                          y
                        
                        
                          ∂
                          
                            x
                            
                              1
                            
                          
                        
                      
                    
                  
                
                
                  
                    
                      
                        
                          ∂
                          y
                        
                        
                          ∂
                          
                            x
                            
                              2
                            
                          
                        
                      
                    
                  
                
                
                  ⋯
                
                
                  
                    
                      
                        
                          ∂
                          y
                        
                        
                          ∂
                          
                            x
                            
                              n
                            
                          
                        
                      
                    
                  
                
              
            
            ]
          
        
        .
      
    
    {\displaystyle {\frac {\partial y}{\partial \mathbf {x} }}={\begin{bmatrix}{\dfrac {\partial y}{\partial x_{1}}}&{\dfrac {\partial y}{\partial x_{2}}}&\cdots &{\dfrac {\partial y}{\partial x_{n}}}\end{bmatrix}}.}
  

In vector calculus, the gradient of a scalar field f : Rn → R (whose independent coordinates are the components of x) is the transpose of the derivative of a scalar by a vector.

  
    
      
        ∇
        f
        =
        
          
            [
            
              
                
                  
                    
                      
                        ∂
                        f
                      
                      
                        ∂
                        
                          x
                          
                            1
                          
                        
                      
                    
                  
                
              
              
                
                  ⋮
                
              
              
                
                  
                    
                      
                        ∂
                        f
                      
                      
                        ∂
                        
                          x
                          
                            n
                          
                        
                      
                    
                  
                
              
            
            ]
          
        
        =
        
          
            (
            
              
                
                  ∂
                  f
                
                
                  ∂
                  
                    x
                  
                
              
            
            )
          
          
            
              T
            
          
        
      
    
    {\displaystyle \nabla f={\begin{bmatrix}{\frac {\partial f}{\partial x_{1}}}\\\vdots \\{\frac {\partial f}{\partial x_{n}}}\end{bmatrix}}=\left({\frac {\partial f}{\partial \mathbf {x} }}\right)^{\mathsf {T}}}
  

For example, in physics, the electric field is the negative vector gradient of the electric potential.
The directional derivative of a scalar function f(x) of the space vector x in the direction of the unit vector u (represented in this case as a column vector) is defined using the gradient as follows.

  
    
      
        
          ∇
          
            
              u
            
          
        
        
          f
        
        (
        
          x
        
        )
        =
        ∇
        f
        (
        
          x
        
        )
        ⋅
        
          u
        
      
    
    {\displaystyle \nabla _{\mathbf {u} }{f}(\mathbf {x} )=\nabla f(\mathbf {x} )\cdot \mathbf {u} }
  

Using the notation just defined for the derivative of a scalar with respect to a vector we can re-write the directional derivative as

  
    
      
        
          ∇
          
            
              u
            
          
        
        f
        =
        
          
            
              ∂
              f
            
            
              ∂
              
                x
              
            
          
        
        
          u
        
        .
      
    
    {\displaystyle \nabla _{\mathbf {u} }f={\frac {\partial f}{\partial \mathbf {x} }}\mathbf {u} .}
  
 This type of notation will be nice when proving product rules and chain rules that come out looking similar to what we are familiar with for the scalar derivative.


=== Vector-by-vector ===
Each of the previous two cases can be considered as an application of the derivative of a vector with respect to a vector, using a vector of size one appropriately. Similarly we will find that the derivatives involving matrices will reduce to derivatives involving vectors in a corresponding way.
The derivative of a vector function (a vector whose components are functions) 
  
    
      
        
          y
        
        =
        
          
            
              [
              
                
                  
                    
                      y
                      
                        1
                      
                    
                  
                  
                    
                      y
                      
                        2
                      
                    
                  
                  
                    ⋯
                  
                  
                    
                      y
                      
                        m
                      
                    
                  
                
              
              ]
            
          
          
            
              T
            
          
        
      
    
    {\displaystyle \mathbf {y} ={\begin{bmatrix}y_{1}&y_{2}&\cdots &y_{m}\end{bmatrix}}^{\mathsf {T}}}
  
, with respect to an input vector, 
  
    
      
        
          x
        
        =
        
          
            
              [
              
                
                  
                    
                      x
                      
                        1
                      
                    
                  
                  
                    
                      x
                      
                        2
                      
                    
                  
                  
                    ⋯
                  
                  
                    
                      x
                      
                        n
                      
                    
                  
                
              
              ]
            
          
          
            
              T
            
          
        
      
    
    {\displaystyle \mathbf {x} ={\begin{bmatrix}x_{1}&x_{2}&\cdots &x_{n}\end{bmatrix}}^{\mathsf {T}}}
  
, is written (in numerator layout notation) as

  
    
      
        
          
            
              ∂
              
                y
              
            
            
              ∂
              
                x
              
            
          
        
        =
        
          
            [
            
              
                
                  
                    
                      
                        ∂
                        
                          y
                          
                            1
                          
                        
                      
                      
                        ∂
                        
                          x
                          
                            1
                          
                        
                      
                    
                  
                
                
                  
                    
                      
                        ∂
                        
                          y
                          
                            1
                          
                        
                      
                      
                        ∂
                        
                          x
                          
                            2
                          
                        
                      
                    
                  
                
                
                  ⋯
                
                
                  
                    
                      
                        ∂
                        
                          y
                          
                            1
                          
                        
                      
                      
                        ∂
                        
                          x
                          
                            n
                          
                        
                      
                    
                  
                
              
              
                
                  
                    
                      
                        ∂
                        
                          y
                          
                            2
                          
                        
                      
                      
                        ∂
                        
                          x
                          
                            1
                          
                        
                      
                    
                  
                
                
                  
                    
                      
                        ∂
                        
                          y
                          
                            2
                          
                        
                      
                      
                        ∂
                        
                          x
                          
                            2
                          
                        
                      
                    
                  
                
                
                  ⋯
                
                
                  
                    
                      
                        ∂
                        
                          y
                          
                            2
                          
                        
                      
                      
                        ∂
                        
                          x
                          
                            n
                          
                        
                      
                    
                  
                
              
              
                
                  ⋮
                
                
                  ⋮
                
                
                  ⋱
                
                
                  ⋮
                
              
              
                
                  
                    
                      
                        ∂
                        
                          y
                          
                            m
                          
                        
                      
                      
                        ∂
                        
                          x
                          
                            1
                          
                        
                      
                    
                  
                
                
                  
                    
                      
                        ∂
                        
                          y
                          
                            m
                          
                        
                      
                      
                        ∂
                        
                          x
                          
                            2
                          
                        
                      
                    
                  
                
                
                  ⋯
                
                
                  
                    
                      
                        ∂
                        
                          y
                          
                            m
                          
                        
                      
                      
                        ∂
                        
                          x
                          
                            n
                          
                        
                      
                    
                  
                
              
            
            ]
          
        
        .
      
    
    {\displaystyle {\frac {\partial \mathbf {y} }{\partial \mathbf {x} }}={\begin{bmatrix}{\frac {\partial y_{1}}{\partial x_{1}}}&{\frac {\partial y_{1}}{\partial x_{2}}}&\cdots &{\frac {\partial y_{1}}{\partial x_{n}}}\\{\frac {\partial y_{2}}{\partial x_{1}}}&{\frac {\partial y_{2}}{\partial x_{2}}}&\cdots &{\frac {\partial y_{2}}{\partial x_{n}}}\\\vdots &\vdots &\ddots &\vdots \\{\frac {\partial y_{m}}{\partial x_{1}}}&{\frac {\partial y_{m}}{\partial x_{2}}}&\cdots &{\frac {\partial y_{m}}{\partial x_{n}}}\\\end{bmatrix}}.}
  

In vector calculus, the derivative of a vector function y with respect to a vector x whose components represent a space is known as the pushforward (or differential), or the Jacobian matrix.
The pushforward along a vector function f with respect to vector v in Rn is given by 
  
    
      
        d
        
          f
        
        (
        
          v
        
        )
        =
        
          
            
              ∂
              
                f
              
            
            
              ∂
              
                v
              
            
          
        
        d
        
          v
        
        .
      
    
    {\displaystyle d\mathbf {f} (\mathbf {v} )={\frac {\partial \mathbf {f} }{\partial \mathbf {v} }}d\mathbf {v} .}
  


== Derivatives with matrices ==
There are two types of derivatives with matrices that can be organized into a matrix of the same size. These are the derivative of a matrix by a scalar and the derivative of a scalar by a matrix. These can be useful in minimization problems found in many areas of applied mathematics and have adopted the names tangent matrix and gradient matrix respectively after their analogs for vectors.
Note: The discussion in this section assumes the numerator layout convention for pedagogical purposes.  Some authors use different conventions.  The section on layout conventions discusses this issue in greater detail.  The identities given further down are presented in forms that can be used in conjunction with all common layout conventions.


=== Matrix-by-scalar ===
The derivative of a matrix function Y by a scalar x is known as the tangent matrix and is given (in numerator layout notation) by

  
    
      
        
          
            
              ∂
              
                Y
              
            
            
              ∂
              x
            
          
        
        =
        
          
            [
            
              
                
                  
                    
                      
                        ∂
                        
                          y
                          
                            11
                          
                        
                      
                      
                        ∂
                        x
                      
                    
                  
                
                
                  
                    
                      
                        ∂
                        
                          y
                          
                            12
                          
                        
                      
                      
                        ∂
                        x
                      
                    
                  
                
                
                  ⋯
                
                
                  
                    
                      
                        ∂
                        
                          y
                          
                            1
                            n
                          
                        
                      
                      
                        ∂
                        x
                      
                    
                  
                
              
              
                
                  
                    
                      
                        ∂
                        
                          y
                          
                            21
                          
                        
                      
                      
                        ∂
                        x
                      
                    
                  
                
                
                  
                    
                      
                        ∂
                        
                          y
                          
                            22
                          
                        
                      
                      
                        ∂
                        x
                      
                    
                  
                
                
                  ⋯
                
                
                  
                    
                      
                        ∂
                        
                          y
                          
                            2
                            n
                          
                        
                      
                      
                        ∂
                        x
                      
                    
                  
                
              
              
                
                  ⋮
                
                
                  ⋮
                
                
                  ⋱
                
                
                  ⋮
                
              
              
                
                  
                    
                      
                        ∂
                        
                          y
                          
                            m
                            1
                          
                        
                      
                      
                        ∂
                        x
                      
                    
                  
                
                
                  
                    
                      
                        ∂
                        
                          y
                          
                            m
                            2
                          
                        
                      
                      
                        ∂
                        x
                      
                    
                  
                
                
                  ⋯
                
                
                  
                    
                      
                        ∂
                        
                          y
                          
                            m
                            n
                          
                        
                      
                      
                        ∂
                        x
                      
                    
                  
                
              
            
            ]
          
        
        .
      
    
    {\displaystyle {\frac {\partial \mathbf {Y} }{\partial x}}={\begin{bmatrix}{\frac {\partial y_{11}}{\partial x}}&{\frac {\partial y_{12}}{\partial x}}&\cdots &{\frac {\partial y_{1n}}{\partial x}}\\{\frac {\partial y_{21}}{\partial x}}&{\frac {\partial y_{22}}{\partial x}}&\cdots &{\frac {\partial y_{2n}}{\partial x}}\\\vdots &\vdots &\ddots &\vdots \\{\frac {\partial y_{m1}}{\partial x}}&{\frac {\partial y_{m2}}{\partial x}}&\cdots &{\frac {\partial y_{mn}}{\partial x}}\\\end{bmatrix}}.}
  


=== Scalar-by-matrix ===
The derivative of a scalar function y, with respect to a p×q matrix X of independent variables, is given (in numerator layout notation) by

  
    
      
        
          
            
              ∂
              y
            
            
              ∂
              
                X
              
            
          
        
        =
        
          
            [
            
              
                
                  
                    
                      
                        ∂
                        y
                      
                      
                        ∂
                        
                          x
                          
                            11
                          
                        
                      
                    
                  
                
                
                  
                    
                      
                        ∂
                        y
                      
                      
                        ∂
                        
                          x
                          
                            21
                          
                        
                      
                    
                  
                
                
                  ⋯
                
                
                  
                    
                      
                        ∂
                        y
                      
                      
                        ∂
                        
                          x
                          
                            p
                            1
                          
                        
                      
                    
                  
                
              
              
                
                  
                    
                      
                        ∂
                        y
                      
                      
                        ∂
                        
                          x
                          
                            12
                          
                        
                      
                    
                  
                
                
                  
                    
                      
                        ∂
                        y
                      
                      
                        ∂
                        
                          x
                          
                            22
                          
                        
                      
                    
                  
                
                
                  ⋯
                
                
                  
                    
                      
                        ∂
                        y
                      
                      
                        ∂
                        
                          x
                          
                            p
                            2
                          
                        
                      
                    
                  
                
              
              
                
                  ⋮
                
                
                  ⋮
                
                
                  ⋱
                
                
                  ⋮
                
              
              
                
                  
                    
                      
                        ∂
                        y
                      
                      
                        ∂
                        
                          x
                          
                            1
                            q
                          
                        
                      
                    
                  
                
                
                  
                    
                      
                        ∂
                        y
                      
                      
                        ∂
                        
                          x
                          
                            2
                            q
                          
                        
                      
                    
                  
                
                
                  ⋯
                
                
                  
                    
                      
                        ∂
                        y
                      
                      
                        ∂
                        
                          x
                          
                            p
                            q
                          
                        
                      
                    
                  
                
              
            
            ]
          
        
        .
      
    
    {\displaystyle {\frac {\partial y}{\partial \mathbf {X} }}={\begin{bmatrix}{\frac {\partial y}{\partial x_{11}}}&{\frac {\partial y}{\partial x_{21}}}&\cdots &{\frac {\partial y}{\partial x_{p1}}}\\{\frac {\partial y}{\partial x_{12}}}&{\frac {\partial y}{\partial x_{22}}}&\cdots &{\frac {\partial y}{\partial x_{p2}}}\\\vdots &\vdots &\ddots &\vdots \\{\frac {\partial y}{\partial x_{1q}}}&{\frac {\partial y}{\partial x_{2q}}}&\cdots &{\frac {\partial y}{\partial x_{pq}}}\\\end{bmatrix}}.}
  

Important examples of scalar functions of matrices include the trace of a matrix and the determinant.
In analog with vector calculus this derivative is often written as the following.

  
    
      
        
          ∇
          
            
              X
            
          
        
        y
        (
        
          X
        
        )
        =
        
          
            
              ∂
              y
              (
              
                X
              
              )
            
            
              ∂
              
                X
              
            
          
        
      
    
    {\displaystyle \nabla _{\mathbf {X} }y(\mathbf {X} )={\frac {\partial y(\mathbf {X} )}{\partial \mathbf {X} }}}
  

Also in analog with vector calculus, the directional derivative of a scalar f(X) of a matrix X in the direction of matrix Y is given by

  
    
      
        
          ∇
          
            
              Y
            
          
        
        f
        =
        tr
        ⁡
        
          (
          
            
              
                
                  ∂
                  f
                
                
                  ∂
                  
                    X
                  
                
              
            
            
              Y
            
          
          )
        
        .
      
    
    {\displaystyle \nabla _{\mathbf {Y} }f=\operatorname {tr} \left({\frac {\partial f}{\partial \mathbf {X} }}\mathbf {Y} \right).}
  

It is the gradient matrix, in particular, that finds many uses in minimization problems in estimation theory, particularly in the derivation of the Kalman filter algorithm, which is of great importance in the field.


=== Other matrix derivatives ===
The three types of derivatives that have not been considered are those involving vectors-by-matrices, matrices-by-vectors, and matrices-by-matrices. These are not as widely considered and a notation is not widely agreed upon.


== Layout conventions ==
This section discusses the similarities and differences between notational conventions that are used in the various fields that take advantage of matrix calculus. Although there are largely two consistent conventions, some authors find it convenient to mix the two conventions in forms that are discussed below. After this section, equations will be listed in both competing forms separately.
The fundamental issue is that the derivative of a vector with respect to a vector, i.e. 
  
    
      
        
          
            
              ∂
              
                y
              
            
            
              ∂
              
                x
              
            
          
        
      
    
    {\displaystyle {\frac {\partial \mathbf {y} }{\partial \mathbf {x} }}}
  
, is often written in two competing ways.  If the numerator y is of size m and the denominator x of size n, then the result can be laid out as either an m×n matrix or n×m matrix, i.e. the m elements of y laid out in rows and the n elements of x laid out in columns, or vice versa.  This leads to the following possibilities:

Numerator layout, i.e.  lay out according to y and xT (i.e. contrarily to x).  This is sometimes known as the Jacobian formulation. This corresponds to the m×n layout in the previous example, which means that the row number of 
  
    
      
        
          
            
              ∂
              
                y
              
            
            
              ∂
              
                x
              
            
          
        
      
    
    {\displaystyle {\frac {\partial \mathbf {y} }{\partial \mathbf {x} }}}
  
 equals to the size of the numerator 
  
    
      
        
          y
        
      
    
    {\displaystyle \mathbf {y} }
  
 and the column number of 
  
    
      
        
          
            
              ∂
              
                y
              
            
            
              ∂
              
                x
              
            
          
        
      
    
    {\displaystyle {\frac {\partial \mathbf {y} }{\partial \mathbf {x} }}}
  
 equals to the size of xT.
Denominator layout, i.e. lay out according to yT and x (i.e. contrarily to y).  This is sometimes known as the Hessian formulation.  Some authors term this layout the gradient, in distinction to the Jacobian (numerator layout), which is its transpose. (However, gradient more commonly means the derivative 
  
    
      
        
          
            
              ∂
              y
            
            
              ∂
              
                x
              
            
          
        
        ,
      
    
    {\displaystyle {\frac {\partial y}{\partial \mathbf {x} }},}
  
 regardless of layout.). This corresponds to the n×m layout in the previous example, which means that the row number of 
  
    
      
        
          
            
              ∂
              
                y
              
            
            
              ∂
              
                x
              
            
          
        
      
    
    {\displaystyle {\frac {\partial \mathbf {y} }{\partial \mathbf {x} }}}
  
 equals to the size of x (the denominator).
A third possibility sometimes seen is to insist on writing the derivative as 
  
    
      
        
          
            
              ∂
              
                y
              
            
            
              ∂
              
                
                  x
                
                ′
              
            
          
        
        ,
      
    
    {\displaystyle {\frac {\partial \mathbf {y} }{\partial \mathbf {x} '}},}
  
 (i.e. the derivative is taken with respect to the transpose of x) and follow the numerator layout.  This makes it possible to claim that the matrix is laid out according to both numerator and denominator.  In practice this produces results the same as the numerator layout.
When handling the gradient 
  
    
      
        
          
            
              ∂
              y
            
            
              ∂
              
                x
              
            
          
        
      
    
    {\displaystyle {\frac {\partial y}{\partial \mathbf {x} }}}
  
 and the opposite case 
  
    
      
        
          
            
              ∂
              
                y
              
            
            
              ∂
              x
            
          
        
        ,
      
    
    {\displaystyle {\frac {\partial \mathbf {y} }{\partial x}},}
  
 we have the same issues.  To be consistent, we should do one of the following:

If we choose numerator layout for 
  
    
      
        
          
            
              ∂
              
                y
              
            
            
              ∂
              
                x
              
            
          
        
        ,
      
    
    {\displaystyle {\frac {\partial \mathbf {y} }{\partial \mathbf {x} }},}
  
 we should lay out the gradient 
  
    
      
        
          
            
              ∂
              y
            
            
              ∂
              
                x
              
            
          
        
      
    
    {\displaystyle {\frac {\partial y}{\partial \mathbf {x} }}}
  
 as a row vector, and 
  
    
      
        
          
            
              ∂
              
                y
              
            
            
              ∂
              x
            
          
        
      
    
    {\displaystyle {\frac {\partial \mathbf {y} }{\partial x}}}
  
 as a column vector.
If we choose denominator layout for 
  
    
      
        
          
            
              ∂
              
                y
              
            
            
              ∂
              
                x
              
            
          
        
        ,
      
    
    {\displaystyle {\frac {\partial \mathbf {y} }{\partial \mathbf {x} }},}
  
 we should lay out the gradient 
  
    
      
        
          
            
              ∂
              y
            
            
              ∂
              
                x
              
            
          
        
      
    
    {\displaystyle {\frac {\partial y}{\partial \mathbf {x} }}}
  
 as a column vector, and 
  
    
      
        
          
            
              ∂
              
                y
              
            
            
              ∂
              x
            
          
        
      
    
    {\displaystyle {\frac {\partial \mathbf {y} }{\partial x}}}
  
 as a row vector.
In the third possibility above, we write 
  
    
      
        
          
            
              ∂
              y
            
            
              ∂
              
                
                  x
                
                ′
              
            
          
        
      
    
    {\displaystyle {\frac {\partial y}{\partial \mathbf {x} '}}}
  
 and 
  
    
      
        
          
            
              ∂
              
                y
              
            
            
              ∂
              x
            
          
        
        ,
      
    
    {\displaystyle {\frac {\partial \mathbf {y} }{\partial x}},}
  
 and use numerator layout.
Not all math textbooks and papers are consistent in this respect throughout. That is, sometimes different conventions are used in different contexts within the same book or paper. For example, some choose denominator layout for gradients (laying them out as column vectors), but numerator layout for the vector-by-vector derivative 
  
    
      
        
          
            
              ∂
              
                y
              
            
            
              ∂
              
                x
              
            
          
        
        .
      
    
    {\displaystyle {\frac {\partial \mathbf {y} }{\partial \mathbf {x} }}.}
  

Similarly, when it comes to scalar-by-matrix derivatives 
  
    
      
        
          
            
              ∂
              y
            
            
              ∂
              
                X
              
            
          
        
      
    
    {\displaystyle {\frac {\partial y}{\partial \mathbf {X} }}}
  
 and matrix-by-scalar derivatives 
  
    
      
        
          
            
              ∂
              
                Y
              
            
            
              ∂
              x
            
          
        
        ,
      
    
    {\displaystyle {\frac {\partial \mathbf {Y} }{\partial x}},}
  
 then consistent numerator layout lays out according to Y and XT, while consistent denominator layout lays out according to YT and X.  In practice, however, following a denominator layout for 
  
    
      
        
          
            
              ∂
              
                Y
              
            
            
              ∂
              x
            
          
        
        ,
      
    
    {\displaystyle {\frac {\partial \mathbf {Y} }{\partial x}},}
  
 and laying the result out according to YT, is rarely seen because it makes for ugly formulas that do not correspond to the scalar formulas.  As a result, the following layouts can often be found:

Consistent numerator layout, which lays out 
  
    
      
        
          
            
              ∂
              
                Y
              
            
            
              ∂
              x
            
          
        
      
    
    {\displaystyle {\frac {\partial \mathbf {Y} }{\partial x}}}
  
 according to Y and 
  
    
      
        
          
            
              ∂
              y
            
            
              ∂
              
                X
              
            
          
        
      
    
    {\displaystyle {\frac {\partial y}{\partial \mathbf {X} }}}
  
 according to XT.
Mixed layout, which lays out 
  
    
      
        
          
            
              ∂
              
                Y
              
            
            
              ∂
              x
            
          
        
      
    
    {\displaystyle {\frac {\partial \mathbf {Y} }{\partial x}}}
  
 according to Y and 
  
    
      
        
          
            
              ∂
              y
            
            
              ∂
              
                X
              
            
          
        
      
    
    {\displaystyle {\frac {\partial y}{\partial \mathbf {X} }}}
  
 according to X.
Use the notation 
  
    
      
        
          
            
              ∂
              y
            
            
              ∂
              
                
                  X
                
                ′
              
            
          
        
        ,
      
    
    {\displaystyle {\frac {\partial y}{\partial \mathbf {X} '}},}
  
 with results the same as consistent numerator layout.
In the following formulas, we handle the five possible combinations 
  
    
      
        
          
            
              ∂
              y
            
            
              ∂
              
                x
              
            
          
        
        ,
        
          
            
              ∂
              
                y
              
            
            
              ∂
              x
            
          
        
        ,
        
          
            
              ∂
              
                y
              
            
            
              ∂
              
                x
              
            
          
        
        ,
        
          
            
              ∂
              y
            
            
              ∂
              
                X
              
            
          
        
      
    
    {\displaystyle {\frac {\partial y}{\partial \mathbf {x} }},{\frac {\partial \mathbf {y} }{\partial x}},{\frac {\partial \mathbf {y} }{\partial \mathbf {x} }},{\frac {\partial y}{\partial \mathbf {X} }}}
  
 and 
  
    
      
        
          
            
              ∂
              
                Y
              
            
            
              ∂
              x
            
          
        
      
    
    {\displaystyle {\frac {\partial \mathbf {Y} }{\partial x}}}
  
 separately.  We also handle cases of scalar-by-scalar derivatives that involve an intermediate vector or matrix. (This can arise, for example, if a multi-dimensional parametric curve is defined in terms of a scalar variable, and then a derivative of a scalar function of the curve is taken with respect to the scalar that parameterizes the curve.) For each of the various combinations, we give numerator-layout and denominator-layout results, except in the cases above where denominator layout rarely occurs. In cases involving matrices where it makes sense, we give numerator-layout and mixed-layout results.  As noted above, cases where vector and matrix denominators are written in transpose notation are equivalent to numerator layout with the denominators written without the transpose.
Keep in mind that various authors use different combinations of numerator and denominator layouts for different types of derivatives, and there is no guarantee that an author will consistently use either numerator or denominator layout for all types.  Match up the formulas below with those quoted in the source to determine the layout used for that particular type of derivative, but be careful not to assume that derivatives of other types necessarily follow the same kind of layout.
When taking derivatives with an aggregate (vector or matrix) denominator in order to find a maximum or minimum of the aggregate, it should be kept in mind that using numerator layout will produce results that are transposed with respect to the aggregate.  For example, in attempting to find the maximum likelihood estimate of a multivariate normal distribution using matrix calculus, if the domain is a k×1 column vector, then the result using the numerator layout will be in the form of a 1×k row vector. Thus, either the results should be transposed at the end or the denominator layout (or mixed layout) should be used.

The results of operations will be transposed when switching between numerator-layout and denominator-layout notation.


=== Numerator-layout notation ===
Using numerator-layout notation, we have:

  
    
      
        
          
            
              
                
                  
                    
                      ∂
                      y
                    
                    
                      ∂
                      
                        x
                      
                    
                  
                
              
              
                
                =
                
                  
                    [
                    
                      
                        
                          
                            
                              
                                ∂
                                y
                              
                              
                                ∂
                                
                                  x
                                  
                                    1
                                  
                                
                              
                            
                          
                        
                        
                          
                            
                              
                                ∂
                                y
                              
                              
                                ∂
                                
                                  x
                                  
                                    2
                                  
                                
                              
                            
                          
                        
                        
                          ⋯
                        
                        
                          
                            
                              
                                ∂
                                y
                              
                              
                                ∂
                                
                                  x
                                  
                                    n
                                  
                                
                              
                            
                          
                        
                      
                    
                    ]
                  
                
                .
              
            
            
              
                
                  
                    
                      ∂
                      
                        y
                      
                    
                    
                      ∂
                      x
                    
                  
                
              
              
                
                =
                
                  
                    [
                    
                      
                        
                          
                            
                              
                                ∂
                                
                                  y
                                  
                                    1
                                  
                                
                              
                              
                                ∂
                                x
                              
                            
                          
                        
                      
                      
                        
                          
                            
                              
                                ∂
                                
                                  y
                                  
                                    2
                                  
                                
                              
                              
                                ∂
                                x
                              
                            
                          
                        
                      
                      
                        
                          ⋮
                        
                      
                      
                        
                          
                            
                              
                                ∂
                                
                                  y
                                  
                                    m
                                  
                                
                              
                              
                                ∂
                                x
                              
                            
                          
                        
                      
                    
                    ]
                  
                
                .
              
            
            
              
                
                  
                    
                      ∂
                      
                        y
                      
                    
                    
                      ∂
                      
                        x
                      
                    
                  
                
              
              
                
                =
                
                  
                    [
                    
                      
                        
                          
                            
                              
                                ∂
                                
                                  y
                                  
                                    1
                                  
                                
                              
                              
                                ∂
                                
                                  x
                                  
                                    1
                                  
                                
                              
                            
                          
                        
                        
                          
                            
                              
                                ∂
                                
                                  y
                                  
                                    1
                                  
                                
                              
                              
                                ∂
                                
                                  x
                                  
                                    2
                                  
                                
                              
                            
                          
                        
                        
                          ⋯
                        
                        
                          
                            
                              
                                ∂
                                
                                  y
                                  
                                    1
                                  
                                
                              
                              
                                ∂
                                
                                  x
                                  
                                    n
                                  
                                
                              
                            
                          
                        
                      
                      
                        
                          
                            
                              
                                ∂
                                
                                  y
                                  
                                    2
                                  
                                
                              
                              
                                ∂
                                
                                  x
                                  
                                    1
                                  
                                
                              
                            
                          
                        
                        
                          
                            
                              
                                ∂
                                
                                  y
                                  
                                    2
                                  
                                
                              
                              
                                ∂
                                
                                  x
                                  
                                    2
                                  
                                
                              
                            
                          
                        
                        
                          ⋯
                        
                        
                          
                            
                              
                                ∂
                                
                                  y
                                  
                                    2
                                  
                                
                              
                              
                                ∂
                                
                                  x
                                  
                                    n
                                  
                                
                              
                            
                          
                        
                      
                      
                        
                          ⋮
                        
                        
                          ⋮
                        
                        
                          ⋱
                        
                        
                          ⋮
                        
                      
                      
                        
                          
                            
                              
                                ∂
                                
                                  y
                                  
                                    m
                                  
                                
                              
                              
                                ∂
                                
                                  x
                                  
                                    1
                                  
                                
                              
                            
                          
                        
                        
                          
                            
                              
                                ∂
                                
                                  y
                                  
                                    m
                                  
                                
                              
                              
                                ∂
                                
                                  x
                                  
                                    2
                                  
                                
                              
                            
                          
                        
                        
                          ⋯
                        
                        
                          
                            
                              
                                ∂
                                
                                  y
                                  
                                    m
                                  
                                
                              
                              
                                ∂
                                
                                  x
                                  
                                    n
                                  
                                
                              
                            
                          
                        
                      
                    
                    ]
                  
                
                .
              
            
            
              
                
                  
                    
                      ∂
                      y
                    
                    
                      ∂
                      
                        X
                      
                    
                  
                
              
              
                
                =
                
                  
                    [
                    
                      
                        
                          
                            
                              
                                ∂
                                y
                              
                              
                                ∂
                                
                                  x
                                  
                                    11
                                  
                                
                              
                            
                          
                        
                        
                          
                            
                              
                                ∂
                                y
                              
                              
                                ∂
                                
                                  x
                                  
                                    21
                                  
                                
                              
                            
                          
                        
                        
                          ⋯
                        
                        
                          
                            
                              
                                ∂
                                y
                              
                              
                                ∂
                                
                                  x
                                  
                                    p
                                    1
                                  
                                
                              
                            
                          
                        
                      
                      
                        
                          
                            
                              
                                ∂
                                y
                              
                              
                                ∂
                                
                                  x
                                  
                                    12
                                  
                                
                              
                            
                          
                        
                        
                          
                            
                              
                                ∂
                                y
                              
                              
                                ∂
                                
                                  x
                                  
                                    22
                                  
                                
                              
                            
                          
                        
                        
                          ⋯
                        
                        
                          
                            
                              
                                ∂
                                y
                              
                              
                                ∂
                                
                                  x
                                  
                                    p
                                    2
                                  
                                
                              
                            
                          
                        
                      
                      
                        
                          ⋮
                        
                        
                          ⋮
                        
                        
                          ⋱
                        
                        
                          ⋮
                        
                      
                      
                        
                          
                            
                              
                                ∂
                                y
                              
                              
                                ∂
                                
                                  x
                                  
                                    1
                                    q
                                  
                                
                              
                            
                          
                        
                        
                          
                            
                              
                                ∂
                                y
                              
                              
                                ∂
                                
                                  x
                                  
                                    2
                                    q
                                  
                                
                              
                            
                          
                        
                        
                          ⋯
                        
                        
                          
                            
                              
                                ∂
                                y
                              
                              
                                ∂
                                
                                  x
                                  
                                    p
                                    q
                                  
                                
                              
                            
                          
                        
                      
                    
                    ]
                  
                
                .
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}{\frac {\partial y}{\partial \mathbf {x} }}&={\begin{bmatrix}{\frac {\partial y}{\partial x_{1}}}&{\frac {\partial y}{\partial x_{2}}}&\cdots &{\frac {\partial y}{\partial x_{n}}}\end{bmatrix}}.\\{\frac {\partial \mathbf {y} }{\partial x}}&={\begin{bmatrix}{\frac {\partial y_{1}}{\partial x}}\\{\frac {\partial y_{2}}{\partial x}}\\\vdots \\{\frac {\partial y_{m}}{\partial x}}\\\end{bmatrix}}.\\{\frac {\partial \mathbf {y} }{\partial \mathbf {x} }}&={\begin{bmatrix}{\frac {\partial y_{1}}{\partial x_{1}}}&{\frac {\partial y_{1}}{\partial x_{2}}}&\cdots &{\frac {\partial y_{1}}{\partial x_{n}}}\\{\frac {\partial y_{2}}{\partial x_{1}}}&{\frac {\partial y_{2}}{\partial x_{2}}}&\cdots &{\frac {\partial y_{2}}{\partial x_{n}}}\\\vdots &\vdots &\ddots &\vdots \\{\frac {\partial y_{m}}{\partial x_{1}}}&{\frac {\partial y_{m}}{\partial x_{2}}}&\cdots &{\frac {\partial y_{m}}{\partial x_{n}}}\\\end{bmatrix}}.\\{\frac {\partial y}{\partial \mathbf {X} }}&={\begin{bmatrix}{\frac {\partial y}{\partial x_{11}}}&{\frac {\partial y}{\partial x_{21}}}&\cdots &{\frac {\partial y}{\partial x_{p1}}}\\{\frac {\partial y}{\partial x_{12}}}&{\frac {\partial y}{\partial x_{22}}}&\cdots &{\frac {\partial y}{\partial x_{p2}}}\\\vdots &\vdots &\ddots &\vdots \\{\frac {\partial y}{\partial x_{1q}}}&{\frac {\partial y}{\partial x_{2q}}}&\cdots &{\frac {\partial y}{\partial x_{pq}}}\\\end{bmatrix}}.\end{aligned}}}
  

The following definitions are only provided in numerator-layout notation:

  
    
      
        
          
            
              
                
                  
                    
                      ∂
                      
                        Y
                      
                    
                    
                      ∂
                      x
                    
                  
                
              
              
                
                =
                
                  
                    [
                    
                      
                        
                          
                            
                              
                                ∂
                                
                                  y
                                  
                                    11
                                  
                                
                              
                              
                                ∂
                                x
                              
                            
                          
                        
                        
                          
                            
                              
                                ∂
                                
                                  y
                                  
                                    12
                                  
                                
                              
                              
                                ∂
                                x
                              
                            
                          
                        
                        
                          ⋯
                        
                        
                          
                            
                              
                                ∂
                                
                                  y
                                  
                                    1
                                    n
                                  
                                
                              
                              
                                ∂
                                x
                              
                            
                          
                        
                      
                      
                        
                          
                            
                              
                                ∂
                                
                                  y
                                  
                                    21
                                  
                                
                              
                              
                                ∂
                                x
                              
                            
                          
                        
                        
                          
                            
                              
                                ∂
                                
                                  y
                                  
                                    22
                                  
                                
                              
                              
                                ∂
                                x
                              
                            
                          
                        
                        
                          ⋯
                        
                        
                          
                            
                              
                                ∂
                                
                                  y
                                  
                                    2
                                    n
                                  
                                
                              
                              
                                ∂
                                x
                              
                            
                          
                        
                      
                      
                        
                          ⋮
                        
                        
                          ⋮
                        
                        
                          ⋱
                        
                        
                          ⋮
                        
                      
                      
                        
                          
                            
                              
                                ∂
                                
                                  y
                                  
                                    m
                                    1
                                  
                                
                              
                              
                                ∂
                                x
                              
                            
                          
                        
                        
                          
                            
                              
                                ∂
                                
                                  y
                                  
                                    m
                                    2
                                  
                                
                              
                              
                                ∂
                                x
                              
                            
                          
                        
                        
                          ⋯
                        
                        
                          
                            
                              
                                ∂
                                
                                  y
                                  
                                    m
                                    n
                                  
                                
                              
                              
                                ∂
                                x
                              
                            
                          
                        
                      
                    
                    ]
                  
                
                .
              
            
            
              
                d
                
                  X
                
              
              
                
                =
                
                  
                    [
                    
                      
                        
                          d
                          
                            x
                            
                              11
                            
                          
                        
                        
                          d
                          
                            x
                            
                              12
                            
                          
                        
                        
                          ⋯
                        
                        
                          d
                          
                            x
                            
                              1
                              n
                            
                          
                        
                      
                      
                        
                          d
                          
                            x
                            
                              21
                            
                          
                        
                        
                          d
                          
                            x
                            
                              22
                            
                          
                        
                        
                          ⋯
                        
                        
                          d
                          
                            x
                            
                              2
                              n
                            
                          
                        
                      
                      
                        
                          ⋮
                        
                        
                          ⋮
                        
                        
                          ⋱
                        
                        
                          ⋮
                        
                      
                      
                        
                          d
                          
                            x
                            
                              m
                              1
                            
                          
                        
                        
                          d
                          
                            x
                            
                              m
                              2
                            
                          
                        
                        
                          ⋯
                        
                        
                          d
                          
                            x
                            
                              m
                              n
                            
                          
                        
                      
                    
                    ]
                  
                
                .
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}{\frac {\partial \mathbf {Y} }{\partial x}}&={\begin{bmatrix}{\frac {\partial y_{11}}{\partial x}}&{\frac {\partial y_{12}}{\partial x}}&\cdots &{\frac {\partial y_{1n}}{\partial x}}\\{\frac {\partial y_{21}}{\partial x}}&{\frac {\partial y_{22}}{\partial x}}&\cdots &{\frac {\partial y_{2n}}{\partial x}}\\\vdots &\vdots &\ddots &\vdots \\{\frac {\partial y_{m1}}{\partial x}}&{\frac {\partial y_{m2}}{\partial x}}&\cdots &{\frac {\partial y_{mn}}{\partial x}}\\\end{bmatrix}}.\\d\mathbf {X} &={\begin{bmatrix}dx_{11}&dx_{12}&\cdots &dx_{1n}\\dx_{21}&dx_{22}&\cdots &dx_{2n}\\\vdots &\vdots &\ddots &\vdots \\dx_{m1}&dx_{m2}&\cdots &dx_{mn}\\\end{bmatrix}}.\end{aligned}}}
  


=== Denominator-layout notation ===
Using denominator-layout notation, we have:

  
    
      
        
          
            
              
                
                  
                    
                      ∂
                      y
                    
                    
                      ∂
                      
                        x
                      
                    
                  
                
              
              
                
                =
                
                  
                    [
                    
                      
                        
                          
                            
                              
                                ∂
                                y
                              
                              
                                ∂
                                
                                  x
                                  
                                    1
                                  
                                
                              
                            
                          
                        
                      
                      
                        
                          
                            
                              
                                ∂
                                y
                              
                              
                                ∂
                                
                                  x
                                  
                                    2
                                  
                                
                              
                            
                          
                        
                      
                      
                        
                          ⋮
                        
                      
                      
                        
                          
                            
                              
                                ∂
                                y
                              
                              
                                ∂
                                
                                  x
                                  
                                    n
                                  
                                
                              
                            
                          
                        
                      
                    
                    ]
                  
                
                .
              
            
            
              
                
                  
                    
                      ∂
                      
                        y
                      
                    
                    
                      ∂
                      x
                    
                  
                
              
              
                
                =
                
                  
                    [
                    
                      
                        
                          
                            
                              
                                ∂
                                
                                  y
                                  
                                    1
                                  
                                
                              
                              
                                ∂
                                x
                              
                            
                          
                        
                        
                          
                            
                              
                                ∂
                                
                                  y
                                  
                                    2
                                  
                                
                              
                              
                                ∂
                                x
                              
                            
                          
                        
                        
                          ⋯
                        
                        
                          
                            
                              
                                ∂
                                
                                  y
                                  
                                    m
                                  
                                
                              
                              
                                ∂
                                x
                              
                            
                          
                        
                      
                    
                    ]
                  
                
                .
              
            
            
              
                
                  
                    
                      ∂
                      
                        y
                      
                    
                    
                      ∂
                      
                        x
                      
                    
                  
                
              
              
                
                =
                
                  
                    [
                    
                      
                        
                          
                            
                              
                                ∂
                                
                                  y
                                  
                                    1
                                  
                                
                              
                              
                                ∂
                                
                                  x
                                  
                                    1
                                  
                                
                              
                            
                          
                        
                        
                          
                            
                              
                                ∂
                                
                                  y
                                  
                                    2
                                  
                                
                              
                              
                                ∂
                                
                                  x
                                  
                                    1
                                  
                                
                              
                            
                          
                        
                        
                          ⋯
                        
                        
                          
                            
                              
                                ∂
                                
                                  y
                                  
                                    m
                                  
                                
                              
                              
                                ∂
                                
                                  x
                                  
                                    1
                                  
                                
                              
                            
                          
                        
                      
                      
                        
                          
                            
                              
                                ∂
                                
                                  y
                                  
                                    1
                                  
                                
                              
                              
                                ∂
                                
                                  x
                                  
                                    2
                                  
                                
                              
                            
                          
                        
                        
                          
                            
                              
                                ∂
                                
                                  y
                                  
                                    2
                                  
                                
                              
                              
                                ∂
                                
                                  x
                                  
                                    2
                                  
                                
                              
                            
                          
                        
                        
                          ⋯
                        
                        
                          
                            
                              
                                ∂
                                
                                  y
                                  
                                    m
                                  
                                
                              
                              
                                ∂
                                
                                  x
                                  
                                    2
                                  
                                
                              
                            
                          
                        
                      
                      
                        
                          ⋮
                        
                        
                          ⋮
                        
                        
                          ⋱
                        
                        
                          ⋮
                        
                      
                      
                        
                          
                            
                              
                                ∂
                                
                                  y
                                  
                                    1
                                  
                                
                              
                              
                                ∂
                                
                                  x
                                  
                                    n
                                  
                                
                              
                            
                          
                        
                        
                          
                            
                              
                                ∂
                                
                                  y
                                  
                                    2
                                  
                                
                              
                              
                                ∂
                                
                                  x
                                  
                                    n
                                  
                                
                              
                            
                          
                        
                        
                          ⋯
                        
                        
                          
                            
                              
                                ∂
                                
                                  y
                                  
                                    m
                                  
                                
                              
                              
                                ∂
                                
                                  x
                                  
                                    n
                                  
                                
                              
                            
                          
                        
                      
                    
                    ]
                  
                
                .
              
            
            
              
                
                  
                    
                      ∂
                      y
                    
                    
                      ∂
                      
                        X
                      
                    
                  
                
              
              
                
                =
                
                  
                    [
                    
                      
                        
                          
                            
                              
                                ∂
                                y
                              
                              
                                ∂
                                
                                  x
                                  
                                    11
                                  
                                
                              
                            
                          
                        
                        
                          
                            
                              
                                ∂
                                y
                              
                              
                                ∂
                                
                                  x
                                  
                                    12
                                  
                                
                              
                            
                          
                        
                        
                          ⋯
                        
                        
                          
                            
                              
                                ∂
                                y
                              
                              
                                ∂
                                
                                  x
                                  
                                    1
                                    q
                                  
                                
                              
                            
                          
                        
                      
                      
                        
                          
                            
                              
                                ∂
                                y
                              
                              
                                ∂
                                
                                  x
                                  
                                    21
                                  
                                
                              
                            
                          
                        
                        
                          
                            
                              
                                ∂
                                y
                              
                              
                                ∂
                                
                                  x
                                  
                                    22
                                  
                                
                              
                            
                          
                        
                        
                          ⋯
                        
                        
                          
                            
                              
                                ∂
                                y
                              
                              
                                ∂
                                
                                  x
                                  
                                    2
                                    q
                                  
                                
                              
                            
                          
                        
                      
                      
                        
                          ⋮
                        
                        
                          ⋮
                        
                        
                          ⋱
                        
                        
                          ⋮
                        
                      
                      
                        
                          
                            
                              
                                ∂
                                y
                              
                              
                                ∂
                                
                                  x
                                  
                                    p
                                    1
                                  
                                
                              
                            
                          
                        
                        
                          
                            
                              
                                ∂
                                y
                              
                              
                                ∂
                                
                                  x
                                  
                                    p
                                    2
                                  
                                
                              
                            
                          
                        
                        
                          ⋯
                        
                        
                          
                            
                              
                                ∂
                                y
                              
                              
                                ∂
                                
                                  x
                                  
                                    p
                                    q
                                  
                                
                              
                            
                          
                        
                      
                    
                    ]
                  
                
                .
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}{\frac {\partial y}{\partial \mathbf {x} }}&={\begin{bmatrix}{\frac {\partial y}{\partial x_{1}}}\\{\frac {\partial y}{\partial x_{2}}}\\\vdots \\{\frac {\partial y}{\partial x_{n}}}\\\end{bmatrix}}.\\{\frac {\partial \mathbf {y} }{\partial x}}&={\begin{bmatrix}{\frac {\partial y_{1}}{\partial x}}&{\frac {\partial y_{2}}{\partial x}}&\cdots &{\frac {\partial y_{m}}{\partial x}}\end{bmatrix}}.\\{\frac {\partial \mathbf {y} }{\partial \mathbf {x} }}&={\begin{bmatrix}{\frac {\partial y_{1}}{\partial x_{1}}}&{\frac {\partial y_{2}}{\partial x_{1}}}&\cdots &{\frac {\partial y_{m}}{\partial x_{1}}}\\{\frac {\partial y_{1}}{\partial x_{2}}}&{\frac {\partial y_{2}}{\partial x_{2}}}&\cdots &{\frac {\partial y_{m}}{\partial x_{2}}}\\\vdots &\vdots &\ddots &\vdots \\{\frac {\partial y_{1}}{\partial x_{n}}}&{\frac {\partial y_{2}}{\partial x_{n}}}&\cdots &{\frac {\partial y_{m}}{\partial x_{n}}}\\\end{bmatrix}}.\\{\frac {\partial y}{\partial \mathbf {X} }}&={\begin{bmatrix}{\frac {\partial y}{\partial x_{11}}}&{\frac {\partial y}{\partial x_{12}}}&\cdots &{\frac {\partial y}{\partial x_{1q}}}\\{\frac {\partial y}{\partial x_{21}}}&{\frac {\partial y}{\partial x_{22}}}&\cdots &{\frac {\partial y}{\partial x_{2q}}}\\\vdots &\vdots &\ddots &\vdots \\{\frac {\partial y}{\partial x_{p1}}}&{\frac {\partial y}{\partial x_{p2}}}&\cdots &{\frac {\partial y}{\partial x_{pq}}}\\\end{bmatrix}}.\end{aligned}}}
  


== Identities ==
As noted above, in general, the results of operations will be transposed when switching between numerator-layout and denominator-layout notation.
To help make sense of all the identities below, keep in mind the most important rules: the chain rule, product rule and sum rule.  The sum rule applies universally, and the product rule applies in most of the cases below, provided that the order of matrix products is maintained, since matrix products are not commutative.  The chain rule applies in some of the cases, but unfortunately does not apply in matrix-by-scalar derivatives or scalar-by-matrix derivatives (in the latter case, mostly involving the trace operator applied to matrices).  In the latter case, the product rule can't quite be applied directly, either, but the equivalent can be done with a bit more work using the differential identities.
The following identities adopt the following conventions:

the scalars, a, b, c, d, and e are constant in respect of, and the scalars, u, and v are functions of one of x, x, or X;
the vectors, a, b, c, d, and e are constant in respect of, and the vectors, u, and v are functions of one of x, x, or X;
the matrices, A, B, C, D, and E are constant in respect of, and the matrices, U and V are functions of one of x, x, or X.


=== Vector-by-vector identities ===
This is presented first because all of the operations that apply to vector-by-vector differentiation apply directly to vector-by-scalar or scalar-by-vector differentiation simply by reducing the appropriate vector in the numerator or denominator to a scalar.


=== Scalar-by-vector identities ===
The fundamental identities are placed above the thick black line.


=== Vector-by-scalar identities ===

NOTE: The formulas involving the vector-by-vector derivatives 
  
    
      
        
          
            
              ∂
              
                g
              
              (
              
                u
              
              )
            
            
              ∂
              
                u
              
            
          
        
      
    
    {\displaystyle {\frac {\partial \mathbf {g} (\mathbf {u} )}{\partial \mathbf {u} }}}
  
 and 
  
    
      
        
          
            
              ∂
              
                f
              
              (
              
                g
              
              )
            
            
              ∂
              
                g
              
            
          
        
      
    
    {\displaystyle {\frac {\partial \mathbf {f} (\mathbf {g} )}{\partial \mathbf {g} }}}
  
 (whose outputs are matrices) assume the matrices are laid out consistent with the vector layout, i.e. numerator-layout matrix when numerator-layout vector and vice versa; otherwise, transpose the vector-by-vector derivatives.


=== Scalar-by-matrix identities ===
Note that exact equivalents of the scalar product rule and chain rule do not exist when applied to matrix-valued functions of matrices.  However, the product rule of this sort does apply to the differential form (see below), and this is the way to derive many of the identities below involving the trace function, combined with the fact that the trace function allows transposing and cyclic permutation, i.e.:

  
    
      
        
          
            
              
                tr
                ⁡
                (
                
                  A
                
                )
              
              
                
                =
                tr
                ⁡
                
                  (
                  
                    
                      A
                      
                        ⊤
                      
                    
                  
                  )
                
              
            
            
              
                tr
                ⁡
                (
                
                  A
                  B
                  C
                  D
                
                )
              
              
                
                =
                tr
                ⁡
                (
                
                  B
                  C
                  D
                  A
                
                )
                =
                tr
                ⁡
                (
                
                  C
                  D
                  A
                  B
                
                )
                =
                tr
                ⁡
                (
                
                  D
                  A
                  B
                  C
                
                )
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}\operatorname {tr} (\mathbf {A} )&=\operatorname {tr} \left(\mathbf {A^{\top }} \right)\\\operatorname {tr} (\mathbf {ABCD} )&=\operatorname {tr} (\mathbf {BCDA} )=\operatorname {tr} (\mathbf {CDAB} )=\operatorname {tr} (\mathbf {DABC} )\end{aligned}}}
  

For example, to compute 
  
    
      
        
          
            
              ∂
              tr
              ⁡
              (
              
                A
                X
                B
                
                  X
                  
                    ⊤
                  
                
                C
              
              )
            
            
              ∂
              
                X
              
            
          
        
        :
      
    
    {\displaystyle {\frac {\partial \operatorname {tr} (\mathbf {AXBX^{\top }C} )}{\partial \mathbf {X} }}:}
  

  
    
      
        
          
            
              
                d
                tr
                ⁡
                (
                
                  A
                  X
                  B
                  
                    X
                    
                      ⊤
                    
                  
                  C
                
                )
              
              
                
                =
                d
                tr
                ⁡
                
                  (
                  
                    C
                    A
                    X
                    B
                    
                      X
                      
                        ⊤
                      
                    
                  
                  )
                
                =
                tr
                ⁡
                
                  (
                  
                    d
                    
                      (
                      
                        C
                        A
                        X
                        B
                        
                          X
                          
                            ⊤
                          
                        
                      
                      )
                    
                  
                  )
                
              
            
            
              
              
                
                =
                tr
                ⁡
                
                  (
                  
                    
                      C
                      A
                      X
                    
                    d
                    (
                    
                      B
                      
                        X
                        
                          ⊤
                        
                      
                    
                  
                  )
                
                +
                d
                
                  (
                  
                    
                      C
                      A
                      X
                    
                    )
                    
                      B
                      
                        X
                        
                          ⊤
                        
                      
                    
                  
                  )
                
              
            
            
              
              
                
                =
                tr
                ⁡
                
                  (
                  
                    
                      C
                      A
                      X
                    
                    d
                    
                      (
                      
                        B
                        
                          X
                          
                            ⊤
                          
                        
                      
                      )
                    
                  
                  )
                
                +
                tr
                ⁡
                
                  (
                  
                    d
                    (
                    
                      C
                      A
                      X
                    
                    )
                    
                      B
                      
                        X
                        
                          ⊤
                        
                      
                    
                  
                  )
                
              
            
            
              
              
                
                =
                tr
                ⁡
                
                  (
                  
                    
                      C
                      A
                      X
                      B
                    
                    d
                    
                      (
                      
                        
                          X
                          
                            ⊤
                          
                        
                      
                      )
                    
                  
                  )
                
                +
                tr
                ⁡
                
                  (
                  
                    
                      C
                      A
                    
                    (
                    d
                    
                      X
                    
                    )
                    
                      B
                      
                        X
                        
                          ⊤
                        
                      
                    
                  
                  )
                
              
            
            
              
              
                
                =
                tr
                ⁡
                
                  (
                  
                    
                      C
                      A
                      X
                      B
                    
                    (
                    d
                    
                      X
                    
                    
                      )
                      
                        ⊤
                      
                    
                  
                  )
                
                +
                tr
                ⁡
                (
                
                  C
                  A
                
                
                  (
                  
                    d
                    
                      X
                    
                    )
                    
                      B
                      
                        X
                        
                          ⊤
                        
                      
                    
                  
                  )
                
              
            
            
              
              
                
                =
                tr
                ⁡
                
                  (
                  
                    
                      (
                      
                        
                          C
                          A
                          X
                          B
                        
                        (
                        d
                        
                          X
                        
                        
                          )
                          
                            ⊤
                          
                        
                      
                      )
                    
                    
                      ⊤
                    
                  
                  )
                
                +
                tr
                ⁡
                
                  (
                  
                    
                      C
                      A
                    
                    (
                    d
                    
                      X
                    
                    )
                    
                      B
                      
                        X
                        
                          ⊤
                        
                      
                    
                  
                  )
                
              
            
            
              
              
                
                =
                tr
                ⁡
                
                  (
                  
                    (
                    d
                    
                      X
                    
                    )
                    
                      
                        B
                        
                          ⊤
                        
                      
                      
                        X
                        
                          ⊤
                        
                      
                      
                        A
                        
                          ⊤
                        
                      
                      
                        C
                        
                          ⊤
                        
                      
                    
                  
                  )
                
                +
                tr
                ⁡
                
                  (
                  
                    
                      C
                      A
                    
                    (
                    d
                    
                      X
                    
                    )
                    
                      B
                      
                        X
                        
                          ⊤
                        
                      
                    
                  
                  )
                
              
            
            
              
              
                
                =
                tr
                ⁡
                
                  (
                  
                    
                      
                        B
                        
                          ⊤
                        
                      
                      
                        X
                        
                          ⊤
                        
                      
                      
                        A
                        
                          ⊤
                        
                      
                      
                        C
                        
                          ⊤
                        
                      
                    
                    (
                    d
                    
                      X
                    
                    )
                  
                  )
                
                +
                tr
                ⁡
                
                  (
                  
                    
                      B
                      
                        X
                        
                          ⊤
                        
                      
                    
                    
                      C
                      A
                    
                    (
                    d
                    
                      X
                    
                    )
                  
                  )
                
              
            
            
              
              
                
                =
                tr
                ⁡
                
                  (
                  
                    
                      (
                      
                        
                          
                            B
                            
                              ⊤
                            
                          
                          
                            X
                            
                              ⊤
                            
                          
                          
                            A
                            
                              ⊤
                            
                          
                          
                            C
                            
                              ⊤
                            
                          
                        
                        +
                        
                          B
                          
                            X
                            
                              ⊤
                            
                          
                        
                        
                          C
                          A
                        
                      
                      )
                    
                    d
                    
                      X
                    
                  
                  )
                
              
            
            
              
              
                
                =
                tr
                ⁡
                
                  (
                  
                    
                      
                        (
                        
                          
                            C
                            A
                            X
                            B
                          
                          +
                          
                            
                              A
                              
                                ⊤
                              
                            
                            
                              C
                              
                                ⊤
                              
                            
                            X
                            
                              B
                              
                                ⊤
                              
                            
                          
                        
                        )
                      
                      
                        ⊤
                      
                    
                    d
                    
                      X
                    
                  
                  )
                
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}d\operatorname {tr} (\mathbf {AXBX^{\top }C} )&=d\operatorname {tr} \left(\mathbf {CAXBX^{\top }} \right)=\operatorname {tr} \left(d\left(\mathbf {CAXBX^{\top }} \right)\right)\\[1ex]&=\operatorname {tr} \left(\mathbf {CAX} d(\mathbf {BX^{\top }} \right)+d\left(\mathbf {CAX} )\mathbf {BX^{\top }} \right)\\[1ex]&=\operatorname {tr} \left(\mathbf {CAX} d\left(\mathbf {BX^{\top }} \right)\right)+\operatorname {tr} \left(d(\mathbf {CAX} )\mathbf {BX^{\top }} \right)\\[1ex]&=\operatorname {tr} \left(\mathbf {CAXB} d\left(\mathbf {X^{\top }} \right)\right)+\operatorname {tr} \left(\mathbf {CA} (d\mathbf {X} )\mathbf {BX^{\top }} \right)\\[1ex]&=\operatorname {tr} \left(\mathbf {CAXB} (d\mathbf {X} )^{\top }\right)+\operatorname {tr} (\mathbf {CA} \left(d\mathbf {X} )\mathbf {BX^{\top }} \right)\\[1ex]&=\operatorname {tr} \left(\left(\mathbf {CAXB} (d\mathbf {X} )^{\top }\right)^{\top }\right)+\operatorname {tr} \left(\mathbf {CA} (d\mathbf {X} )\mathbf {BX^{\top }} \right)\\[1ex]&=\operatorname {tr} \left((d\mathbf {X} )\mathbf {B^{\top }X^{\top }A^{\top }C^{\top }} \right)+\operatorname {tr} \left(\mathbf {CA} (d\mathbf {X} )\mathbf {BX^{\top }} \right)\\[1ex]&=\operatorname {tr} \left(\mathbf {B^{\top }X^{\top }A^{\top }C^{\top }} (d\mathbf {X} )\right)+\operatorname {tr} \left(\mathbf {BX^{\top }} \mathbf {CA} (d\mathbf {X} )\right)\\[1ex]&=\operatorname {tr} \left(\left(\mathbf {B^{\top }X^{\top }A^{\top }C^{\top }} +\mathbf {BX^{\top }} \mathbf {CA} \right)d\mathbf {X} \right)\\[1ex]&=\operatorname {tr} \left(\left(\mathbf {CAXB} +\mathbf {A^{\top }C^{\top }XB^{\top }} \right)^{\top }d\mathbf {X} \right)\end{aligned}}}
  

Therefore,

  
    
      
        
          
            
              ∂
              tr
              ⁡
              
                (
                
                  A
                  X
                  B
                  
                    X
                    
                      ⊤
                    
                  
                  C
                
                )
              
            
            
              ∂
              
                X
              
            
          
        
        =
        
          
            B
            
              ⊤
            
          
          
            X
            
              ⊤
            
          
          
            A
            
              ⊤
            
          
          
            C
            
              ⊤
            
          
        
        +
        
          B
          
            X
            
              ⊤
            
          
          C
          A
        
        .
      
    
    {\displaystyle {\frac {\partial \operatorname {tr} \left(\mathbf {AXBX^{\top }C} \right)}{\partial \mathbf {X} }}=\mathbf {B^{\top }X^{\top }A^{\top }C^{\top }} +\mathbf {BX^{\top }CA} .}
  
 (numerator layout)

  
    
      
        
          
            
              ∂
              tr
              ⁡
              
                (
                
                  A
                  X
                  B
                  
                    X
                    
                      ⊤
                    
                  
                  C
                
                )
              
            
            
              ∂
              
                X
              
            
          
        
        =
        
          C
          A
          X
          B
        
        +
        
          
            A
            
              ⊤
            
          
          
            C
            
              ⊤
            
          
          X
          
            B
            
              ⊤
            
          
        
        .
      
    
    {\displaystyle {\frac {\partial \operatorname {tr} \left(\mathbf {AXBX^{\top }C} \right)}{\partial \mathbf {X} }}=\mathbf {CAXB} +\mathbf {A^{\top }C^{\top }XB^{\top }} .}
  
 (denominator layout)
(For the last step, see the Conversion from differential to derivative form section.)


=== Matrix-by-scalar identities ===


=== Scalar-by-scalar identities ===


==== With vectors involved ====


==== With matrices involved ====


=== Identities in differential form ===
It is often easier to work in differential form and then convert back to normal derivatives.  This only works well using the numerator layout. In these rules, a is a scalar.

In the last row, 
  
    
      
        
          δ
          
            i
            j
          
        
      
    
    {\displaystyle \delta _{ij}}
  
 is the Kronecker delta and 
  
    
      
        (
        
          
            P
          
          
            k
          
        
        
          )
          
            i
            j
          
        
        =
        (
        
          Q
        
        
          )
          
            i
            k
          
        
        (
        
          
            Q
          
          
            −
            1
          
        
        
          )
          
            k
            j
          
        
      
    
    {\displaystyle (\mathbf {P} _{k})_{ij}=(\mathbf {Q} )_{ik}(\mathbf {Q} ^{-1})_{kj}}
  
 is the set of orthogonal projection operators that project onto the k-th eigenvector of X.
Q is the matrix of eigenvectors of 
  
    
      
        
          X
        
        =
        
          Q
        
        
          Λ
        
        
          
            Q
          
          
            −
            1
          
        
      
    
    {\displaystyle \mathbf {X} =\mathbf {Q} {\boldsymbol {\Lambda }}\mathbf {Q} ^{-1}}
  
, and 
  
    
      
        (
        
          Λ
        
        
          )
          
            i
            i
          
        
        =
        
          λ
          
            i
          
        
      
    
    {\displaystyle ({\boldsymbol {\Lambda }})_{ii}=\lambda _{i}}
  
 are the eigenvalues.
The matrix function 
  
    
      
        f
        (
        
          X
        
        )
      
    
    {\displaystyle f(\mathbf {X} )}
  
 is defined in terms of the scalar function 
  
    
      
        f
        (
        x
        )
      
    
    {\displaystyle f(x)}
  
 for diagonalizable matrices by 
  
    
      
        f
        (
        
          X
        
        )
        =
        
          ∑
          
            i
          
        
        f
        (
        
          λ
          
            i
          
        
        )
        
          
            P
          
          
            i
          
        
      
    
    {\textstyle f(\mathbf {X} )=\sum _{i}f(\lambda _{i})\mathbf {P} _{i}}
  
 where 
  
    
      
        
          X
        
        =
        
          ∑
          
            i
          
        
        
          λ
          
            i
          
        
        
          
            P
          
          
            i
          
        
      
    
    {\textstyle \mathbf {X} =\sum _{i}\lambda _{i}\mathbf {P} _{i}}
  
 with 
  
    
      
        
          
            P
          
          
            i
          
        
        
          
            P
          
          
            j
          
        
        =
        
          δ
          
            i
            j
          
        
        
          
            P
          
          
            i
          
        
      
    
    {\displaystyle \mathbf {P} _{i}\mathbf {P} _{j}=\delta _{ij}\mathbf {P} _{i}}
  
.
To convert to normal derivative form, first convert it to one of the following canonical forms, and then use these identities:


== Applications ==
Matrix differential calculus is used in statistics and econometrics, particularly for the statistical analysis of multivariate distributions, especially the multivariate normal distribution and other elliptical distributions.
It is used in regression analysis to compute, for example, the ordinary least squares regression formula for the case of multiple explanatory variables.
It is also used in random matrices, statistical moments, local sensitivity and statistical diagnostics.


== See also ==

Derivative (generalizations)
Product integral
Ricci calculus
Tensor derivative


== Notes ==


== References ==


== Further reading ==


== External links ==


=== Software ===
MatrixCalculus.org, a website for evaluating matrix calculus expressions symbolically
NCAlgebra, an open-source Mathematica package that has some matrix calculus functionality
SymPy supports symbolic matrix derivatives in its matrix expression module, as well as symbolic tensor derivatives in its array expression module.
Tensorgrad, an open-source python package for matrix calculus. Supports general symbolic tensor derivatives using Penrose graphical notation.


=== Information ===
Matrix Reference Manual, Mike Brookes, Imperial College London.
Matrix Differentiation (and some other stuff), Randal J. Barnes, Department of Civil Engineering, University of Minnesota.
Notes on Matrix Calculus, Paul L. Fackler, North Carolina State University.
Matrix Differential Calculus Archived 2012-09-16 at the Wayback Machine (slide presentation), Zhang Le, University of Edinburgh.
Introduction to Vector and Matrix Differentiation (notes on matrix differentiation, in the context of Econometrics), Heino Bohn Nielsen.
A note on differentiating matrices (notes on matrix differentiation), Pawel Koval, from Munich Personal RePEc Archive.
Vector/Matrix Calculus More notes on matrix differentiation.
Matrix Identities (notes on matrix differentiation), Sam Roweis.
Tensor Cookbook Matrix Calculus using Tensor Diagrams.