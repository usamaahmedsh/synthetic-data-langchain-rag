In physics, the n-body problem is the problem of predicting the individual motions of a group of celestial objects interacting with each other gravitationally. Solving this problem has been motivated by the desire to understand the motions of the Sun, Moon, planets, and visible stars.
The classical physical problem can be stated as follows:

Each particle in a system of a finite number of particles is subjected to a Newtonian gravitational attraction from all the other particles, and to no other forces. If the initial state of the system is given, how will the particles move?
The two-body problem has been completely solved and is discussed below. For three or more bodies the problem can only be solved completely in particular cases. In general, the problem is chaotic and can only be solved numerically.
The n-body problem in general relativity is considerably more difficult to solve.


== History ==
Knowing three orbital positions of a planet's orbit – positions obtained by Sir Isaac Newton from astronomer John Flamsteed – Newton was able to produce an equation by straightforward analytical geometry, to predict a planet's motion; i.e., to give its orbital properties: position, orbital diameter, period and orbital velocity. Having done so, he and others soon discovered over the course of a few years, those equations of motion did not predict some orbits correctly or even very well. Newton realized that this was because gravitational interactive forces amongst all the planets were affecting all their orbits.
The aforementioned revelation strikes directly at the core of what the n-body issue physically is: as Newton understood, it is not enough to just provide the beginning location and velocity, or even three orbital positions, in order to establish a planet's actual orbit; one must also be aware of the gravitational interaction forces. Thus came the awareness and rise of the n-body "problem" in the early 17th century. These gravitational attractive forces do conform to Newton's laws of motion and to his law of universal gravitation, but the many multiple (n-body) interactions have historically made any exact solution intractable. Ironically, this conformity led to the wrong approach.
After Newton's time the n-body problem historically was not stated correctly because it did not include a reference to those gravitational interactive forces. Newton does not say it directly but implies in his Principia the n-body problem is unsolvable because of those gravitational interactive forces. Newton said in his Principia, paragraph 21:

And hence it is that the attractive force is found in both bodies. The Sun attracts Jupiter and the other planets, Jupiter attracts its satellites and similarly the satellites act on one another. And although the actions of each of a pair of planets on the other can be distinguished from each other and can be considered as two actions by which each attracts the other, yet inasmuch as they are between the same, two bodies they are not two but a simple operation between two termini. Two bodies can be drawn to each other by the contraction of rope between them. The cause of the action is twofold, namely the disposition of each of the two bodies; the action is likewise twofold, insofar as it is upon two bodies; but insofar as it is between two bodies it is single and one ...
Newton concluded via his third law of motion that "according to this Law all bodies must attract each other." This last statement, which implies the existence of gravitational interactive forces, is key.
As shown below, the problem also conforms to Jean Le Rond D'Alembert's non-Newtonian first and second Principles and to the nonlinear n-body problem algorithm, the latter allowing for a closed form solution for calculating those interactive forces.
The problem of finding the general solution of the n-body problem was considered very important and challenging. Indeed, in the late 19th century King Oscar II of Sweden, advised by Gösta Mittag-Leffler, established a prize for anyone who could find the solution to the problem. The announcement was quite specific:

Given a system of arbitrarily many mass points that attract each according to Newton's law, under the assumption that no two points ever collide, try to find a representation of the coordinates of each point as a series in a variable that is some known function of time and for all of whose values the series converges uniformly.
In case the problem could not be solved, any other important contribution to classical mechanics would then be considered to be prizeworthy. The prize was awarded to Poincaré, even though he did not solve the original problem. (The first version of his contribution even contained a serious error.) The version finally printed contained many important ideas which led to the development of chaos theory. The problem as stated originally was finally solved by Karl Fritiof Sundman for n = 3 and generalized to n > 3 by L. K. Babadzanjanz and Qiudong Wang.


== General formulation ==
The n-body problem considers n point masses mi, i = 1, 2, ..., n in an inertial reference frame in three dimensional space 
  
    
      
        
          
            R
          
          
            3
          
        
      
    
    {\displaystyle \mathbb {R} ^{3}}
  
 moving under the influence of mutual gravitational attraction. Each mass mi has a position vector qi. Newton's second law says that mass times acceleration mi ⁠d2qi/dt2⁠ is equal to the sum of the forces on the mass. Newton's law of gravity says that the gravitational force felt on mass mi by a single mass mj is given by

  
    
      
        
          
            F
          
          
            i
            j
          
        
        =
        
          
            
              G
              
                m
                
                  i
                
              
              
                m
                
                  j
                
              
            
            
              
                ‖
                
                  
                    
                      q
                    
                    
                      j
                    
                  
                  −
                  
                    
                      q
                    
                    
                      i
                    
                  
                
                ‖
              
              
                2
              
            
          
        
        ⋅
        
          
            
              (
              
                
                  
                    q
                  
                  
                    j
                  
                
                −
                
                  
                    q
                  
                  
                    i
                  
                
              
              )
            
            
              ‖
              
                
                  
                    q
                  
                  
                    j
                  
                
                −
                
                  
                    q
                  
                  
                    i
                  
                
              
              ‖
            
          
        
        =
        
          
            
              G
              
                m
                
                  i
                
              
              
                m
                
                  j
                
              
              
                (
                
                  
                    
                      q
                    
                    
                      j
                    
                  
                  −
                  
                    
                      q
                    
                    
                      i
                    
                  
                
                )
              
            
            
              
                ‖
                
                  
                    
                      q
                    
                    
                      j
                    
                  
                  −
                  
                    
                      q
                    
                    
                      i
                    
                  
                
                ‖
              
              
                3
              
            
          
        
        ,
      
    
    {\displaystyle \mathbf {F} _{ij}={\frac {Gm_{i}m_{j}}{\left\|\mathbf {q} _{j}-\mathbf {q} _{i}\right\|^{2}}}\cdot {\frac {\left(\mathbf {q} _{j}-\mathbf {q} _{i}\right)}{\left\|\mathbf {q} _{j}-\mathbf {q} _{i}\right\|}}={\frac {Gm_{i}m_{j}\left(\mathbf {q} _{j}-\mathbf {q} _{i}\right)}{\left\|\mathbf {q} _{j}-\mathbf {q} _{i}\right\|^{3}}},}
  

where G is the gravitational constant and ‖qj − qi‖ is the magnitude of the distance between qi and qj (metric induced by the l2 norm).

Summing over all masses yields the n-body equations of motion:where U is the self-potential energy

  
    
      
        U
        =
        −
        
          ∑
          
            1
            ≤
            i
            <
            j
            ≤
            n
          
        
        
          
            
              G
              
                m
                
                  i
                
              
              
                m
                
                  j
                
              
            
            
              ‖
              
                
                  
                    q
                  
                  
                    j
                  
                
                −
                
                  
                    q
                  
                  
                    i
                  
                
              
              ‖
            
          
        
        .
      
    
    {\displaystyle U=-\sum _{1\leq i<j\leq n}{\frac {Gm_{i}m_{j}}{\left\|\mathbf {q} _{j}-\mathbf {q} _{i}\right\|}}.}
  

Defining the momentum to be pi = mi ⁠dqi/dt⁠, Hamilton's equations of motion for the n-body problem become

  
    
      
        
          
            
              d
              
                
                  q
                
                
                  i
                
              
            
            
              d
              t
            
          
        
        =
        
          
            
              ∂
              H
            
            
              ∂
              
                
                  p
                
                
                  i
                
              
            
          
        
        
        
          
            
              d
              
                
                  p
                
                
                  i
                
              
            
            
              d
              t
            
          
        
        =
        −
        
          
            
              ∂
              H
            
            
              ∂
              
                
                  q
                
                
                  i
                
              
            
          
        
        ,
      
    
    {\displaystyle {\frac {d\mathbf {q} _{i}}{dt}}={\frac {\partial H}{\partial \mathbf {p} _{i}}}\qquad {\frac {d\mathbf {p} _{i}}{dt}}=-{\frac {\partial H}{\partial \mathbf {q} _{i}}},}
  

where the Hamiltonian function is

  
    
      
        H
        =
        T
        +
        U
      
    
    {\displaystyle H=T+U}
  

and T is the kinetic energy

  
    
      
        T
        =
        
          ∑
          
            i
            =
            1
          
          
            n
          
        
        
          
            
              
                ‖
                
                  
                    p
                  
                  
                    i
                  
                
                ‖
              
              
                2
              
            
            
              2
              
                m
                
                  i
                
              
            
          
        
        .
      
    
    {\displaystyle T=\sum _{i=1}^{n}{\frac {\left\|\mathbf {p} _{i}\right\|^{2}}{2m_{i}}}.}
  

Hamilton's equations show that the n-body problem is a system of 6n first-order differential equations, with 6n initial conditions as 3n initial position coordinates and 3n initial momentum values.
Symmetries in the n-body problem yield global integrals of motion that simplify the problem. Translational symmetry of the problem results in the center of mass

  
    
      
        
          C
        
        =
        
          
            
              
                ∑
                
                  i
                  =
                  1
                
                
                  n
                
              
              
                m
                
                  i
                
              
              
                
                  q
                
                
                  i
                
              
            
            
              
                ∑
                
                  i
                  =
                  1
                
                
                  n
                
              
              
                m
                
                  i
                
              
            
          
        
      
    
    {\displaystyle \mathbf {C} ={\frac {\displaystyle \sum _{i=1}^{n}m_{i}\mathbf {q} _{i}}{\displaystyle \sum _{i=1}^{n}m_{i}}}}
  

moving with constant velocity, so that C = L0t + C0, where L0 is the linear velocity and C0 is the initial position. The constants of motion L0 and C0 represent six integrals of the motion. Rotational symmetry results in the total angular momentum being constant

  
    
      
        
          A
        
        =
        
          ∑
          
            i
            =
            1
          
          
            n
          
        
        
          
            q
          
          
            i
          
        
        ×
        
          
            p
          
          
            i
          
        
        ,
      
    
    {\displaystyle \mathbf {A} =\sum _{i=1}^{n}\mathbf {q} _{i}\times \mathbf {p} _{i},}
  

where × is the cross product. The three components of the total angular momentum A yield three more constants of the motion. The last general constant of the motion is given by the conservation of energy H. Hence, every n-body problem has ten integrals of motion.
Because T and U are homogeneous functions of degree 2 and −1, respectively, the equations of motion have a scaling invariance: if qi(t) is a solution, then so is λ−2/3qi(λt) for any λ > 0.
The moment of inertia of an n-body system is given by

  
    
      
        I
        =
        
          ∑
          
            i
            =
            1
          
          
            n
          
        
        
          m
          
            i
          
        
        
          
            q
          
          
            i
          
        
        ⋅
        
          
            q
          
          
            i
          
        
        =
        
          ∑
          
            i
            =
            1
          
          
            n
          
        
        
          m
          
            i
          
        
        
          
            ‖
            
              
                q
              
              
                i
              
            
            ‖
          
          
            2
          
        
      
    
    {\displaystyle I=\sum _{i=1}^{n}m_{i}\mathbf {q} _{i}\cdot \mathbf {q} _{i}=\sum _{i=1}^{n}m_{i}\left\|\mathbf {q} _{i}\right\|^{2}}
  

and the virial is given by Q = ⁠1/2⁠ ⁠dI/dt⁠. Then the Lagrange–Jacobi formula states that

  
    
      
        
          
            
              
                d
                
                  2
                
              
              I
            
            
              d
              
                t
                
                  2
                
              
            
          
        
        =
        2
        T
        −
        U
        .
      
    
    {\displaystyle {\frac {d^{2}I}{dt^{2}}}=2T-U.}
  

For systems in dynamic equilibrium, the longterm time average of ⟨⁠d2I/dt2⁠⟩ is zero. Then on average the total kinetic energy is half the total potential energy, ⟨T⟩ = ⁠1/2⁠⟨U⟩, which is an example of the virial theorem for gravitational systems. If M is the total mass and R a characteristic size of the system (for example, the radius containing half the mass of the system), then the critical time for a system to settle down to a dynamic equilibrium is

  
    
      
        
          t
          
            
              c
              r
            
          
        
        =
        
          
            (
            
              
                
                  G
                  M
                
                
                  R
                  
                    3
                  
                
              
            
            )
          
          
            −
            1
            
              /
            
            2
          
        
        .
      
    
    {\displaystyle t_{\mathrm {cr} }=\left({\frac {GM}{R^{3}}}\right)^{-1/2}.}
  


== Special cases ==


=== Two-body problem ===

Any discussion of planetary interactive forces has always started historically with the two-body problem. The purpose of this section is to relate the real complexity in calculating any planetary forces. Note in this Section also, several subjects, such as gravity, barycenter, Kepler's Laws, etc.; and in the following Section too (Three-body problem) are discussed on other Wikipedia pages. Here though, these subjects are discussed from the perspective of the n-body problem.
The two-body problem (n = 2) was first solved by Isaac Newton in 1687 using geometric methods, but a complete solution was given in 1710 by Johann Bernoulli (1667–1748) by classical theory by assuming the main point-mass was fixed; this is outlined here. Consider then the motion of two bodies, say the Sun and the Earth, with the Sun fixed, then:

  
    
      
        
          
            
              
                
                  m
                  
                    1
                  
                
                
                  
                    a
                  
                  
                    1
                  
                
              
              
                
                =
                
                  
                    
                      G
                      
                        m
                        
                          1
                        
                      
                      
                        m
                        
                          2
                        
                      
                    
                    
                      r
                      
                        12
                      
                      
                        3
                      
                    
                  
                
                (
                
                  
                    r
                  
                  
                    2
                  
                
                −
                
                  
                    r
                  
                  
                    1
                  
                
                )
              
              
              
                
                
                  Sun–Earth
                
              
            
            
              
                
                  m
                  
                    2
                  
                
                
                  
                    a
                  
                  
                    2
                  
                
              
              
                
                =
                
                  
                    
                      G
                      
                        m
                        
                          1
                        
                      
                      
                        m
                        
                          2
                        
                      
                    
                    
                      r
                      
                        21
                      
                      
                        3
                      
                    
                  
                
                (
                
                  
                    r
                  
                  
                    1
                  
                
                −
                
                  
                    r
                  
                  
                    2
                  
                
                )
              
              
              
                
                
                  Earth–Sun
                
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}m_{1}\mathbf {a} _{1}&={\frac {Gm_{1}m_{2}}{r_{12}^{3}}}(\mathbf {r} _{2}-\mathbf {r} _{1})&&\quad {\text{Sun–Earth}}\\m_{2}\mathbf {a} _{2}&={\frac {Gm_{1}m_{2}}{r_{21}^{3}}}(\mathbf {r} _{1}-\mathbf {r} _{2})&&\quad {\text{Earth–Sun}}\end{aligned}}}
  

The equation describing the motion of mass m2 relative to mass m1 is readily obtained from the differences between these two equations and after canceling common terms gives: 

  
    
      
        
          α
        
        +
        
          
            η
            
              r
              
                3
              
            
          
        
        
          r
        
        =
        
          0
        
      
    
    {\displaystyle \mathbf {\alpha } +{\frac {\eta }{r^{3}}}\mathbf {r} =\mathbf {0} }
  

Where

r = r2 − r1 is the vector position of m2 relative to m1;
α is the Eulerian acceleration ⁠d2r/dt2⁠;
η = G(m1 + m2).
The equation α + ⁠η/r3⁠r = 0 is the fundamental differential equation for the two-body problem Bernoulli solved in 1734. Notice for this approach forces have to be determined first, then the equation of motion resolved. This differential equation has elliptic, or parabolic or hyperbolic solutions.
It is incorrect to think of m1 (the Sun) as fixed in space when applying Newton's law of universal gravitation, and to do so leads to erroneous results. The fixed point for two isolated gravitationally interacting bodies is their mutual barycenter, and this two-body problem can be solved exactly, such as using Jacobi coordinates relative to the barycenter.
Dr. Clarence Cleminshaw calculated the approximate position of the Solar System's barycenter, a result achieved mainly by combining only the masses of Jupiter and the Sun. Science Program stated in reference to his work:

The Sun contains 98 per cent of the mass in the solar system, with the superior planets beyond Mars accounting for most of the rest. On the average, the center of the mass of the Sun–Jupiter system, when the two most massive objects are considered alone, lies 462,000 miles from the Sun's center, or some 30,000 miles above the solar surface! Other large planets also influence the center of mass of the solar system, however. In 1951, for example, the systems' center of mass was not far from the Sun's center because Jupiter was on the opposite side from Saturn, Uranus and Neptune. In the late 1950s, when all four of these planets were on the same side of the Sun, the system's center of mass was more than 330,000 miles from the solar surface, Dr. C. H. Cleminshaw of Griffith Observatory in Los Angeles has calculated.

The Sun wobbles as it rotates around the Galactic Center, dragging the Solar System and Earth along with it. What mathematician Kepler did in arriving at his three famous equations was curve-fit the apparent motions of the planets using Tycho Brahe's data, and not curve-fitting their true circular motions about the Sun (see figure). Both Robert Hooke and Newton were well aware that Newton's Law of Universal Gravitation did not hold for the forces associated with elliptical orbits. In fact, Newton's Universal Law does not account for the orbit of Mercury, the asteroid belt's gravitational behavior, or Saturn's rings. Newton stated (in section 11 of the Principia) that the main reason, however, for failing to predict the forces for elliptical orbits was that his math model was for a body confined to a situation that hardly existed in the real world, namely, the motions of bodies attracted toward an unmoving center. Some present physics and astronomy textbooks do not emphasize the negative significance of Newton's assumption and end up teaching that his mathematical model is in effect reality. It is to be understood that the classical two-body problem solution above is a mathematical idealization. See also Kepler's first law of planetary motion.


=== Three-body problem ===

This section relates a historically important n-body problem solution after simplifying assumptions were made.
In the past not much was known about the n-body problem for n ≥ 3. The case n = 3 has been the most studied. Many earlier attempts to understand the three-body problem were quantitative, aiming at finding explicit solutions for special situations.

In 1687, Isaac Newton published in the Principia the first steps in the study of the problem of the movements of three bodies subject to their mutual gravitational attractions, but his efforts resulted in verbal descriptions and geometrical sketches; see especially Book 1, Proposition 66 and its corollaries (Newton, 1687 and 1999 (transl.), see also Tisserand, 1894).
In 1767, Euler found collinear motions, in which three bodies of any masses move proportionately along a fixed straight line. The Euler's three-body problem is the special case in which two of the bodies are fixed in space (this should not be confused with the circular restricted three-body problem, in which the two massive bodies describe a circular orbit and are only fixed in a synodic reference frame).
In 1772, Lagrange discovered two classes of periodic solution, each for three bodies of any masses. In one class, the bodies lie on a rotating straight line. In the other class, the bodies lie at the vertices of a rotating equilateral triangle. In either case, the paths of the bodies will be conic sections. Those solutions led to the study of central configurations, for which q̈ = kq for some constant k > 0.
A major study of the Earth–Moon–Sun system was undertaken by Charles-Eugène Delaunay, who published two volumes on the topic, each of 900 pages in length, in 1860 and 1867. Among many other accomplishments, the work already hints at chaos, and clearly demonstrates the problem of so-called "small denominators" in perturbation theory.
In 1917, Forest Ray Moulton published his now classic, An Introduction to Celestial Mechanics (see references) with its plot of the restricted three-body problem solution (see figure below). An aside, see Meirovitch's book, pages 413–414 for his restricted three-body problem solution.

Moulton's solution may be easier to visualize (and definitely easier to solve) if one considers the more massive body (such as the Sun) to be stationary in space, and the less massive body (such as Jupiter) to orbit around it, with the equilibrium points (Lagrangian points) maintaining the 60° spacing ahead of, and behind, the less massive body almost in its orbit (although in reality neither of the bodies are truly stationary, as they both orbit the center of mass of the whole system—about the barycenter). For sufficiently small mass ratio of the primaries, these triangular equilibrium points are stable, such that (nearly) massless particles will orbit about these points as they orbit around the larger primary (Sun). The five equilibrium points of the circular problem are known as the Lagrangian points. See figure below:

In the restricted three-body problem math model figure above (after Moulton), the Lagrangian points L4 and L5 are where the Trojan planetoids resided (see Lagrangian point); m1 is the Sun and m2 is Jupiter. L2 is a point within the asteroid belt. It has to be realized for this model, this whole Sun-Jupiter diagram is rotating about its barycenter. The restricted three-body problem solution predicted the Trojan planetoids before they were first seen. The h-circles and closed loops echo the electromagnetic fluxes issued from the Sun and Jupiter. It is conjectured, contrary to Richard H. Batin's conjecture (see References), the two h1 are gravity sinks, in and where gravitational forces are zero, and the reason the Trojan planetoids are trapped there. The total amount of mass of the planetoids is unknown.
The restricted three-body problem assumes the mass of one of the bodies is negligible. For a discussion of the case where the negligible body is a satellite of the body of lesser mass, see Hill sphere; for binary systems, see Roche lobe. Specific solutions to the three-body problem result in chaotic motion with no obvious sign of a repetitious path.
The restricted problem (both circular and elliptical) was worked on extensively by many famous mathematicians and physicists, most notably by Poincaré at the end of the 19th century. Poincaré's work on the restricted three-body problem was the foundation of deterministic chaos theory. In the restricted problem, there exist five equilibrium points. Three are collinear with the masses (in the rotating frame) and are unstable. The remaining two are located on the third vertex of both equilateral triangles of which the two bodies are the first and second vertices.


=== Four-body problem ===
Inspired by the circular restricted three-body problem, the four-body problem can be greatly simplified by considering a smaller body to have a small mass compared to the other three massive bodies, which in turn are approximated to describe circular orbits. This is known as the bicircular restricted four-body problem (also known as bicircular model) and it can be traced back to 1960 in a NASA report written by Su-Shu Huang. This formulation has been highly relevant in the astrodynamics, mainly to model spacecraft trajectories in the Earth-Moon system with the addition of the gravitational attraction of the Sun. The former formulation of the bicircular restricted four-body problem can be problematic when modelling other systems than the Earth-Moon-Sun, so the formulation was generalized by Negri and Prado to expand the application range and improve the accuracy without loss of simplicity.


=== Planetary problem ===
The planetary problem is the n-body problem in the case that one of the masses is much larger than all the others. A prototypical example of a planetary problem is the Sun–Jupiter–Saturn system, where the mass of the Sun is about 1000 times larger than the masses of Jupiter or Saturn. An approximate solution to the problem is to decompose it into n − 1 pairs of star–planet Kepler problems, treating interactions among the planets as perturbations. Perturbative approximation works well as long as there are no orbital resonances in the system, that is none of the ratios of unperturbed Kepler frequencies is a rational number. Resonances appear as small denominators in the expansion.
The existence of resonances and small denominators led to the important question of stability in the planetary problem: do planets, in nearly circular orbits around a star, remain in stable or bounded orbits over time? In 1963, Vladimir Arnold proved using KAM theory a kind of stability of the planetary problem: there exists a set of positive measure of quasiperiodic orbits in the case of the planetary problem restricted to the plane. In the KAM theory, chaotic planetary orbits would be bounded by quasiperiodic KAM tori. Arnold's result was extended to a more general theorem by Féjoz and Herman in 2004.


=== Central configurations ===

A central configuration q1(0), …, qN(0) is an initial configuration such that if the particles were all released with zero velocity, they would all collapse toward the center of mass C. Such a motion is called homothetic. Central configurations may also give rise to homographic motions in which all masses moves along Keplerian trajectories (elliptical, circular, parabolic, or hyperbolic), with all trajectories having the same eccentricity e. For elliptical trajectories, e = 1 corresponds to homothetic motion and e = 0 gives a relative equilibrium motion in which the configuration remains an isometry of the initial configuration, as if the configuration was a rigid body. Central configurations have played an important role in understanding the topology of invariant manifolds created by fixing the first integrals of a system.


=== n-body choreography ===

Solutions in which all masses move on the same curve without collisions are called choreographies. A choreography for n = 3 was discovered by Lagrange in 1772 in which three bodies are situated at the vertices of an equilateral triangle in the rotating frame. A figure eight choreography for n = 3 was found numerically by C. Moore in 1993 and generalized and proven by A. Chenciner and R. Montgomery in 2000. Since then, many other choreographies have been found for n ≥ 3.


== Analytic approaches ==
For every solution of the problem, not only applying an isometry or a time shift but also a reversal of time (unlike in the case of friction) gives a solution as well.
In the physical literature about the n-body problem (n ≥ 3), sometimes reference is made to "the impossibility of solving the n-body problem" (via employing the above approach). However, care must be taken when discussing the 'impossibility' of a solution, as this refers only to the method of first integrals (compare the theorems by Abel and Galois about the impossibility of solving algebraic equations of degree five or higher by means of formulas only involving roots).


=== Power series solution ===
One way of solving the classical n-body problem is "the n-body problem by Taylor series".
We start by defining the system of differential equations:

  
    
      
        
          
            
              
                d
                
                  2
                
              
              
                
                  x
                
                
                  i
                
              
              (
              t
              )
            
            
              d
              
                t
                
                  2
                
              
            
          
        
        =
        G
        
          ∑
          
            
              
                k
                =
                1
              
              
                k
                ≠
                i
              
            
          
          
            n
          
        
        
          
            
              
                m
                
                  k
                
              
              
                (
                
                  
                    
                      x
                    
                    
                      k
                    
                  
                  (
                  t
                  )
                  −
                  
                    
                      x
                    
                    
                      i
                    
                  
                  (
                  t
                  )
                
                )
              
            
            
              
                |
                
                  
                    
                      x
                    
                    
                      k
                    
                  
                  (
                  t
                  )
                  −
                  
                    
                      x
                    
                    
                      i
                    
                  
                  (
                  t
                  )
                
                |
              
              
                3
              
            
          
        
        ,
      
    
    {\displaystyle {\frac {d^{2}\mathbf {x} _{i}(t)}{dt^{2}}}=G\sum _{k=1 \atop k\neq i}^{n}{\frac {m_{k}\left(\mathbf {x} _{k}(t)-\mathbf {x} _{i}(t)\right)}{\left|\mathbf {x} _{k}(t)-\mathbf {x} _{i}(t)\right|^{3}}},}
  

As xi(t0) and ⁠dxi(t0)/dt⁠ are given as initial conditions, every ⁠d2xi(t)/dt2⁠ is known. Differentiating ⁠d2xi(t)/dt2⁠ results in ⁠d3xi(t)/dt3⁠ which at t0 which is also known, and the Taylor series is constructed iteratively.


=== A generalized Sundman global solution ===
In order to generalize Sundman's result for the case n > 3 (or n = 3 and c = 0) one has to face two obstacles:

As has been shown by Siegel, collisions which involve more than two bodies cannot be regularized analytically, hence Sundman's regularization cannot be generalized.
The structure of singularities is more complicated in this case: other types of singularities may occur (see below).
Lastly, Sundman's result was generalized to the case of n > 3 bodies by Qiudong Wang in the 1990s. Since the structure of singularities is more complicated, Wang had to leave out completely the questions of singularities. The central point of his approach is to transform, in an appropriate manner, the equations to a new system, such that the interval of existence for the solutions of this new system is [0,∞).


=== Singularities of the n-body problem ===
There can be two types of singularities of the n-body problem:

collisions of two or more bodies, but for which q(t) (the bodies' positions) remains finite. (In this mathematical sense, a "collision" means that two pointlike bodies have identical positions in space.)
singularities in which a collision does not occur, but q(t) does not remain finite. In this scenario, bodies diverge to infinity in a finite time, while at the same time tending towards zero separation (an imaginary collision occurs "at infinity").
The latter ones are called Painlevé's conjecture (no-collisions singularities). Their existence has been conjectured for n > 3 by Painlevé (see Painlevé conjecture). Examples of this behavior for n = 5 have been constructed by Xia and a heuristic model for n = 4 by Gerver. Donald G. Saari has shown that for 4 or fewer bodies, the set of initial data giving rise to singularities has measure zero.


== Simulation ==

While there are analytic solutions available for the classical (i.e. nonrelativistic) two-body problem and for selected configurations with n > 2, in general n-body problems must be solved or simulated using numerical methods.


=== Few bodies ===
For a small number of bodies, an n-body problem can be solved using direct methods, also called particle–particle methods. These methods numerically integrate the differential equations of motion. Numerical integration for this problem can be a challenge for several reasons. First, the gravitational potential is singular; it goes to infinity as the distance between two particles goes to zero. The gravitational potential may be "softened" to remove the singularity at small distances:

  
    
      
        
          U
          
            ε
          
        
        =
        
          ∑
          
            1
            ≤
            i
            <
            j
            ≤
            n
          
        
        
          
            
              G
              
                m
                
                  i
                
              
              
                m
                
                  j
                
              
            
            
              
                
                  ‖
                  
                    
                      
                        q
                      
                      
                        j
                      
                    
                    −
                    
                      
                        q
                      
                      
                        i
                      
                    
                  
                  ‖
                
                
                  2
                
              
              +
              
                ε
                
                  2
                
              
            
          
        
      
    
    {\displaystyle U_{\varepsilon }=\sum _{1\leq i<j\leq n}{\frac {Gm_{i}m_{j}}{\sqrt {\left\|\mathbf {q} _{j}-\mathbf {q} _{i}\right\|^{2}+\varepsilon ^{2}}}}}
  

Second, in general for n > 2, the n-body problem is chaotic, which means that even small errors in integration may grow exponentially in time. Third, a simulation may be over large stretches of model time (e.g. millions of years) and numerical errors accumulate as integration time increases.
There are a number of techniques to reduce errors in numerical integration. Local coordinate systems are used to deal with widely differing scales in some problems, for example an Earth–Moon coordinate system in the context of a solar system simulation. Variational methods and perturbation theory can yield approximate analytic trajectories upon which the numerical integration can be a correction. The use of a symplectic integrator ensures that the simulation obeys Hamilton's equations to a high degree of accuracy and in particular that energy is conserved.


=== Many bodies ===
Direct methods using numerical integration require on the order of ⁠1/2⁠n2 computations to evaluate the potential energy over all pairs of particles, and thus have a time complexity of O(n2). For simulations with many particles, the O(n2) factor makes large-scale calculations especially time-consuming.
A number of approximate methods have been developed that reduce the time complexity relative to direct methods:

Tree code methods, such as a Barnes–Hut simulation, are spatially-hierarchical methods used when distant particle contributions do not need to be computed to high accuracy. The potential of a distant group of particles is computed using a multipole expansion or other approximation of the potential. This allows for a reduction in complexity to O(n log n).
Fast multipole methods take advantage of the fact that the multipole-expanded forces from distant particles are similar for particles close to each other, and uses local expansions of far-field forces to reduce computational effort. It is claimed that this further approximation reduces the complexity to O(n).
Particle mesh methods divide up simulation space into a three dimensional grid onto which the mass density of the particles is interpolated. Then calculating the potential becomes a matter of solving a Poisson equation on the grid, which can be computed in O(n log n) time using fast Fourier transform or O(n) time using multigrid techniques. This can provide fast solutions at the cost of higher error for short-range forces. Adaptive mesh refinement can be used to increase accuracy in regions with large numbers of particles.
P3M and PM-tree methods are hybrid methods that use the particle mesh approximation for distant particles, but use more accurate methods for close particles (within a few grid intervals). P3M stands for particle–particle, particle–mesh and uses direct methods with softened potentials at close range. PM-tree methods instead use tree codes at close range. As with particle mesh methods, adaptive meshes can increase computational efficiency.
Mean field methods approximate the system of particles with a time-dependent Boltzmann equation representing the mass density that is coupled to a self-consistent Poisson equation representing the potential. It is a type of smoothed-particle hydrodynamics approximation suitable for large systems.


=== Strong gravitation ===
In astrophysical systems with strong gravitational fields, such as those near the event horizon of a black hole, n-body simulations must take into account general relativity; such simulations are the domain of numerical relativity. Numerically simulating the Einstein field equations is extremely challenging and a parameterized post-Newtonian formalism (PPN), such as the Einstein–Infeld–Hoffmann equations, is used if possible. The two-body problem in general relativity is analytically solvable only for the Kepler problem, in which one mass is assumed to be much larger than the other.


== Other n-body problems ==
Most work done on the n-body problem has been on the gravitational problem. But there exist other systems for which n-body mathematics and simulation techniques have proven useful.
In large scale electrostatics problems, such as the simulation of proteins and cellular assemblies in structural biology, the Coulomb potential has the same form as the gravitational potential, except that charges may be positive or negative, leading to repulsive as well as attractive forces. Fast Coulomb solvers are the electrostatic counterpart to fast multipole method simulators. These are often used with periodic boundary conditions on the region simulated and Ewald summation techniques are used to speed up computations.
In statistics and machine learning, some models have loss functions of a form similar to that of the gravitational potential: a sum of kernel functions over all pairs of objects, where the kernel function depends on the distance between the objects in parameter space. Example problems that fit into this form include all-nearest-neighbors in manifold learning, kernel density estimation, and kernel machines. Alternative optimizations to reduce the O(n2) time complexity to O(n) have been developed, such as dual tree algorithms, that have applicability to the gravitational n-body problem as well.
A technique in Computational fluid dynamics called Vortex Methods sees the vorticity in a fluid domain discretized onto particles which are then advected with the velocity at their centers. Because the fluid velocity and vorticity are related via a Poisson's equation, the velocity can be solved in the same manner as gravitation and electrostatics: as an n-body summation over all vorticity-containing particles. The summation uses the Biot-Savart law, with vorticity taking the place of electrical current. In the context of particle-laden turbulent multiphase flows, determining an overall disturbance field generated by all particles is an n-body problem. If the particles translating within the flow are much smaller than the flow's Kolmogorov scale, their linear Stokes disturbance fields can be superposed, yielding a system of 3n equations for 3 components of disturbance velocities at the location of n particles.


== See also ==
Celestial mechanics
Gravitational two-body problem
Jacobi integral
Lunar theory
Natural units
Numerical model of the Solar System
Stability of the Solar System
Few-body systems
N-body simulation, a method for numerically obtaining trajectories of bodies in an N-body system.


== Notes ==


== References ==


== Further reading ==


== External links ==