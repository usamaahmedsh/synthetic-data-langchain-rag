In mathematics and physics (more specifically thermodynamics), the heat equation is a parabolic partial differential equation. The theory of the heat equation was first developed by Joseph Fourier in 1822 for the purpose of modeling how a quantity such as heat diffuses through a given region. Since then, the heat equation and its variants have been found to be fundamental in many parts of both pure and applied mathematics.


== Definition ==
Given an open subset U of Rn and a subinterval I of R, one says that a function u : U × I → R is a solution of the heat equation if

  
    
      
        
          
            
              ∂
              u
            
            
              ∂
              t
            
          
        
        =
        
          
            
              
                ∂
                
                  2
                
              
              u
            
            
              ∂
              
                x
                
                  1
                
                
                  2
                
              
            
          
        
        +
        ⋯
        +
        
          
            
              
                ∂
                
                  2
                
              
              u
            
            
              ∂
              
                x
                
                  n
                
                
                  2
                
              
            
          
        
        ,
      
    
    {\displaystyle {\frac {\partial u}{\partial t}}={\frac {\partial ^{2}u}{\partial x_{1}^{2}}}+\cdots +{\frac {\partial ^{2}u}{\partial x_{n}^{2}}},}
  

where (x1, ..., xn, t) denotes a general point of the domain. It is typical to refer to t as time and x1, ..., xn as spatial variables, even in abstract contexts where these phrases fail to have their intuitive meaning. The collection of spatial variables is often referred to simply as x. For any given value of t, the right-hand side of the equation is the Laplacian of the function u(⋅, t) : U → R. As such, the heat equation is often written more compactly as

In physics and engineering contexts, especially in the context of diffusion through a medium, it is more common to fix a Cartesian coordinate system and then to consider the specific case of a function  u(x, y, z, t) of three spatial variables (x, y, z) and time variable t. One then says that u is a solution of the heat equation if

  
    
      
        
          
            
              ∂
              u
            
            
              ∂
              t
            
          
        
        =
        α
        
          (
          
            
              
                
                  
                    ∂
                    
                      2
                    
                  
                  u
                
                
                  ∂
                  
                    x
                    
                      2
                    
                  
                
              
            
            +
            
              
                
                  
                    ∂
                    
                      2
                    
                  
                  u
                
                
                  ∂
                  
                    y
                    
                      2
                    
                  
                
              
            
            +
            
              
                
                  
                    ∂
                    
                      2
                    
                  
                  u
                
                
                  ∂
                  
                    z
                    
                      2
                    
                  
                
              
            
          
          )
        
      
    
    {\displaystyle {\frac {\partial u}{\partial t}}=\alpha \left({\frac {\partial ^{2}u}{\partial x^{2}}}+{\frac {\partial ^{2}u}{\partial y^{2}}}+{\frac {\partial ^{2}u}{\partial z^{2}}}\right)}
  

in which α is a positive coefficient called the thermal diffusivity of the medium. In addition to other physical phenomena, this equation describes the flow of heat in a homogeneous and isotropic medium, with u(x, y, z, t) being the temperature at the point (x, y, z) and time t. If the medium is not homogeneous and isotropic, then α would not be a fixed coefficient, and would instead depend on (x, y, z); the equation would also have a slightly different form. In the physics and engineering literature, it is common to use ∇2 to denote the Laplacian, rather than ∆.
In mathematics as well as in physics and engineering, it is common to use Newton's notation for time derivatives, so that 
  
    
      
        
          
            
              u
              ˙
            
          
        
      
    
    {\displaystyle {\dot {u}}}
  
 is used to denote ⁠∂u/∂t⁠, so the equation can be written

Note also that the ability to use either ∆ or ∇2 to denote the Laplacian, without explicit reference to the spatial variables, is a reflection of the fact that the Laplacian is independent of the choice of coordinate system. In mathematical terms, one would say that the Laplacian is translationally and rotationally invariant. In fact, it is (loosely speaking) the simplest differential operator which has these symmetries. This can be taken as a significant (and purely mathematical) justification of the use of the Laplacian and of the heat equation in modeling any physical phenomena which are homogeneous and isotropic, of which heat diffusion is a principal example.


=== Diffusivity constant ===
The diffusivity constant α is often not present in mathematical studies of the heat equation, while its value can be very important in engineering. This is not a major difference, for the following reason. Let u be a function with

  
    
      
        
          
            
              ∂
              u
            
            
              ∂
              t
            
          
        
        =
        α
        Δ
        u
        .
      
    
    {\displaystyle {\frac {\partial u}{\partial t}}=\alpha \Delta u.}
  

Define a new function 
  
    
      
        v
        (
        t
        ,
        x
        )
        =
        u
        (
        t
        
          /
        
        α
        ,
        x
        )
      
    
    {\displaystyle v(t,x)=u(t/\alpha ,x)}
  
. Then, according to the chain rule, one has

Thus, there is a straightforward way of translating between solutions of the heat equation with a general value of α and solutions of the heat equation with α = 1. As such, for the sake of mathematical analysis, it is often sufficient to only consider the case α = 1. 
Since 
  
    
      
        α
        >
        0
      
    
    {\displaystyle \alpha >0}
  
 there is another option to define a 
  
    
      
        v
      
    
    {\displaystyle v}
  
 satisfying 
  
    
      
        
          
            ∂
            
              ∂
              t
            
          
        
        v
        =
        Δ
        v
      
    
    {\textstyle {\frac {\partial }{\partial t}}v=\Delta v}
  
 as in (⁎) above by setting 
  
    
      
        v
        (
        t
        ,
        x
        )
        =
        u
        (
        t
        ,
        
          α
          
            1
            
              /
            
            2
          
        
        x
        )
      
    
    {\displaystyle v(t,x)=u(t,\alpha ^{1/2}x)}
  
. Note that the two possible means of defining the new function 
  
    
      
        v
      
    
    {\displaystyle v}
  
 discussed here amount, in physical terms, to changing the unit of measure of time or the unit of measure of length.


=== Nonhomogeneous heat equation ===
The nonhomogeneous heat equation is

  
    
      
        
          
            
              ∂
              u
            
            
              ∂
              t
            
          
        
        =
        Δ
        u
        +
        f
      
    
    {\displaystyle {\frac {\partial u}{\partial t}}=\Delta u+f}
  

for a given function 
  
    
      
        f
        =
        f
        (
        x
        ,
        t
        )
      
    
    {\displaystyle f=f(x,t)}
  
 which is allowed to depend on both x and t. The inhomogeneous heat equation models thermal problems in which a heat source modeled by f is switched on. For example, it can be used to model the temperature throughout a room with a heater switched on. If 
  
    
      
        S
        ⊂
        U
      
    
    {\displaystyle S\subset U}
  
 is the region of the room where the heater is and the heater is constantly generating q units of heat per unit of volume, then f would be given by 
  
    
      
        f
        (
        x
        ,
        t
        )
        =
        q
        
          1
          
            S
          
        
        (
        x
        )
      
    
    {\displaystyle f(x,t)=q1_{S}(x)}
  
.


=== Steady-state equation ===
A solution to the heat equation 
  
    
      
        ∂
        u
        
          /
        
        ∂
        t
        =
        Δ
        u
      
    
    {\displaystyle \partial u/\partial t=\Delta u}
  
 is said to be a steady-state solution if it does not vary with respect to time:

  
    
      
        0
        =
        
          
            
              ∂
              u
            
            
              ∂
              t
            
          
        
        =
        Δ
        u
        .
      
    
    {\displaystyle 0={\frac {\partial u}{\partial t}}=\Delta u.}
  

Flowing u via. the heat equation causes it to become closer and closer as time increases to a steady-state solution. For very large time, u is closely approximated by a steady-state solution. A steady state solution of the heat equation is equivalently a solution of Laplace's equation.
Similarly, a solution to the nonhomogeneous heat equation 
  
    
      
        ∂
        u
        
          /
        
        ∂
        t
        =
        Δ
        u
        +
        f
      
    
    {\displaystyle \partial u/\partial t=\Delta u+f}
  
 is said to be a steady-state solution if it does not vary with respect to time:

  
    
      
        0
        =
        
          
            
              ∂
              u
            
            
              ∂
              t
            
          
        
        =
        Δ
        u
        +
        f
        .
      
    
    {\displaystyle 0={\frac {\partial u}{\partial t}}=\Delta u+f.}
  

This is equivalently a solution of Poisson's equation.
In the steady-state case, a nonzero spatial thermal gradient 
  
    
      
        ∇
        u
      
    
    {\displaystyle \nabla u}
  
 may (or may not) be present, but if it is, it does not change in time. The steady-state equation describes the end result in all thermal problems in which a source is switched on (for example, an engine started in an automobile), and enough time has passed for all permanent temperature gradients to establish themselves in space, after which these spatial gradients no longer change in time (as again, with an automobile in which the engine has been running for long enough). The other (trivial) solution is for all spatial temperature gradients to disappear as well, in which case the temperature become uniform in space, as well. The steady-state equations are simpler and can help to understand better the physics of the materials without focusing on the dynamics of heat transport. It is widely used for simple engineering problems assuming there is equilibrium of the temperature fields and heat transport, with time.


== Interpretation ==
Informally, the Laplacian operator ∆ gives the difference between the average value of a function in the neighborhood of a point, and its value at that point.  Thus, if u is the temperature, ∆u conveys if (and by how much) the material surrounding each point is hotter or colder, on the average, than the material at that point.
By the second law of thermodynamics, heat will flow from hotter bodies to adjacent colder bodies, in proportion to the difference of temperature and of the thermal conductivity of the material between them. When heat flows into (respectively, out of) a material, its temperature increases (respectively, decreases), in proportion to the amount of heat divided by the amount (mass) of material, with a proportionality factor called the specific heat capacity of the material.
By the combination of these observations, the heat equation says the rate 
  
    
      
        
          
            
              u
              ˙
            
          
        
      
    
    {\displaystyle {\dot {u}}}
  
 at which the material at a point will heat up (or cool down) is proportional to how much hotter (or cooler) the surrounding material is. The coefficient α in the equation takes into account the thermal conductivity, specific heat, and density of the material.


=== Interpretation of the equation ===
The first half of the above physical thinking can be put into a mathematical form. The key is that, for any fixed x, one has

  
    
      
        
          
            
              
                
                  u
                  
                    (
                    x
                    )
                  
                
                (
                0
                )
              
              
                
                =
                u
                (
                x
                )
              
            
            
              
                
                  u
                  
                    (
                    x
                    )
                  
                  ′
                
                (
                0
                )
              
              
                
                =
                0
              
            
            
              
                
                  u
                  
                    (
                    x
                    )
                  
                  ″
                
                (
                0
                )
              
              
                
                =
                
                  
                    1
                    n
                  
                
                Δ
                u
                (
                x
                )
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}u_{(x)}(0)&=u(x)\\u_{(x)}'(0)&=0\\u_{(x)}''(0)&={\frac {1}{n}}\Delta u(x)\end{aligned}}}
  

where u(x)(r) is the single-variable function denoting the average value of u over the surface of the sphere of radius r centered at x; it can be defined by

  
    
      
        
          u
          
            (
            x
            )
          
        
        (
        r
        )
        =
        
          
            1
            
              
                ω
                
                  n
                  −
                  1
                
              
              
                r
                
                  n
                  −
                  1
                
              
            
          
        
        
          ∫
          
            {
            y
            :
            
              |
            
            x
            −
            y
            
              |
            
            =
            r
            }
          
        
        u
        
        d
        
          
            
              H
            
          
          
            n
            −
            1
          
        
        ,
      
    
    {\displaystyle u_{(x)}(r)={\frac {1}{\omega _{n-1}r^{n-1}}}\int _{\{y:|x-y|=r\}}u\,d{\mathcal {H}}^{n-1},}
  

in which ωn − 1 denotes the surface area of the unit ball in n-dimensional Euclidean space. This formalizes the above statement that the value of ∆u at a point x measures the difference between the value of u(x) and the value of u at points nearby to x, in the sense that the latter is encoded by the values of u(x)(r) for small positive values of r.
Following this observation, one may interpret the heat equation as imposing an infinitesimal averaging of a function. Given a solution of the heat equation, the value of u(x, t + τ) for a small positive value of τ may be approximated as ⁠1/2n⁠ times the average value of the function u(⋅, t) over a sphere of very small radius centered at x.


=== Character of the solutions ===

The heat equation implies that peaks (local maxima) of 
  
    
      
        u
      
    
    {\displaystyle u}
  
 will be gradually eroded down, while depressions (local minima) will be filled in.  The value at some point will remain stable only as long as it is equal to the average value in its immediate surroundings.  In particular, if the values in a neighborhood are very close to a linear function 
  
    
      
        A
        x
        +
        B
        y
        +
        C
        z
        +
        D
      
    
    {\displaystyle Ax+By+Cz+D}
  
, then the value at the center of that neighborhood will not be changing at that time (that is, the derivative 
  
    
      
        
          
            
              u
              ˙
            
          
        
      
    
    {\displaystyle {\dot {u}}}
  
 will be zero).
A more subtle consequence is the maximum principle, that says that the maximum value of 
  
    
      
        u
      
    
    {\displaystyle u}
  
 in any region 
  
    
      
        R
      
    
    {\displaystyle R}
  
 of the medium will not exceed the maximum value that previously occurred in 
  
    
      
        R
      
    
    {\displaystyle R}
  
, unless it is on the boundary of 
  
    
      
        R
      
    
    {\displaystyle R}
  
. That is, the maximum temperature in a region 
  
    
      
        R
      
    
    {\displaystyle R}
  
 can increase only if heat comes in from outside 
  
    
      
        R
      
    
    {\displaystyle R}
  
. This is a property of parabolic partial differential equations and is not difficult to prove mathematically (see below).
Another interesting property is that even if 
  
    
      
        u
      
    
    {\displaystyle u}
  
 initially has a sharp jump (discontinuity) of value across some surface inside the medium, the jump is immediately smoothed out by a momentary, infinitesimally short but infinitely large rate of flow of heat through that surface. For example, if two isolated bodies, initially at uniform but different temperatures 
  
    
      
        
          u
          
            0
          
        
      
    
    {\displaystyle u_{0}}
  
 and  
  
    
      
        
          u
          
            1
          
        
      
    
    {\displaystyle u_{1}}
  
, are made to touch each other, the temperature at the point of contact will immediately assume some intermediate value, and a zone will develop around that point where 
  
    
      
        u
      
    
    {\displaystyle u}
  
 will gradually vary between 
  
    
      
        
          u
          
            0
          
        
      
    
    {\displaystyle u_{0}}
  
 and 
  
    
      
        
          u
          
            1
          
        
      
    
    {\displaystyle u_{1}}
  
.
If a certain amount of heat is suddenly applied to a point in the medium, it will spread out in all directions in the form of a diffusion wave.  Unlike the elastic and electromagnetic waves, the speed of a diffusion wave drops with time: as it spreads over a larger region, the temperature gradient decreases, and therefore the heat flow decreases too.


== Specific examples ==


=== Heat flow in a uniform rod ===
For heat flow, the heat equation follows from the physical laws of conduction of heat and conservation of energy (Cannon 1984).
By Fourier's law for an isotropic medium, the rate of flow of heat energy per unit area through a surface is proportional to the negative temperature gradient across it:

  
    
      
        
          q
        
        =
        −
        k
        
        ∇
        u
      
    
    {\displaystyle \mathbf {q} =-k\,\nabla u}
  

where 
  
    
      
        k
      
    
    {\displaystyle k}
  
 is the thermal conductivity of the material, 
  
    
      
        u
        =
        u
        (
        
          x
        
        ,
        t
        )
      
    
    {\displaystyle u=u(\mathbf {x} ,t)}
  
 is the temperature, and 
  
    
      
        
          q
        
        =
        
          q
        
        (
        
          x
        
        ,
        t
        )
      
    
    {\displaystyle \mathbf {q} =\mathbf {q} (\mathbf {x} ,t)}
  
 is a vector field that represents the magnitude and direction of the heat flow at the point 
  
    
      
        
          x
        
      
    
    {\displaystyle \mathbf {x} }
  
 of space and time 
  
    
      
        t
      
    
    {\displaystyle t}
  
.
If the medium is a thin rod of uniform section and material, the position x is a single coordinate and the heat flow 
  
    
      
        q
        =
        q
        (
        t
        ,
        x
        )
      
    
    {\displaystyle q=q(t,x)}
  
 towards 
  
    
      
        x
      
    
    {\displaystyle x}
  
 is a scalar field. The equation becomes

  
    
      
        q
        =
        −
        k
        
        
          
            
              ∂
              u
            
            
              ∂
              x
            
          
        
      
    
    {\displaystyle q=-k\,{\frac {\partial u}{\partial x}}}
  

Let 
  
    
      
        Q
        =
        Q
        (
        x
        ,
        t
        )
      
    
    {\displaystyle Q=Q(x,t)}
  
 be the internal energy (heat) per unit volume of the bar at each point and time. The rate of change in heat per unit volume in the material, 
  
    
      
        ∂
        Q
        
          /
        
        ∂
        t
      
    
    {\displaystyle \partial Q/\partial t}
  
, is proportional to the rate of change of its temperature, 
  
    
      
        ∂
        u
        
          /
        
        ∂
        t
      
    
    {\displaystyle \partial u/\partial t}
  
. That is,

  
    
      
        
          
            
              ∂
              Q
            
            
              ∂
              t
            
          
        
        =
        c
        
        ρ
        
        
          
            
              ∂
              u
            
            
              ∂
              t
            
          
        
      
    
    {\displaystyle {\frac {\partial Q}{\partial t}}=c\,\rho \,{\frac {\partial u}{\partial t}}}
  

where 
  
    
      
        c
      
    
    {\displaystyle c}
  
 is the specific heat capacity (at constant pressure, in case of a gas) and 
  
    
      
        ρ
      
    
    {\displaystyle \rho }
  
 is the density (mass per unit volume) of the material. This derivation assumes that the material has constant mass density and heat capacity through space as well as time.
Applying the law of conservation of energy to a small element of the medium centred at 
  
    
      
        x
      
    
    {\displaystyle x}
  
, one concludes that the rate at which heat changes at a given point 
  
    
      
        x
      
    
    {\displaystyle x}
  
 is equal to the derivative of the heat flow at that point (the difference between the heat flows either side of the particle). That is,

  
    
      
        
          
            
              ∂
              Q
            
            
              ∂
              t
            
          
        
        =
        −
        
          
            
              ∂
              q
            
            
              ∂
              x
            
          
        
      
    
    {\displaystyle {\frac {\partial Q}{\partial t}}=-{\frac {\partial q}{\partial x}}}
  

From the above equations it follows that

  
    
      
        
          
            
              ∂
              u
            
            
              ∂
              t
            
          
        
        
        =
        
        −
        
          
            1
            
              c
              ρ
            
          
        
        
          
            
              ∂
              q
            
            
              ∂
              x
            
          
        
        
        =
        
        −
        
          
            1
            
              c
              ρ
            
          
        
        
          
            ∂
            
              ∂
              x
            
          
        
        
          (
          
            −
            k
            
            
              
                
                  ∂
                  u
                
                
                  ∂
                  x
                
              
            
          
          )
        
        
        =
        
        
          
            k
            
              c
              ρ
            
          
        
        
          
            
              
                ∂
                
                  2
                
              
              u
            
            
              ∂
              
                x
                
                  2
                
              
            
          
        
      
    
    {\displaystyle {\frac {\partial u}{\partial t}}\;=\;-{\frac {1}{c\rho }}{\frac {\partial q}{\partial x}}\;=\;-{\frac {1}{c\rho }}{\frac {\partial }{\partial x}}\left(-k\,{\frac {\partial u}{\partial x}}\right)\;=\;{\frac {k}{c\rho }}{\frac {\partial ^{2}u}{\partial x^{2}}}}
  

which is the heat equation in one dimension, with diffusivity coefficient

  
    
      
        α
        =
        
          
            k
            
              c
              ρ
            
          
        
      
    
    {\displaystyle \alpha ={\frac {k}{c\rho }}}
  

This quantity is called the thermal diffusivity of the medium.


==== Accounting for radiative loss ====
An additional term may be introduced into the equation to account for radiative loss of heat. According to the Stefan–Boltzmann law, this term is 
  
    
      
        μ
        
          (
          
            
              u
              
                4
              
            
            −
            
              v
              
                4
              
            
          
          )
        
      
    
    {\displaystyle \mu \left(u^{4}-v^{4}\right)}
  
, where 
  
    
      
        v
        =
        v
        (
        x
        ,
        t
        )
      
    
    {\displaystyle v=v(x,t)}
  
 is the temperature of the surroundings, and 
  
    
      
        μ
      
    
    {\displaystyle \mu }
  
 is a coefficient that depends on the Stefan-Boltzmann constant,  the emissivity of the material, and the geometry. The rate of change in internal energy becomes

  
    
      
        
          
            
              ∂
              Q
            
            
              ∂
              t
            
          
        
        =
        −
        
          
            
              ∂
              q
            
            
              ∂
              x
            
          
        
        −
        μ
        
          (
          
            
              u
              
                4
              
            
            −
            
              v
              
                4
              
            
          
          )
        
      
    
    {\displaystyle {\frac {\partial Q}{\partial t}}=-{\frac {\partial q}{\partial x}}-\mu \left(u^{4}-v^{4}\right)}
  

and the equation for the evolution of 
  
    
      
        u
      
    
    {\displaystyle u}
  
 becomes

  
    
      
        
          
            
              ∂
              u
            
            
              ∂
              t
            
          
        
        =
        
          
            k
            
              c
              ρ
            
          
        
        
          
            
              
                ∂
                
                  2
                
              
              u
            
            
              ∂
              
                x
                
                  2
                
              
            
          
        
        −
        
          
            μ
            
              c
              ρ
            
          
        
        
          (
          
            
              u
              
                4
              
            
            −
            
              v
              
                4
              
            
          
          )
        
        .
      
    
    {\displaystyle {\frac {\partial u}{\partial t}}={\frac {k}{c\rho }}{\frac {\partial ^{2}u}{\partial x^{2}}}-{\frac {\mu }{c\rho }}\left(u^{4}-v^{4}\right).}
  


==== Non-uniform isotropic medium ====
Note that the state equation, given by the first law of thermodynamics (i.e. conservation of energy), is written in the following form (assuming no mass transfer or radiation). This form is more general and particularly useful to recognize which property (e.g. cp or 
  
    
      
        ρ
      
    
    {\displaystyle \rho }
  
) influences which term.

  
    
      
        ρ
        
          c
          
            p
          
        
        
          
            
              ∂
              T
            
            
              ∂
              t
            
          
        
        −
        ∇
        ⋅
        
          (
          
            k
            ∇
            T
          
          )
        
        =
        
          
            
              
                q
                ˙
              
            
          
          
            V
          
        
      
    
    {\displaystyle \rho c_{p}{\frac {\partial T}{\partial t}}-\nabla \cdot \left(k\nabla T\right)={\dot {q}}_{V}}
  

where 
  
    
      
        
          
            
              
                q
                ˙
              
            
          
          
            V
          
        
      
    
    {\displaystyle {\dot {q}}_{V}}
  
 is the volumetric heat source.


=== Heat flow in non-homogeneous anisotropic media ===
In general, the study of heat conduction is based on several principles. Heat flow is a form of energy flow, and as such it is meaningful to speak of the time rate of flow of heat into a region of space.

The time rate of heat flow into a region V is given by a time-dependent quantity qt(V). We assume q has a density Q, so that 
  
    
      
        
          q
          
            t
          
        
        (
        V
        )
        =
        
          ∫
          
            V
          
        
        Q
        (
        x
        ,
        t
        )
        
        d
        x
        
      
    
    {\displaystyle q_{t}(V)=\int _{V}Q(x,t)\,dx\quad }
  

Heat flow is a time-dependent vector function H(x) characterized as follows: the time rate of heat flowing through an infinitesimal surface element with area dS and with unit normal vector n is 
  
    
      
        
          H
        
        (
        x
        )
        ⋅
        
          n
        
        (
        x
        )
        
        d
        S
        .
      
    
    {\displaystyle \mathbf {H} (x)\cdot \mathbf {n} (x)\,dS.}
  
 Thus the rate of heat flow into V is also given by the surface integral 
  
    
      
        
          q
          
            t
          
        
        (
        V
        )
        =
        −
        
          ∫
          
            ∂
            V
          
        
        
          H
        
        (
        x
        )
        ⋅
        
          n
        
        (
        x
        )
        
        d
        S
      
    
    {\displaystyle q_{t}(V)=-\int _{\partial V}\mathbf {H} (x)\cdot \mathbf {n} (x)\,dS}
  
 where n(x) is the outward pointing normal vector at x.
The Fourier law states that heat energy flow has the following linear dependence on the temperature gradient 
  
    
      
        
          H
        
        (
        x
        )
        =
        −
        
          A
        
        (
        x
        )
        ⋅
        ∇
        u
        (
        x
        )
      
    
    {\displaystyle \mathbf {H} (x)=-\mathbf {A} (x)\cdot \nabla u(x)}
  
 where A(x) is a 3 × 3 real matrix that is symmetric and positive definite.
By the divergence theorem, the previous surface integral for heat flow into V can be transformed into the volume integral 
  
    
      
        
          
            
              
                
                  q
                  
                    t
                  
                
                (
                V
                )
              
              
                
                =
                −
                
                  ∫
                  
                    ∂
                    V
                  
                
                
                  H
                
                (
                x
                )
                ⋅
                
                  n
                
                (
                x
                )
                
                d
                S
              
            
            
              
              
                
                =
                
                  ∫
                  
                    ∂
                    V
                  
                
                
                  A
                
                (
                x
                )
                ⋅
                ∇
                u
                (
                x
                )
                ⋅
                
                  n
                
                (
                x
                )
                
                d
                S
              
            
            
              
              
                
                =
                
                  ∫
                  
                    V
                  
                
                
                  ∑
                  
                    i
                    ,
                    j
                  
                
                
                  ∂
                  
                    
                      x
                      
                        i
                      
                    
                  
                
                
                  
                    (
                  
                
                
                  a
                  
                    i
                    j
                  
                
                (
                x
                )
                
                  ∂
                  
                    
                      x
                      
                        j
                      
                    
                  
                
                u
                (
                x
                ,
                t
                )
                
                  
                    )
                  
                
                
                d
                x
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}q_{t}(V)&=-\int _{\partial V}\mathbf {H} (x)\cdot \mathbf {n} (x)\,dS\\&=\int _{\partial V}\mathbf {A} (x)\cdot \nabla u(x)\cdot \mathbf {n} (x)\,dS\\&=\int _{V}\sum _{i,j}\partial _{x_{i}}{\bigl (}a_{ij}(x)\partial _{x_{j}}u(x,t){\bigr )}\,dx\end{aligned}}}
  

The time rate of temperature change at x is proportional to the heat flowing into an infinitesimal volume element, where the constant of proportionality is dependent on a constant κ 
  
    
      
        
          ∂
          
            t
          
        
        u
        (
        x
        ,
        t
        )
        =
        κ
        (
        x
        )
        Q
        (
        x
        ,
        t
        )
      
    
    {\displaystyle \partial _{t}u(x,t)=\kappa (x)Q(x,t)}
  

Putting these equations together gives the general equation of heat flow:

  
    
      
        
          ∂
          
            t
          
        
        u
        (
        x
        ,
        t
        )
        =
        κ
        (
        x
        )
        
          ∑
          
            i
            ,
            j
          
        
        
          ∂
          
            
              x
              
                i
              
            
          
        
        
          
            (
          
        
        
          a
          
            i
            j
          
        
        (
        x
        )
        
          ∂
          
            
              x
              
                j
              
            
          
        
        u
        (
        x
        ,
        t
        )
        
          
            )
          
        
      
    
    {\displaystyle \partial _{t}u(x,t)=\kappa (x)\sum _{i,j}\partial _{x_{i}}{\bigl (}a_{ij}(x)\partial _{x_{j}}u(x,t){\bigr )}}
  

Remarks

The coefficient κ(x) is the inverse of specific heat of the substance at x × density of the substance at x: 
  
    
      
        κ
        =
        1
        
          /
        
        (
        ρ
        
          c
          
            p
          
        
        )
      
    
    {\displaystyle \kappa =1/(\rho c_{p})}
  
.
In the case of an isotropic medium, the matrix A is a scalar matrix equal to thermal conductivity k.
In the anisotropic case where the coefficient matrix A is not scalar and/or if it depends on x, then an explicit formula for the solution of the heat equation can seldom be written down, though it is usually possible to consider the associated abstract Cauchy problem and show that it is a well-posed problem and/or to show some qualitative properties (like preservation of positive initial data, infinite speed of propagation, convergence toward an equilibrium, smoothing properties). This is usually done by one-parameter semigroups theory: for instance, if A is a symmetric matrix, then the elliptic operator defined by 
  
    
      
        A
        u
        (
        x
        )
        :=
        
          ∑
          
            i
            ,
            j
          
        
        
          ∂
          
            
              x
              
                i
              
            
          
        
        
          a
          
            i
            j
          
        
        (
        x
        )
        
          ∂
          
            
              x
              
                j
              
            
          
        
        u
        (
        x
        )
      
    
    {\displaystyle Au(x):=\sum _{i,j}\partial _{x_{i}}a_{ij}(x)\partial _{x_{j}}u(x)}
  
 is self-adjoint and dissipative, thus by the spectral theorem it generates a one-parameter semigroup.


=== Three-dimensional problem ===
In the special cases of propagation of heat in an isotropic and homogeneous medium in a 3-dimensional space, this equation is

  
    
      
        
          
            
              ∂
              u
            
            
              ∂
              t
            
          
        
        =
        α
        
          ∇
          
            2
          
        
        u
        =
        α
        
          (
          
            
              
                
                  
                    ∂
                    
                      2
                    
                  
                  u
                
                
                  ∂
                  
                    x
                    
                      2
                    
                  
                
              
            
            +
            
              
                
                  
                    ∂
                    
                      2
                    
                  
                  u
                
                
                  ∂
                  
                    y
                    
                      2
                    
                  
                
              
            
            +
            
              
                
                  
                    ∂
                    
                      2
                    
                  
                  u
                
                
                  ∂
                  
                    z
                    
                      2
                    
                  
                
              
            
          
          )
        
      
    
    {\displaystyle {\frac {\partial u}{\partial t}}=\alpha \nabla ^{2}u=\alpha \left({\frac {\partial ^{2}u}{\partial x^{2}}}+{\frac {\partial ^{2}u}{\partial y^{2}}}+{\frac {\partial ^{2}u}{\partial z^{2}}}\right)}
  
   
  
    
      
        =
        α
        
          (
          
            
              u
              
                x
                x
              
            
            +
            
              u
              
                y
                y
              
            
            +
            
              u
              
                z
                z
              
            
          
          )
        
      
    
    {\displaystyle =\alpha \left(u_{xx}+u_{yy}+u_{zz}\right)}
  

where:

  
    
      
        u
        =
        u
        (
        x
        ,
        y
        ,
        z
        ,
        t
        )
      
    
    {\displaystyle u=u(x,y,z,t)}
  
 is temperature as a function of space and time;

  
    
      
        
          
            
              
                ∂
                u
              
              
                ∂
                t
              
            
          
        
      
    
    {\displaystyle {\tfrac {\partial u}{\partial t}}}
  
 is the rate of change of temperature at a point over time;

  
    
      
        
          u
          
            x
            x
          
        
      
    
    {\displaystyle u_{xx}}
  
, 
  
    
      
        
          u
          
            y
            y
          
        
      
    
    {\displaystyle u_{yy}}
  
, and 
  
    
      
        
          u
          
            z
            z
          
        
      
    
    {\displaystyle u_{zz}}
  
 are the second spatial derivatives (thermal conductions) of temperature in the 
  
    
      
        x
      
    
    {\displaystyle x}
  
, 
  
    
      
        y
      
    
    {\displaystyle y}
  
, and 
  
    
      
        z
      
    
    {\displaystyle z}
  
 directions, respectively;

  
    
      
        α
        ≡
        
          
            
              k
              
                
                  c
                  
                    p
                  
                
                ρ
              
            
          
        
      
    
    {\displaystyle \alpha \equiv {\tfrac {k}{c_{p}\rho }}}
  
 is the thermal diffusivity, a material-specific quantity depending on the thermal conductivity 
  
    
      
        k
      
    
    {\displaystyle k}
  
, the specific heat capacity 
  
    
      
        
          c
          
            p
          
        
      
    
    {\displaystyle c_{p}}
  
, and the mass density 
  
    
      
        ρ
      
    
    {\displaystyle \rho }
  
.
The heat equation is a consequence of Fourier's law of conduction (see heat conduction).
If the medium is not the whole space, in order to solve the heat equation uniquely we also need to specify boundary conditions for u. To determine uniqueness of solutions in the whole space it is necessary to assume additional conditions, for example an exponential bound on the growth of solutions or a sign condition (nonnegative solutions are unique by a result of David Widder).
Solutions of the heat equation are characterized by a gradual smoothing of the initial temperature distribution by the flow of heat from warmer to colder areas of an object. Generally, many different states and starting conditions will tend toward the same stable equilibrium. As a consequence, to reverse the solution and conclude something about earlier times or initial conditions from the present heat distribution is very inaccurate except over the shortest of time periods.
The heat equation is the prototypical example of a parabolic partial differential equation.
Using the Laplace operator, the heat equation can be simplified, and generalized to similar equations over spaces of arbitrary number of dimensions, as

  
    
      
        
          u
          
            t
          
        
        =
        α
        
          ∇
          
            2
          
        
        u
        =
        α
        Δ
        u
        ,
      
    
    {\displaystyle u_{t}=\alpha \nabla ^{2}u=\alpha \Delta u,}
  

where the Laplace operator, denoted as either Δ or as ∇2 (the divergence of the gradient), is taken in the spatial variables.
The heat equation governs heat diffusion, as well as other diffusive processes, such as particle diffusion or the propagation of action potential in nerve cells. Although they are not diffusive in nature, some quantum mechanics problems are also governed by a mathematical analog of the heat equation (see below). It also can be used to model some phenomena arising in finance, like the Black–Scholes or the Ornstein-Uhlenbeck processes. The equation, and various non-linear analogues, has also been used in image analysis.
The heat equation is, technically, in violation of special relativity, because its solutions involve instantaneous propagation of a disturbance. The part of the disturbance outside the forward light cone can usually be safely neglected, but if it is necessary to develop a reasonable speed for the transmission of heat, a hyperbolic problem should be considered instead – like a partial differential equation involving a second-order time derivative.  Some models of nonlinear heat conduction (which are also parabolic equations) have solutions with finite heat transmission speed.


=== Internal heat generation ===
The function u above represents temperature of a body. Alternatively, it is sometimes convenient to change units and represent u as the heat density of a medium. Since heat density is proportional to temperature in a homogeneous medium, the heat equation is still obeyed in the new units.
Suppose that a body obeys the heat equation and, in addition, generates its own heat per unit volume (e.g., in watts/litre - W/L) at a rate given by a known function q varying in space and time. Then the heat per unit volume u satisfies an equation

  
    
      
        
          
            1
            α
          
        
        
          
            
              ∂
              u
            
            
              ∂
              t
            
          
        
        =
        
          (
          
            
              
                
                  
                    ∂
                    
                      2
                    
                  
                  u
                
                
                  ∂
                  
                    x
                    
                      2
                    
                  
                
              
            
            +
            
              
                
                  
                    ∂
                    
                      2
                    
                  
                  u
                
                
                  ∂
                  
                    y
                    
                      2
                    
                  
                
              
            
            +
            
              
                
                  
                    ∂
                    
                      2
                    
                  
                  u
                
                
                  ∂
                  
                    z
                    
                      2
                    
                  
                
              
            
          
          )
        
        +
        
          
            1
            k
          
        
        q
        .
      
    
    {\displaystyle {\frac {1}{\alpha }}{\frac {\partial u}{\partial t}}=\left({\frac {\partial ^{2}u}{\partial x^{2}}}+{\frac {\partial ^{2}u}{\partial y^{2}}}+{\frac {\partial ^{2}u}{\partial z^{2}}}\right)+{\frac {1}{k}}q.}
  

For example, a tungsten light bulb filament generates heat, so it would have a positive nonzero value for q when turned on. While the light is turned off, the value of q for the tungsten filament would be zero.


== Solving the heat equation using Fourier series ==

The following solution technique for the heat equation was proposed by Joseph Fourier in his treatise Théorie analytique de la chaleur, published in 1822. Consider the heat equation for one space variable. This could be used to model heat conduction in a rod. The equation is

where u = u(x, t) is a function of two variables x and t. Here 

x is the space variable, so x ∈ [0, L], where L is the length of the rod.
t is the time variable, so t ≥ 0.
We assume the initial condition

where the function f is given, and the boundary conditions

Let us attempt to find a solution of (1) that is not identically zero satisfying the boundary conditions (3) but with the following property: u is a product in which the dependence of u on x, t is separated, that is:

This solution technique is called separation of variables. Substituting u back into equation (1),

  
    
      
        
          
            
              
                T
                ′
              
              (
              t
              )
            
            
              α
              T
              (
              t
              )
            
          
        
        =
        
          
            
              
                X
                ″
              
              (
              x
              )
            
            
              X
              (
              x
              )
            
          
        
        .
      
    
    {\displaystyle {\frac {T'(t)}{\alpha T(t)}}={\frac {X''(x)}{X(x)}}.}
  

Since the right hand side depends only on x and the left hand side only on t, both sides are equal to some constant value −λ. Thus:

and

We will now show that nontrivial solutions for (6) for values of λ ≤ 0 cannot occur:

Suppose that λ < 0. Then there exist real numbers B, C such that 
  
    
      
        X
        (
        x
        )
        =
        B
        
          e
          
            
              
                −
                λ
              
            
            
            x
          
        
        +
        C
        
          e
          
            −
            
              
                −
                λ
              
            
            
            x
          
        
        .
      
    
    {\displaystyle X(x)=Be^{{\sqrt {-\lambda }}\,x}+Ce^{-{\sqrt {-\lambda }}\,x}.}
  
 From (3) we get  X(0) = 0 = X(L) and therefore B = 0 = C which implies u is identically 0.
Suppose that λ = 0. Then there exist real numbers B, C such that X(x) = Bx + C. From equation (3) we conclude in the same manner as in 1 that u is identically 0.
Therefore, it must be the case that λ > 0. Then there exist real numbers A, B, C such that 
  
    
      
        T
        (
        t
        )
        =
        A
        
          e
          
            −
            λ
            α
            t
          
        
      
    
    {\displaystyle T(t)=Ae^{-\lambda \alpha t}}
  
 and 
  
    
      
        X
        (
        x
        )
        =
        B
        sin
        ⁡
        
          (
          
            
              
                λ
              
            
            
            x
          
          )
        
        +
        C
        cos
        ⁡
        
          (
          
            
              
                λ
              
            
            
            x
          
          )
        
        .
      
    
    {\displaystyle X(x)=B\sin \left({\sqrt {\lambda }}\,x\right)+C\cos \left({\sqrt {\lambda }}\,x\right).}
  
 From (3) we get C = 0 and that for some positive integer n, 
  
    
      
        
          
            λ
          
        
        =
        n
        
          
            π
            L
          
        
        .
      
    
    {\displaystyle {\sqrt {\lambda }}=n{\frac {\pi }{L}}.}
  

This solves the heat equation in the special case that the dependence of u has the special form (4).
In general, the sum of solutions to (1) that satisfy the boundary conditions (3) also satisfies (1) and (3). We can show that the solution to (1), (2) and (3) is given by

  
    
      
        u
        (
        x
        ,
        t
        )
        =
        
          ∑
          
            n
            =
            1
          
          
            ∞
          
        
        
          D
          
            n
          
        
        sin
        ⁡
        
          (
          
            
              
                n
                π
                x
              
              L
            
          
          )
        
        
          e
          
            −
            
              
                
                  
                    n
                    
                      2
                    
                  
                  
                    π
                    
                      2
                    
                  
                  α
                  t
                
                
                  L
                  
                    2
                  
                
              
            
          
        
      
    
    {\displaystyle u(x,t)=\sum _{n=1}^{\infty }D_{n}\sin \left({\frac {n\pi x}{L}}\right)e^{-{\frac {n^{2}\pi ^{2}\alpha t}{L^{2}}}}}
  

where

  
    
      
        
          D
          
            n
          
        
        =
        
          
            2
            L
          
        
        
          ∫
          
            0
          
          
            L
          
        
        f
        (
        x
        )
        sin
        ⁡
        
          (
          
            
              
                n
                π
                x
              
              L
            
          
          )
        
        
        d
        x
        .
      
    
    {\displaystyle D_{n}={\frac {2}{L}}\int _{0}^{L}f(x)\sin \left({\frac {n\pi x}{L}}\right)\,dx.}
  


=== Generalizing the solution technique ===
The solution technique used above can be greatly extended to many other types of equations. The idea is that the operator uxx with the zero boundary conditions can be represented in terms of its eigenfunctions. This leads naturally to one of the basic ideas of the spectral theory of linear self-adjoint operators.
Consider the linear operator Δu = uxx. The infinite sequence of functions

  
    
      
        
          e
          
            n
          
        
        (
        x
        )
        =
        
          
            
              2
              L
            
          
        
        sin
        ⁡
        
          (
          
            
              
                n
                π
                x
              
              L
            
          
          )
        
      
    
    {\displaystyle e_{n}(x)={\sqrt {\frac {2}{L}}}\sin \left({\frac {n\pi x}{L}}\right)}
  

for n ≥ 1 are eigenfunctions of Δ. Indeed,

  
    
      
        Δ
        
          e
          
            n
          
        
        =
        −
        
          
            
              
                n
                
                  2
                
              
              
                π
                
                  2
                
              
            
            
              L
              
                2
              
            
          
        
        
          e
          
            n
          
        
        .
      
    
    {\displaystyle \Delta e_{n}=-{\frac {n^{2}\pi ^{2}}{L^{2}}}e_{n}.}
  

Moreover, any eigenfunction f of Δ with the boundary conditions f(0) = f(L) = 0 is of the form en for some n ≥ 1. The functions en for n ≥ 1 form an orthonormal sequence with respect to a certain inner product on the space of real-valued functions on [0, L]. This means

  
    
      
        ⟨
        
          e
          
            n
          
        
        ,
        
          e
          
            m
          
        
        ⟩
        =
        
          ∫
          
            0
          
          
            L
          
        
        
          e
          
            n
          
        
        (
        x
        )
        
          e
          
            m
          
          
            ∗
          
        
        (
        x
        )
        d
        x
        =
        
          δ
          
            m
            n
          
        
      
    
    {\displaystyle \langle e_{n},e_{m}\rangle =\int _{0}^{L}e_{n}(x)e_{m}^{*}(x)dx=\delta _{mn}}
  

Finally, the sequence {en}n ∈ N spans a dense linear subspace of L2((0, L)). This shows that in effect we have diagonalized the operator Δ.


=== Mean-value property ===
Solutions of the heat equations 

  
    
      
        (
        
          ∂
          
            t
          
        
        −
        Δ
        )
        u
        =
        0
      
    
    {\displaystyle (\partial _{t}-\Delta )u=0}
  

satisfy a mean-value property analogous to the mean-value properties of harmonic functions, solutions of 

  
    
      
        Δ
        u
        =
        0
        ,
      
    
    {\displaystyle \Delta u=0,}
  

though a bit more complicated. Precisely, if u solves 

  
    
      
        (
        
          ∂
          
            t
          
        
        −
        Δ
        )
        u
        =
        0
      
    
    {\displaystyle (\partial _{t}-\Delta )u=0}
  

and 

  
    
      
        (
        x
        ,
        t
        )
        +
        
          E
          
            λ
          
        
        ⊂
        
          d
          o
          m
        
        (
        u
        )
      
    
    {\displaystyle (x,t)+E_{\lambda }\subset \mathrm {dom} (u)}
  

then

  
    
      
        u
        (
        x
        ,
        t
        )
        =
        
          
            λ
            4
          
        
        
          ∫
          
            
              E
              
                λ
              
            
          
        
        u
        (
        x
        −
        y
        ,
        t
        −
        s
        )
        
          
            
              
                |
              
              y
              
                
                  |
                
                
                  2
                
              
            
            
              s
              
                2
              
            
          
        
        d
        s
        
        d
        y
        ,
      
    
    {\displaystyle u(x,t)={\frac {\lambda }{4}}\int _{E_{\lambda }}u(x-y,t-s){\frac {|y|^{2}}{s^{2}}}ds\,dy,}
  

where 
  
    
      
        
          E
          
            λ
          
        
      
    
    {\displaystyle E_{\lambda }}
  
 is a heat-ball, that is a super-level set of the fundamental solution of the heat equation:

  
    
      
        
          E
          
            λ
          
        
        :=
        {
        (
        y
        ,
        s
        )
        :
        Φ
        (
        y
        ,
        s
        )
        >
        λ
        }
        ,
      
    
    {\displaystyle E_{\lambda }:=\{(y,s):\Phi (y,s)>\lambda \},}
  

  
    
      
        Φ
        (
        x
        ,
        t
        )
        :=
        (
        4
        t
        π
        
          )
          
            −
            
              
                n
                2
              
            
          
        
        exp
        ⁡
        
          (
          
            −
            
              
                
                  
                    |
                  
                  x
                  
                    
                      |
                    
                    
                      2
                    
                  
                
                
                  4
                  t
                
              
            
          
          )
        
        .
      
    
    {\displaystyle \Phi (x,t):=(4t\pi )^{-{\frac {n}{2}}}\exp \left(-{\frac {|x|^{2}}{4t}}\right).}
  

Notice that 

  
    
      
        
          d
          i
          a
          m
        
        (
        
          E
          
            λ
          
        
        )
        =
        o
        (
        1
        )
      
    
    {\displaystyle \mathrm {diam} (E_{\lambda })=o(1)}
  

as 
  
    
      
        λ
        →
        ∞
      
    
    {\displaystyle \lambda \to \infty }
  
 so the above formula holds for any 
  
    
      
        (
        x
        ,
        t
        )
      
    
    {\displaystyle (x,t)}
  
 in the (open) set 
  
    
      
        
          d
          o
          m
        
        (
        u
        )
      
    
    {\displaystyle \mathrm {dom} (u)}
  
 for 
  
    
      
        λ
      
    
    {\displaystyle \lambda }
  
 large enough.


== Fundamental solutions ==

A fundamental solution of the heat equation is a solution that corresponds to the initial condition of an initial point source of heat at a known position. These can be used to find a general solution of the heat equation over certain domains (see, for instance, Evans 2010).
In one variable, the Green's function is a solution of the initial value problem (by Duhamel's principle, equivalent to the definition of Green's function as one with a delta function as solution to the first equation)

  
    
      
        
          
            {
            
              
                
                  
                    u
                    
                      t
                    
                  
                  (
                  x
                  ,
                  t
                  )
                  −
                  k
                  
                    u
                    
                      x
                      x
                    
                  
                  (
                  x
                  ,
                  t
                  )
                  =
                  0
                
                
                  (
                  x
                  ,
                  t
                  )
                  ∈
                  
                    R
                  
                  ×
                  (
                  0
                  ,
                  ∞
                  )
                
              
              
                
                  u
                  (
                  x
                  ,
                  0
                  )
                  =
                  δ
                  (
                  x
                  )
                
                
              
            
            
          
        
      
    
    {\displaystyle {\begin{cases}u_{t}(x,t)-ku_{xx}(x,t)=0&(x,t)\in \mathbb {R} \times (0,\infty )\\u(x,0)=\delta (x)&\end{cases}}}
  

where 
  
    
      
        δ
      
    
    {\displaystyle \delta }
  
 is the Dirac delta function. The fundamental solution to this problem is given by the heat kernel

  
    
      
        Φ
        (
        x
        ,
        t
        )
        =
        
          
            1
            
              4
              π
              k
              t
            
          
        
        exp
        ⁡
        
          (
          
            −
            
              
                
                  x
                  
                    2
                  
                
                
                  4
                  k
                  t
                
              
            
          
          )
        
        .
      
    
    {\displaystyle \Phi (x,t)={\frac {1}{\sqrt {4\pi kt}}}\exp \left(-{\frac {x^{2}}{4kt}}\right).}
  

One can obtain the general solution of the one variable heat equation with initial condition u(x, 0) = g(x) for −∞ < x < ∞ and 0 < t < ∞ by applying a convolution:

  
    
      
        u
        (
        x
        ,
        t
        )
        =
        ∫
        Φ
        (
        x
        −
        y
        ,
        t
        )
        g
        (
        y
        )
        d
        y
        .
      
    
    {\displaystyle u(x,t)=\int \Phi (x-y,t)g(y)dy.}
  

In several spatial variables, the fundamental solution solves the analogous problem

  
    
      
        
          
            {
            
              
                
                  
                    u
                    
                      t
                    
                  
                  (
                  
                    x
                  
                  ,
                  t
                  )
                  −
                  k
                  
                    ∑
                    
                      i
                      =
                      1
                    
                    
                      n
                    
                  
                  
                    u
                    
                      
                        x
                        
                          i
                        
                      
                      
                        x
                        
                          i
                        
                      
                    
                  
                  (
                  
                    x
                  
                  ,
                  t
                  )
                  =
                  0
                
                
                  (
                  
                    x
                  
                  ,
                  t
                  )
                  ∈
                  
                    
                      R
                    
                    
                      n
                    
                  
                  ×
                  (
                  0
                  ,
                  ∞
                  )
                
              
              
                
                  u
                  (
                  
                    x
                  
                  ,
                  0
                  )
                  =
                  δ
                  (
                  
                    x
                  
                  )
                
              
            
            
          
        
      
    
    {\displaystyle {\begin{cases}u_{t}(\mathbf {x} ,t)-k\sum _{i=1}^{n}u_{x_{i}x_{i}}(\mathbf {x} ,t)=0&(\mathbf {x} ,t)\in \mathbb {R} ^{n}\times (0,\infty )\\u(\mathbf {x} ,0)=\delta (\mathbf {x} )\end{cases}}}
  

The n-variable fundamental solution is the product of the fundamental solutions in each variable; i.e.,

  
    
      
        Φ
        (
        
          x
        
        ,
        t
        )
        =
        Φ
        (
        
          x
          
            1
          
        
        ,
        t
        )
        Φ
        (
        
          x
          
            2
          
        
        ,
        t
        )
        ⋯
        Φ
        (
        
          x
          
            n
          
        
        ,
        t
        )
        =
        
          
            1
            
              (
              4
              π
              k
              t
              
                )
                
                  n
                
              
            
          
        
        exp
        ⁡
        
          (
          
            −
            
              
                
                  
                    x
                  
                  ⋅
                  
                    x
                  
                
                
                  4
                  k
                  t
                
              
            
          
          )
        
        .
      
    
    {\displaystyle \Phi (\mathbf {x} ,t)=\Phi (x_{1},t)\Phi (x_{2},t)\cdots \Phi (x_{n},t)={\frac {1}{\sqrt {(4\pi kt)^{n}}}}\exp \left(-{\frac {\mathbf {x} \cdot \mathbf {x} }{4kt}}\right).}
  

The general solution of the heat equation on Rn is then obtained by a convolution, so that to solve the initial value problem with u(x, 0) = g(x), one has

  
    
      
        u
        (
        
          x
        
        ,
        t
        )
        =
        
          ∫
          
            
              
                R
              
              
                n
              
            
          
        
        Φ
        (
        
          x
        
        −
        
          y
        
        ,
        t
        )
        g
        (
        
          y
        
        )
        d
        
          y
        
        .
      
    
    {\displaystyle u(\mathbf {x} ,t)=\int _{\mathbb {R} ^{n}}\Phi (\mathbf {x} -\mathbf {y} ,t)g(\mathbf {y} )d\mathbf {y} .}
  

The general problem on a domain Ω in Rn is

  
    
      
        
          
            {
            
              
                
                  
                    u
                    
                      t
                    
                  
                  (
                  
                    x
                  
                  ,
                  t
                  )
                  −
                  k
                  
                    ∑
                    
                      i
                      =
                      1
                    
                    
                      n
                    
                  
                  
                    u
                    
                      
                        x
                        
                          i
                        
                      
                      
                        x
                        
                          i
                        
                      
                    
                  
                  (
                  
                    x
                  
                  ,
                  t
                  )
                  =
                  0
                
                
                  (
                  
                    x
                  
                  ,
                  t
                  )
                  ∈
                  Ω
                  ×
                  (
                  0
                  ,
                  ∞
                  )
                
              
              
                
                  u
                  (
                  
                    x
                  
                  ,
                  0
                  )
                  =
                  g
                  (
                  
                    x
                  
                  )
                
                
                  
                    x
                  
                  ∈
                  Ω
                
              
            
            
          
        
      
    
    {\displaystyle {\begin{cases}u_{t}(\mathbf {x} ,t)-k\sum _{i=1}^{n}u_{x_{i}x_{i}}(\mathbf {x} ,t)=0&(\mathbf {x} ,t)\in \Omega \times (0,\infty )\\u(\mathbf {x} ,0)=g(\mathbf {x} )&\mathbf {x} \in \Omega \end{cases}}}
  

with either Dirichlet or Neumann boundary data.  A Green's function always exists, but unless the domain Ω can be readily decomposed into one-variable problems (see below), it may not be possible to write it down explicitly.  Other methods for obtaining Green's functions include the method of images, separation of variables, and Laplace transforms (Cole, 2011). 


=== Some Green's function solutions in 1D ===
A variety of elementary Green's function solutions in one-dimension are recorded here; many others are available elsewhere.  In some of these, the spatial domain is (−∞,∞).  In others, it is the semi-infinite interval (0,∞) with either Neumann or Dirichlet boundary conditions.  One further variation is that some of these solve the inhomogeneous equation

  
    
      
        
          u
          
            t
          
        
        =
        k
        
          u
          
            x
            x
          
        
        +
        f
        .
      
    
    {\displaystyle u_{t}=ku_{xx}+f.}
  

where f is some given function of x and t.


==== Homogeneous heat equation ====
Initial value problem on (−∞,∞)

  
    
      
        
          
            {
            
              
                
                  
                    u
                    
                      t
                    
                  
                  =
                  k
                  
                    u
                    
                      x
                      x
                    
                  
                
                
                  (
                  x
                  ,
                  t
                  )
                  ∈
                  
                    R
                  
                  ×
                  (
                  0
                  ,
                  ∞
                  )
                
              
              
                
                  u
                  (
                  x
                  ,
                  0
                  )
                  =
                  g
                  (
                  x
                  )
                
                
                  
                    Initial condition
                  
                
              
            
            
          
        
      
    
    {\displaystyle {\begin{cases}u_{t}=ku_{xx}&(x,t)\in \mathbb {R} \times (0,\infty )\\u(x,0)=g(x)&{\text{Initial condition}}\end{cases}}}
  

  
    
      
        u
        (
        x
        ,
        t
        )
        =
        
          
            1
            
              4
              π
              k
              t
            
          
        
        
          ∫
          
            −
            ∞
          
          
            ∞
          
        
        exp
        ⁡
        
          (
          
            −
            
              
                
                  (
                  x
                  −
                  y
                  
                    )
                    
                      2
                    
                  
                
                
                  4
                  k
                  t
                
              
            
          
          )
        
        g
        (
        y
        )
        
        d
        y
      
    
    {\displaystyle u(x,t)={\frac {1}{\sqrt {4\pi kt}}}\int _{-\infty }^{\infty }\exp \left(-{\frac {(x-y)^{2}}{4kt}}\right)g(y)\,dy}
  

Comment. This solution is the convolution with respect to the variable x of the fundamental solution

  
    
      
        Φ
        (
        x
        ,
        t
        )
        :=
        
          
            1
            
              4
              π
              k
              t
            
          
        
        exp
        ⁡
        
          (
          
            −
            
              
                
                  x
                  
                    2
                  
                
                
                  4
                  k
                  t
                
              
            
          
          )
        
        ,
      
    
    {\displaystyle \Phi (x,t):={\frac {1}{\sqrt {4\pi kt}}}\exp \left(-{\frac {x^{2}}{4kt}}\right),}
  

and the function g(x). (The Green's function number of the fundamental solution is X00.)
Therefore, according to the general properties of the convolution with respect to differentiation, u = g ∗ Φ is a solution of the same heat equation, for

  
    
      
        
          (
          
            
              ∂
              
                t
              
            
            −
            k
            
              ∂
              
                x
              
              
                2
              
            
          
          )
        
        (
        Φ
        ∗
        g
        )
        =
        
          [
          
            
              (
              
                
                  ∂
                  
                    t
                  
                
                −
                k
                
                  ∂
                  
                    x
                  
                  
                    2
                  
                
              
              )
            
            Φ
          
          ]
        
        ∗
        g
        =
        0.
      
    
    {\displaystyle \left(\partial _{t}-k\partial _{x}^{2}\right)(\Phi *g)=\left[\left(\partial _{t}-k\partial _{x}^{2}\right)\Phi \right]*g=0.}
  

Moreover,

  
    
      
        Φ
        (
        x
        ,
        t
        )
        =
        
          
            1
            
              t
            
          
        
        
        Φ
        
          (
          
            
              
                x
                
                  t
                
              
            
            ,
            1
          
          )
        
      
    
    {\displaystyle \Phi (x,t)={\frac {1}{\sqrt {t}}}\,\Phi \left({\frac {x}{\sqrt {t}}},1\right)}
  

  
    
      
        
          ∫
          
            −
            ∞
          
          
            ∞
          
        
        Φ
        (
        x
        ,
        t
        )
        
        d
        x
        =
        1
        ,
      
    
    {\displaystyle \int _{-\infty }^{\infty }\Phi (x,t)\,dx=1,}
  

so that, by general facts about approximation to the identity, Φ(⋅, t) ∗ g → g as t → 0 in various senses, according to the specific g. For instance, if g is assumed bounded and continuous on R then Φ(⋅, t) ∗ g converges uniformly to g as t → 0, meaning that u(x, t) is continuous on R × [0, ∞) with u(x, 0) = g(x).

Initial value problem on (0,∞) with homogeneous Dirichlet boundary conditions

  
    
      
        
          
            {
            
              
                
                  
                    u
                    
                      t
                    
                  
                  =
                  k
                  
                    u
                    
                      x
                      x
                    
                  
                
                
                  (
                  x
                  ,
                  t
                  )
                  ∈
                  [
                  0
                  ,
                  ∞
                  )
                  ×
                  (
                  0
                  ,
                  ∞
                  )
                
              
              
                
                  u
                  (
                  x
                  ,
                  0
                  )
                  =
                  g
                  (
                  x
                  )
                
                
                  
                    IC
                  
                
              
              
                
                  u
                  (
                  0
                  ,
                  t
                  )
                  =
                  0
                
                
                  
                    BC
                  
                
              
            
            
          
        
      
    
    {\displaystyle {\begin{cases}u_{t}=ku_{xx}&(x,t)\in [0,\infty )\times (0,\infty )\\u(x,0)=g(x)&{\text{IC}}\\u(0,t)=0&{\text{BC}}\end{cases}}}
  

  
    
      
        u
        (
        x
        ,
        t
        )
        =
        
          
            1
            
              4
              π
              k
              t
            
          
        
        
          ∫
          
            0
          
          
            ∞
          
        
        
          [
          
            exp
            ⁡
            
              (
              
                −
                
                  
                    
                      (
                      x
                      −
                      y
                      
                        )
                        
                          2
                        
                      
                    
                    
                      4
                      k
                      t
                    
                  
                
              
              )
            
            −
            exp
            ⁡
            
              (
              
                −
                
                  
                    
                      (
                      x
                      +
                      y
                      
                        )
                        
                          2
                        
                      
                    
                    
                      4
                      k
                      t
                    
                  
                
              
              )
            
          
          ]
        
        g
        (
        y
        )
        
        d
        y
      
    
    {\displaystyle u(x,t)={\frac {1}{\sqrt {4\pi kt}}}\int _{0}^{\infty }\left[\exp \left(-{\frac {(x-y)^{2}}{4kt}}\right)-\exp \left(-{\frac {(x+y)^{2}}{4kt}}\right)\right]g(y)\,dy}
  

Comment. This solution is obtained from the preceding formula as applied to the data g(x) suitably extended to R, so as to be an odd function, that is, letting g(−x) := −g(x) for all x. Correspondingly, the solution of the initial value problem on (−∞,∞) is an odd function with respect to the variable x for all values of t, and in particular it satisfies the homogeneous Dirichlet boundary conditions u(0, t) = 0.
The Green's function number of this solution is X10.

Initial value problem on (0,∞) with homogeneous Neumann boundary conditions

  
    
      
        
          
            {
            
              
                
                  
                    u
                    
                      t
                    
                  
                  =
                  k
                  
                    u
                    
                      x
                      x
                    
                  
                
                
                  (
                  x
                  ,
                  t
                  )
                  ∈
                  [
                  0
                  ,
                  ∞
                  )
                  ×
                  (
                  0
                  ,
                  ∞
                  )
                
              
              
                
                  u
                  (
                  x
                  ,
                  0
                  )
                  =
                  g
                  (
                  x
                  )
                
                
                  
                    IC
                  
                
              
              
                
                  
                    u
                    
                      x
                    
                  
                  (
                  0
                  ,
                  t
                  )
                  =
                  0
                
                
                  
                    BC
                  
                
              
            
            
          
        
      
    
    {\displaystyle {\begin{cases}u_{t}=ku_{xx}&(x,t)\in [0,\infty )\times (0,\infty )\\u(x,0)=g(x)&{\text{IC}}\\u_{x}(0,t)=0&{\text{BC}}\end{cases}}}
  

  
    
      
        u
        (
        x
        ,
        t
        )
        =
        
          
            1
            
              4
              π
              k
              t
            
          
        
        
          ∫
          
            0
          
          
            ∞
          
        
        
          [
          
            exp
            ⁡
            
              (
              
                −
                
                  
                    
                      (
                      x
                      −
                      y
                      
                        )
                        
                          2
                        
                      
                    
                    
                      4
                      k
                      t
                    
                  
                
              
              )
            
            +
            exp
            ⁡
            
              (
              
                −
                
                  
                    
                      (
                      x
                      +
                      y
                      
                        )
                        
                          2
                        
                      
                    
                    
                      4
                      k
                      t
                    
                  
                
              
              )
            
          
          ]
        
        g
        (
        y
        )
        
        d
        y
      
    
    {\displaystyle u(x,t)={\frac {1}{\sqrt {4\pi kt}}}\int _{0}^{\infty }\left[\exp \left(-{\frac {(x-y)^{2}}{4kt}}\right)+\exp \left(-{\frac {(x+y)^{2}}{4kt}}\right)\right]g(y)\,dy}
  

Comment. This solution is obtained from the first solution formula as applied to the data g(x) suitably extended to R so as to be an even function, that is, letting g(−x) := g(x) for all x. Correspondingly, the solution of the initial value problem on R is an even  function with respect to the variable x for all values of t > 0, and in particular, being smooth, it satisfies the homogeneous Neumann boundary conditions ux(0, t) = 0.  The Green's function number of this solution is X20.

Problem on (0,∞) with homogeneous initial conditions and non-homogeneous Dirichlet boundary conditions

  
    
      
        
          
            {
            
              
                
                  
                    u
                    
                      t
                    
                  
                  =
                  k
                  
                    u
                    
                      x
                      x
                    
                  
                
                
                  (
                  x
                  ,
                  t
                  )
                  ∈
                  [
                  0
                  ,
                  ∞
                  )
                  ×
                  (
                  0
                  ,
                  ∞
                  )
                
              
              
                
                  u
                  (
                  x
                  ,
                  0
                  )
                  =
                  0
                
                
                  
                    IC
                  
                
              
              
                
                  u
                  (
                  0
                  ,
                  t
                  )
                  =
                  h
                  (
                  t
                  )
                
                
                  
                    BC
                  
                
              
            
            
          
        
      
    
    {\displaystyle {\begin{cases}u_{t}=ku_{xx}&(x,t)\in [0,\infty )\times (0,\infty )\\u(x,0)=0&{\text{IC}}\\u(0,t)=h(t)&{\text{BC}}\end{cases}}}
  

  
    
      
        u
        (
        x
        ,
        t
        )
        =
        
          ∫
          
            0
          
          
            t
          
        
        
          
            x
            
              4
              π
              k
              (
              t
              −
              s
              
                )
                
                  3
                
              
            
          
        
        exp
        ⁡
        
          (
          
            −
            
              
                
                  x
                  
                    2
                  
                
                
                  4
                  k
                  (
                  t
                  −
                  s
                  )
                
              
            
          
          )
        
        h
        (
        s
        )
        
        d
        s
        ,
        
        ∀
        x
        >
        0
      
    
    {\displaystyle u(x,t)=\int _{0}^{t}{\frac {x}{\sqrt {4\pi k(t-s)^{3}}}}\exp \left(-{\frac {x^{2}}{4k(t-s)}}\right)h(s)\,ds,\qquad \forall x>0}
  

Comment. This solution is the convolution with respect to the variable t of

  
    
      
        ψ
        (
        x
        ,
        t
        )
        :=
        −
        2
        k
        
          ∂
          
            x
          
        
        Φ
        (
        x
        ,
        t
        )
        =
        
          
            x
            
              4
              π
              k
              
                t
                
                  3
                
              
            
          
        
        exp
        ⁡
        
          (
          
            −
            
              
                
                  x
                  
                    2
                  
                
                
                  4
                  k
                  t
                
              
            
          
          )
        
      
    
    {\displaystyle \psi (x,t):=-2k\partial _{x}\Phi (x,t)={\frac {x}{\sqrt {4\pi kt^{3}}}}\exp \left(-{\frac {x^{2}}{4kt}}\right)}
  

and the function h(t). Since Φ(x, t) is the fundamental solution of

  
    
      
        
          ∂
          
            t
          
        
        −
        k
        
          ∂
          
            x
          
          
            2
          
        
        ,
      
    
    {\displaystyle \partial _{t}-k\partial _{x}^{2},}
  

the function ψ(x, t) is also a solution of the same heat equation, and so is u := ψ ∗ h, thanks to general properties of the convolution with respect to differentiation. Moreover,

  
    
      
        ψ
        (
        x
        ,
        t
        )
        =
        
          
            1
            
              x
              
                2
              
            
          
        
        
        ψ
        
          (
          
            1
            ,
            
              
                t
                
                  x
                  
                    2
                  
                
              
            
          
          )
        
      
    
    {\displaystyle \psi (x,t)={\frac {1}{x^{2}}}\,\psi \left(1,{\frac {t}{x^{2}}}\right)}
  

  
    
      
        
          ∫
          
            0
          
          
            ∞
          
        
        ψ
        (
        x
        ,
        t
        )
        
        d
        t
        =
        1
        ,
      
    
    {\displaystyle \int _{0}^{\infty }\psi (x,t)\,dt=1,}
  

so that, by general facts about approximation to the identity, ψ(x, ⋅) ∗ h → h as x → 0 in various senses, according to the specific h. For instance, if h is assumed continuous on R with support in [0, ∞) then ψ(x, ⋅) ∗ h converges uniformly on compacta to h as x → 0, meaning that u(x, t) is continuous on [0, ∞) × [0, ∞) with u(0, t) = h(t).


==== Inhomogeneous heat equation ====
Problem on (-∞,∞) homogeneous initial conditions

Comment. This solution is the convolution in R2, that is with respect to both the variables x and t, of the fundamental solution

  
    
      
        Φ
        (
        x
        ,
        t
        )
        :=
        
          
            1
            
              4
              π
              k
              t
            
          
        
        exp
        ⁡
        
          (
          
            −
            
              
                
                  x
                  
                    2
                  
                
                
                  4
                  k
                  t
                
              
            
          
          )
        
      
    
    {\displaystyle \Phi (x,t):={\frac {1}{\sqrt {4\pi kt}}}\exp \left(-{\frac {x^{2}}{4kt}}\right)}
  

and the function f(x, t), both meant as defined on the whole R2 and identically 0 for all t → 0. One verifies that

  
    
      
        
          (
          
            
              ∂
              
                t
              
            
            −
            k
            
              ∂
              
                x
              
              
                2
              
            
          
          )
        
        (
        Φ
        ∗
        f
        )
        =
        f
        ,
      
    
    {\displaystyle \left(\partial _{t}-k\partial _{x}^{2}\right)(\Phi *f)=f,}
  

which expressed in the language of distributions becomes

  
    
      
        
          (
          
            
              ∂
              
                t
              
            
            −
            k
            
              ∂
              
                x
              
              
                2
              
            
          
          )
        
        Φ
        =
        δ
        ,
      
    
    {\displaystyle \left(\partial _{t}-k\partial _{x}^{2}\right)\Phi =\delta ,}
  

where the distribution δ is the Dirac's delta function, that is the evaluation at 0.

Problem on (0,∞) with homogeneous Dirichlet boundary conditions and initial conditions

  
    
      
        
          
            {
            
              
                
                  
                    u
                    
                      t
                    
                  
                  =
                  k
                  
                    u
                    
                      x
                      x
                    
                  
                  +
                  f
                  (
                  x
                  ,
                  t
                  )
                
                
                  (
                  x
                  ,
                  t
                  )
                  ∈
                  [
                  0
                  ,
                  ∞
                  )
                  ×
                  (
                  0
                  ,
                  ∞
                  )
                
              
              
                
                  u
                  (
                  x
                  ,
                  0
                  )
                  =
                  0
                
                
                  
                    IC
                  
                
              
              
                
                  u
                  (
                  0
                  ,
                  t
                  )
                  =
                  0
                
                
                  
                    BC
                  
                
              
            
            
          
        
      
    
    {\displaystyle {\begin{cases}u_{t}=ku_{xx}+f(x,t)&(x,t)\in [0,\infty )\times (0,\infty )\\u(x,0)=0&{\text{IC}}\\u(0,t)=0&{\text{BC}}\end{cases}}}
  

  
    
      
        u
        (
        x
        ,
        t
        )
        =
        
          ∫
          
            0
          
          
            t
          
        
        
          ∫
          
            0
          
          
            ∞
          
        
        
          
            1
            
              4
              π
              k
              (
              t
              −
              s
              )
            
          
        
        
          (
          
            exp
            ⁡
            
              (
              
                −
                
                  
                    
                      (
                      x
                      −
                      y
                      
                        )
                        
                          2
                        
                      
                    
                    
                      4
                      k
                      (
                      t
                      −
                      s
                      )
                    
                  
                
              
              )
            
            −
            exp
            ⁡
            
              (
              
                −
                
                  
                    
                      (
                      x
                      +
                      y
                      
                        )
                        
                          2
                        
                      
                    
                    
                      4
                      k
                      (
                      t
                      −
                      s
                      )
                    
                  
                
              
              )
            
          
          )
        
        f
        (
        y
        ,
        s
        )
        
        d
        y
        
        d
        s
      
    
    {\displaystyle u(x,t)=\int _{0}^{t}\int _{0}^{\infty }{\frac {1}{\sqrt {4\pi k(t-s)}}}\left(\exp \left(-{\frac {(x-y)^{2}}{4k(t-s)}}\right)-\exp \left(-{\frac {(x+y)^{2}}{4k(t-s)}}\right)\right)f(y,s)\,dy\,ds}
  

Comment. This solution is obtained from the preceding formula as applied to the data f(x, t) suitably extended to R × [0,∞), so as to be an odd function of the variable x, that is, letting f(−x, t) := −f(x, t) for all x and t. Correspondingly, the solution of the inhomogeneous problem on (−∞,∞) is an odd function with respect to the variable x for all values of t, and in particular it satisfies the homogeneous Dirichlet boundary conditions u(0, t) = 0.

Problem on (0,∞) with homogeneous Neumann boundary conditions and initial conditions

  
    
      
        
          
            {
            
              
                
                  
                    u
                    
                      t
                    
                  
                  =
                  k
                  
                    u
                    
                      x
                      x
                    
                  
                  +
                  f
                  (
                  x
                  ,
                  t
                  )
                
                
                  (
                  x
                  ,
                  t
                  )
                  ∈
                  [
                  0
                  ,
                  ∞
                  )
                  ×
                  (
                  0
                  ,
                  ∞
                  )
                
              
              
                
                  u
                  (
                  x
                  ,
                  0
                  )
                  =
                  0
                
                
                  
                    IC
                  
                
              
              
                
                  
                    u
                    
                      x
                    
                  
                  (
                  0
                  ,
                  t
                  )
                  =
                  0
                
                
                  
                    BC
                  
                
              
            
            
          
        
      
    
    {\displaystyle {\begin{cases}u_{t}=ku_{xx}+f(x,t)&(x,t)\in [0,\infty )\times (0,\infty )\\u(x,0)=0&{\text{IC}}\\u_{x}(0,t)=0&{\text{BC}}\end{cases}}}
  

  
    
      
        u
        (
        x
        ,
        t
        )
        =
        
          ∫
          
            0
          
          
            t
          
        
        
          ∫
          
            0
          
          
            ∞
          
        
        
          
            1
            
              4
              π
              k
              (
              t
              −
              s
              )
            
          
        
        
          (
          
            exp
            ⁡
            
              (
              
                −
                
                  
                    
                      (
                      x
                      −
                      y
                      
                        )
                        
                          2
                        
                      
                    
                    
                      4
                      k
                      (
                      t
                      −
                      s
                      )
                    
                  
                
              
              )
            
            +
            exp
            ⁡
            
              (
              
                −
                
                  
                    
                      (
                      x
                      +
                      y
                      
                        )
                        
                          2
                        
                      
                    
                    
                      4
                      k
                      (
                      t
                      −
                      s
                      )
                    
                  
                
              
              )
            
          
          )
        
        f
        (
        y
        ,
        s
        )
        
        d
        y
        
        d
        s
      
    
    {\displaystyle u(x,t)=\int _{0}^{t}\int _{0}^{\infty }{\frac {1}{\sqrt {4\pi k(t-s)}}}\left(\exp \left(-{\frac {(x-y)^{2}}{4k(t-s)}}\right)+\exp \left(-{\frac {(x+y)^{2}}{4k(t-s)}}\right)\right)f(y,s)\,dy\,ds}
  

Comment. This solution is obtained from the first formula as applied to the data f(x, t) suitably extended to R × [0,∞), so as to be an even function of the variable x, that is, letting f(−x, t) := f(x, t) for all x and t. Correspondingly, the solution of the inhomogeneous problem on (−∞,∞) is an even function with respect to the variable x for all values of t, and in particular, being a smooth function, it satisfies the homogeneous Neumann boundary conditions ux(0, t) = 0.


==== Examples ====
Since the heat equation is linear, solutions of other combinations of boundary conditions, inhomogeneous term, and initial conditions can be found by taking an appropriate linear combination of the above Green's function solutions.
For example, to solve

  
    
      
        
          
            {
            
              
                
                  
                    u
                    
                      t
                    
                  
                  =
                  k
                  
                    u
                    
                      x
                      x
                    
                  
                  +
                  f
                
                
                  (
                  x
                  ,
                  t
                  )
                  ∈
                  
                    R
                  
                  ×
                  (
                  0
                  ,
                  ∞
                  )
                
              
              
                
                  u
                  (
                  x
                  ,
                  0
                  )
                  =
                  g
                  (
                  x
                  )
                
                
                  
                    IC
                  
                
              
            
            
          
        
      
    
    {\displaystyle {\begin{cases}u_{t}=ku_{xx}+f&(x,t)\in \mathbb {R} \times (0,\infty )\\u(x,0)=g(x)&{\text{IC}}\end{cases}}}
  

let u = w + v where w and v solve the problems

  
    
      
        
          
            {
            
              
                
                  
                    v
                    
                      t
                    
                  
                  =
                  k
                  
                    v
                    
                      x
                      x
                    
                  
                  +
                  f
                  ,
                  
                  
                    w
                    
                      t
                    
                  
                  =
                  k
                  
                    w
                    
                      x
                      x
                    
                  
                  
                
                
                  (
                  x
                  ,
                  t
                  )
                  ∈
                  
                    R
                  
                  ×
                  (
                  0
                  ,
                  ∞
                  )
                
              
              
                
                  v
                  (
                  x
                  ,
                  0
                  )
                  =
                  0
                  ,
                  
                  w
                  (
                  x
                  ,
                  0
                  )
                  =
                  g
                  (
                  x
                  )
                  
                
                
                  
                    IC
                  
                
              
            
            
          
        
      
    
    {\displaystyle {\begin{cases}v_{t}=kv_{xx}+f,\,w_{t}=kw_{xx}\,&(x,t)\in \mathbb {R} \times (0,\infty )\\v(x,0)=0,\,w(x,0)=g(x)\,&{\text{IC}}\end{cases}}}
  

Similarly, to solve

  
    
      
        
          
            {
            
              
                
                  
                    u
                    
                      t
                    
                  
                  =
                  k
                  
                    u
                    
                      x
                      x
                    
                  
                  +
                  f
                
                
                  (
                  x
                  ,
                  t
                  )
                  ∈
                  [
                  0
                  ,
                  ∞
                  )
                  ×
                  (
                  0
                  ,
                  ∞
                  )
                
              
              
                
                  u
                  (
                  x
                  ,
                  0
                  )
                  =
                  g
                  (
                  x
                  )
                
                
                  
                    IC
                  
                
              
              
                
                  u
                  (
                  0
                  ,
                  t
                  )
                  =
                  h
                  (
                  t
                  )
                
                
                  
                    BC
                  
                
              
            
            
          
        
      
    
    {\displaystyle {\begin{cases}u_{t}=ku_{xx}+f&(x,t)\in [0,\infty )\times (0,\infty )\\u(x,0)=g(x)&{\text{IC}}\\u(0,t)=h(t)&{\text{BC}}\end{cases}}}
  

let u = w + v + r where w, v, and r solve the problems

  
    
      
        
          
            {
            
              
                
                  
                    v
                    
                      t
                    
                  
                  =
                  k
                  
                    v
                    
                      x
                      x
                    
                  
                  +
                  f
                  ,
                  
                  
                    w
                    
                      t
                    
                  
                  =
                  k
                  
                    w
                    
                      x
                      x
                    
                  
                  ,
                  
                  
                    r
                    
                      t
                    
                  
                  =
                  k
                  
                    r
                    
                      x
                      x
                    
                  
                
                
                  (
                  x
                  ,
                  t
                  )
                  ∈
                  [
                  0
                  ,
                  ∞
                  )
                  ×
                  (
                  0
                  ,
                  ∞
                  )
                
              
              
                
                  v
                  (
                  x
                  ,
                  0
                  )
                  =
                  0
                  ,
                  
                  w
                  (
                  x
                  ,
                  0
                  )
                  =
                  g
                  (
                  x
                  )
                  ,
                  
                  r
                  (
                  x
                  ,
                  0
                  )
                  =
                  0
                
                
                  
                    IC
                  
                
              
              
                
                  v
                  (
                  0
                  ,
                  t
                  )
                  =
                  0
                  ,
                  
                  w
                  (
                  0
                  ,
                  t
                  )
                  =
                  0
                  ,
                  
                  r
                  (
                  0
                  ,
                  t
                  )
                  =
                  h
                  (
                  t
                  )
                
                
                  
                    BC
                  
                
              
            
            
          
        
      
    
    {\displaystyle {\begin{cases}v_{t}=kv_{xx}+f,\,w_{t}=kw_{xx},\,r_{t}=kr_{xx}&(x,t)\in [0,\infty )\times (0,\infty )\\v(x,0)=0,\;w(x,0)=g(x),\;r(x,0)=0&{\text{IC}}\\v(0,t)=0,\;w(0,t)=0,\;r(0,t)=h(t)&{\text{BC}}\end{cases}}}
  


== Applications ==
As the prototypical parabolic partial differential equation, the heat equation is among the most widely studied topics in pure mathematics, and its analysis is regarded as fundamental to the broader field of partial differential equations. The heat equation can also be considered on Riemannian manifolds, leading to many geometric applications. Following work of Subbaramiah Minakshisundaram and Åke Pleijel, the heat equation is closely related with spectral geometry. A seminal nonlinear variant of the heat equation was introduced to differential geometry by James Eells and Joseph Sampson in 1964, inspiring the introduction of the Ricci flow by Richard Hamilton in 1982 and culminating in the proof of the Poincaré conjecture by Grigori Perelman in 2003. Certain solutions of the heat equation known as heat kernels provide subtle information about the region on which they are defined, as exemplified through their application to the Atiyah–Singer index theorem.
The heat equation, along with variants thereof, is also important in many fields of science and applied mathematics. In probability theory, the heat equation is connected with the study of random walks and Brownian motion via the Fokker–Planck equation. The Black–Scholes equation of financial mathematics is a small variant of the heat equation, and the Schrödinger equation of quantum mechanics can be regarded as a heat equation in imaginary time. In image analysis, the heat equation is sometimes used to resolve pixelation and to identify edges. Following Robert Richtmyer and John von Neumann's introduction of artificial viscosity methods, solutions of heat equations have been useful in the mathematical formulation of hydrodynamical shocks. Solutions of the heat equation have also been given much attention in the numerical analysis literature, beginning in the 1950s with work of Jim Douglas, D.W. Peaceman, and Henry Rachford Jr.


=== Particle diffusion ===

One can model particle diffusion by an equation involving either: 

the volumetric concentration of particles, denoted c, in the case of collective diffusion of a large number of particles, or
the probability density function associated with the position of a single particle, denoted P.
In either case, one uses the heat equation

  
    
      
        
          c
          
            t
          
        
        =
        D
        Δ
        c
        ,
      
    
    {\displaystyle c_{t}=D\Delta c,}
  

or

  
    
      
        
          P
          
            t
          
        
        =
        D
        Δ
        P
        .
      
    
    {\displaystyle P_{t}=D\Delta P.}
  

Both c and P are functions of position and time. D is the diffusion coefficient that controls the speed of the diffusive process, and is typically expressed in meters squared over second.  If the diffusion coefficient D is not constant, but depends on the concentration c (or P in the second case), then one gets the nonlinear diffusion equation.


=== Brownian motion ===
Let the stochastic process 
  
    
      
        X
      
    
    {\displaystyle X}
  
 be the solution to the stochastic differential equation

  
    
      
        
          
            {
            
              
                
                  
                    d
                  
                  
                    X
                    
                      t
                    
                  
                  =
                  
                    
                      2
                      k
                    
                  
                  
                  
                    d
                  
                  
                    B
                    
                      t
                    
                  
                
              
              
                
                  
                    X
                    
                      0
                    
                  
                  =
                  0
                
              
            
            
          
        
      
    
    {\displaystyle {\begin{cases}\mathrm {d} X_{t}={\sqrt {2k}}\;\mathrm {d} B_{t}\\X_{0}=0\end{cases}}}
  

where 
  
    
      
        B
      
    
    {\displaystyle B}
  
 is the Wiener process (standard Brownian motion). The probability density function of 
  
    
      
        X
      
    
    {\displaystyle X}
  
 is given at any time 
  
    
      
        t
      
    
    {\displaystyle t}
  
 by

  
    
      
        
          
            1
            
              4
              π
              k
              t
            
          
        
        exp
        ⁡
        
          (
          
            −
            
              
                
                  x
                  
                    2
                  
                
                
                  4
                  k
                  t
                
              
            
          
          )
        
      
    
    {\displaystyle {\frac {1}{\sqrt {4\pi kt}}}\exp \left(-{\frac {x^{2}}{4kt}}\right)}
  

which is the solution to the initial value problem

  
    
      
        
          
            {
            
              
                
                  
                    u
                    
                      t
                    
                  
                  (
                  x
                  ,
                  t
                  )
                  −
                  k
                  
                    u
                    
                      x
                      x
                    
                  
                  (
                  x
                  ,
                  t
                  )
                  =
                  0
                  ,
                
                
                  (
                  x
                  ,
                  t
                  )
                  ∈
                  
                    R
                  
                  ×
                  (
                  0
                  ,
                  +
                  ∞
                  )
                
              
              
                
                  u
                  (
                  x
                  ,
                  0
                  )
                  =
                  δ
                  (
                  x
                  )
                
              
            
            
          
        
      
    
    {\displaystyle {\begin{cases}u_{t}(x,t)-ku_{xx}(x,t)=0,&(x,t)\in \mathbb {R} \times (0,+\infty )\\u(x,0)=\delta (x)\end{cases}}}
  

where 
  
    
      
        δ
      
    
    {\displaystyle \delta }
  
 is the Dirac delta function.


=== Schrödinger equation for a free particle ===

With a simple division, the Schrödinger equation for a single particle of mass m in the absence of any applied force field can be rewritten in the following way:

  
    
      
        
          ψ
          
            t
          
        
        =
        
          
            
              i
              ℏ
            
            
              2
              m
            
          
        
        Δ
        ψ
      
    
    {\displaystyle \psi _{t}={\frac {i\hbar }{2m}}\Delta \psi }
  
,
where i is the imaginary unit, ħ is the reduced Planck constant, and ψ is the wave function of the particle.
This equation is formally similar to the particle diffusion equation, which one obtains through the following transformation:

  
    
      
        
          
            
              
                c
                (
                
                  R
                
                ,
                t
                )
              
              
                
                →
                ψ
                (
                
                  R
                
                ,
                t
                )
              
            
            
              
                D
              
              
                
                →
                
                  
                    
                      i
                      ℏ
                    
                    
                      2
                      m
                    
                  
                
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}c(\mathbf {R} ,t)&\to \psi (\mathbf {R} ,t)\\D&\to {\frac {i\hbar }{2m}}\end{aligned}}}
  

Applying this transformation to the expressions of the Green functions determined in the case of particle diffusion yields the Green functions of the Schrödinger equation, which in turn can be used to obtain the wave function at any time through an integral on the wave function at t = 0:

  
    
      
        ψ
        (
        
          R
        
        ,
        t
        )
        =
        ∫
        ψ
        
          (
          
            
              
                R
              
              
                0
              
            
            ,
            t
            =
            0
          
          )
        
        G
        
          (
          
            
              R
            
            −
            
              
                R
              
              
                0
              
            
            ,
            t
          
          )
        
        d
        
          R
          
            x
          
          
            0
          
        
        
        d
        
          R
          
            y
          
          
            0
          
        
        
        d
        
          R
          
            z
          
          
            0
          
        
        ,
      
    
    {\displaystyle \psi (\mathbf {R} ,t)=\int \psi \left(\mathbf {R} ^{0},t=0\right)G\left(\mathbf {R} -\mathbf {R} ^{0},t\right)dR_{x}^{0}\,dR_{y}^{0}\,dR_{z}^{0},}
  

with

  
    
      
        G
        (
        
          R
        
        ,
        t
        )
        =
        
          
            (
            
              
                m
                
                  2
                  π
                  i
                  ℏ
                  t
                
              
            
            )
          
          
            3
            
              /
            
            2
          
        
        
          e
          
            −
            
              
                
                  
                    
                      R
                    
                    
                      2
                    
                  
                  m
                
                
                  2
                  i
                  ℏ
                  t
                
              
            
          
        
        .
      
    
    {\displaystyle G(\mathbf {R} ,t)=\left({\frac {m}{2\pi i\hbar t}}\right)^{3/2}e^{-{\frac {\mathbf {R} ^{2}m}{2i\hbar t}}}.}
  

Remark: this analogy between quantum mechanics and diffusion is a purely formal one. Physically, the evolution of the wave function satisfying the Schrödinger equation might have an origin other than diffusion.


=== Thermal diffusivity in polymers ===
A direct practical application of the heat equation, in conjunction with Fourier theory, in spherical coordinates, is the prediction of thermal transfer profiles and the measurement of the thermal diffusivity in polymers (Unsworth and Duarte). This dual theoretical-experimental method is applicable to rubber, various other polymeric materials of practical interest, and microfluids. These authors derived an expression for the temperature at the center of a sphere TC

  
    
      
        
          
            
              
                T
                
                  C
                
              
              −
              
                T
                
                  S
                
              
            
            
              
                T
                
                  0
                
              
              −
              
                T
                
                  S
                
              
            
          
        
        =
        2
        
          ∑
          
            n
            =
            1
          
          
            ∞
          
        
        (
        −
        1
        
          )
          
            n
            +
            1
          
        
        exp
        ⁡
        
          (
          
            −
            
              
                
                  
                    n
                    
                      2
                    
                  
                  
                    π
                    
                      2
                    
                  
                  α
                  t
                
                
                  L
                  
                    2
                  
                
              
            
          
          )
        
      
    
    {\displaystyle {\frac {T_{C}-T_{S}}{T_{0}-T_{S}}}=2\sum _{n=1}^{\infty }(-1)^{n+1}\exp \left({-{\frac {n^{2}\pi ^{2}\alpha t}{L^{2}}}}\right)}
  

where T0 is the initial temperature of the sphere and TS the temperature at the surface of the sphere, of radius L.  This equation has also found applications in protein energy transfer and thermal modeling in biophysics.


=== Financial Mathematics ===
The heat equation arises in a number of phenomena and is often used in financial mathematics in the modeling of options. The Black–Scholes option pricing model's differential equation can be transformed into the heat equation allowing relatively easy solutions from a familiar body of mathematics. Many of the extensions to the simple option models do not have closed form solutions and thus must be solved numerically to obtain a modeled option price. The equation describing pressure diffusion in a porous medium is identical in form with the heat equation. Diffusion problems dealing with Dirichlet, Neumann and Robin boundary conditions have closed form analytic solutions (Thambynayagam 2011).


=== Image Analysis ===
The heat equation is also widely used in image analysis (Perona & Malik 1990) and in machine learning as the driving theory behind scale-space or graph Laplacian methods. The heat equation can be efficiently solved numerically using the implicit Crank–Nicolson method of (Crank & Nicolson 1947). This method can be extended to many of the models with no closed form solution, see for instance (Wilmott, Howison & Dewynne 1995).


=== Riemannian geometry ===
An abstract form of heat equation on manifolds provides a major approach to the Atiyah–Singer index theorem, and has led to much further work on heat equations in Riemannian geometry.


== See also ==
Caloric polynomial
Curve-shortening flow
Diffusion equation
Parabolic partial differential equation
Relativistic heat conduction
Schrödinger equation
Weierstrass transform


== Notes ==


== References ==
Cannon, John Rozier (1984), The one–dimensional heat equation, Encyclopedia of Mathematics and its Applications, vol. 23, Reading, MA: Addison-Wesley Publishing Company, Advanced Book Program, ISBN 0-201-13522-1, MR 0747979, Zbl 0567.35001
Crank, J.; Nicolson, P. (1947), "A Practical Method for Numerical Evaluation of Solutions of Partial Differential Equations of the Heat-Conduction Type", Proceedings of the Cambridge Philosophical Society, 43 (1): 50–67, Bibcode:1947PCPS...43...50C, doi:10.1017/S0305004100023197, S2CID 16676040
Evans, Lawrence C. (2010), Partial Differential Equations, Graduate Studies in Mathematics, vol. 19 (2nd ed.), Providence, RI: American Mathematical Society, ISBN 978-0-8218-4974-3
Perona, P; Malik, J. (1990), "Scale-Space and Edge Detection Using Anisotropic Diffusion" (PDF), IEEE Transactions on Pattern Analysis and Machine Intelligence, 12 (7): 629–639, doi:10.1109/34.56205, S2CID 14502908
Thambynayagam, R. K. M. (2011), The Diffusion Handbook: Applied Solutions for Engineers, McGraw-Hill Professional, ISBN 978-0-07-175184-1
Wilmott, Paul; Howison, Sam; Dewynne, Jeff (1995), The mathematics of financial derivatives. A student introduction, Cambridge: Cambridge University Press, ISBN 0-521-49699-3


== Further reading ==
Carslaw, H.S.; Jaeger, J.C. (1988), Conduction of heat in solids, Oxford Science Publications (2nd ed.), New York: The Clarendon Press, Oxford University Press, ISBN 978-0-19-853368-9
Cole, Kevin D.; Beck, James V.; Haji-Sheikh, A.; Litkouhi, Bahan (2011), Heat conduction using Green's functions, Series in Computational and Physical Processes in Mechanics and Thermal Sciences (2nd ed.), Boca Raton, FL: CRC Press, ISBN 978-1-43-981354-6
Einstein, Albert (1905), "Über die von der molekularkinetischen Theorie der Wärme geforderte Bewegung von in ruhenden Flüssigkeiten suspendierten Teilchen" (PDF), Annalen der Physik, 322 (8): 549–560, Bibcode:1905AnP...322..549E, doi:10.1002/andp.19053220806
Friedman, Avner (1964), Partial differential equations of parabolic type, Englewood Cliffs, N.J.: Prentice-Hall
Unsworth, J.; Duarte, F. J. (1979), "Heat diffusion in a solid sphere and Fourier Theory", Am. J. Phys., 47 (11): 891–893, Bibcode:1979AmJPh..47..981U, doi:10.1119/1.11601
Jili, Latif M. (2009), Heat Conduction, Springer (3rd ed.), Berlin-Heidelberg: Springer-Verlag, ISBN 978-3-642-01266-2
Widder, D.V. (1975), The heat equation, Pure and Applied Mathematics, vol. 67, New York-London: Academic Press [Harcourt Brace Jovanovich, Publishers]


== External links ==

Derivation of the heat equation
Linear heat equations: Particular solutions and boundary value problems - from EqWorld
"The Heat Equation". PBS Infinite Series. November 17, 2017. Archived from the original on 2021-12-11 – via YouTube.