A Moran process or Moran model is a simple stochastic process used in biology to describe finite populations. The process is named after Patrick Moran, who first proposed the model in 1958. It can be used to model variety-increasing processes such as mutation as well as variety-reducing effects such as genetic drift and natural selection. The process can describe the probabilistic dynamics in a finite population of constant size N in which two alleles A and B are competing for dominance. The two alleles are considered to be true replicators (i.e. entities that make copies of themselves).
In each time step a random individual (which is of either type A or B) is chosen for reproduction and a random individual is chosen for death; thus ensuring that the population size remains constant. To model selection, one type has to have a higher fitness and is thus more likely to be chosen for reproduction.
The same individual can be chosen for death and for reproduction in the same step.


== Neutral drift ==
Neutral drift is the idea that a neutral mutation can spread throughout a population, so that eventually the original allele is lost. A neutral mutation does not bring any fitness advantage or disadvantage to its bearer. The simple case of the Moran process can describe this phenomenon.
The Moran process is defined on the state space i = 0, ..., N which count the number of A individuals. Since the number of A individuals can change at most by one at each time step, a transition exists only between state i and state i − 1, i and i + 1. Thus the transition matrix of the stochastic process is tri-diagonal in shape and the transition probabilities are

  
    
      
        
          
            
              
                
                  P
                  
                    i
                    ,
                    i
                    −
                    1
                  
                
              
              
                
                =
                
                  
                    
                      N
                      −
                      i
                    
                    N
                  
                
                
                  
                    i
                    N
                  
                
              
            
            
              
                
                  P
                  
                    i
                    ,
                    i
                  
                
              
              
                
                =
                1
                −
                
                  P
                  
                    i
                    ,
                    i
                    −
                    1
                  
                
                −
                
                  P
                  
                    i
                    ,
                    i
                    +
                    1
                  
                
              
            
            
              
                
                  P
                  
                    i
                    ,
                    i
                    +
                    1
                  
                
              
              
                
                =
                
                  
                    i
                    N
                  
                
                
                  
                    
                      N
                      −
                      i
                    
                    N
                  
                
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}P_{i,i-1}&={\frac {N-i}{N}}{\frac {i}{N}}\\P_{i,i}&=1-P_{i,i-1}-P_{i,i+1}\\P_{i,i+1}&={\frac {i}{N}}{\frac {N-i}{N}}\\\end{aligned}}}
  

The entry 
  
    
      
        
          P
          
            i
            ,
            j
          
        
      
    
    {\displaystyle P_{i,j}}
  
 denotes the probability to go from state i to state j. To understand the formulas for the transition probabilities one has to look at the definition of the process which states that always one individual will be chosen for reproduction and one is chosen for death. Once the A individuals have died out, they will never be reintroduced into the population since the process does not model mutations (A cannot be reintroduced into the population once it has died out and vice versa) and thus 
  
    
      
        
          P
          
            0
            ,
            0
          
        
        =
        1
      
    
    {\displaystyle P_{0,0}=1}
  
. For the same reason the population of A individuals will always stay N once they have reached that number and taken over the population and thus 
  
    
      
        
          P
          
            N
            ,
            N
          
        
        =
        1
      
    
    {\displaystyle P_{N,N}=1}
  
. The states 0 and N are called absorbing while the states 1, ..., N − 1 are called transient. The intermediate transition probabilities can be explained by considering the first term to be the probability to choose the individual whose abundance will increase by one and the second term the probability to choose the other type for death. Obviously, if the same type is chosen for reproduction and for death, then the abundance of one type does not change.
Eventually the population will reach one of the absorbing states and then stay there forever. In the transient states, random fluctuations will occur but eventually the population of A will either go extinct or reach fixation. This is one of the most important differences to deterministic processes which cannot model random events. The expected value and the variance of the number of A individuals X(t) at timepoint t can be computed when an initial state X(0) = i is given:

  
    
      
        
          
            
              
                E
                ⁡
                [
                X
                (
                t
                )
                ∣
                X
                (
                0
                )
                =
                i
                ]
              
              
                
                =
                i
              
            
            
              
                Var
                ⁡
                (
                X
                (
                t
                )
                ∣
                X
                (
                0
                )
                =
                i
                )
              
              
                
                =
                
                  
                    
                      
                        2
                        i
                      
                      N
                    
                  
                
                
                  (
                  
                    1
                    −
                    
                      
                        
                          i
                          N
                        
                      
                    
                  
                  )
                
                
                  
                    
                      1
                      −
                      
                        
                          (
                          
                            1
                            −
                            
                              
                                2
                                
                                  N
                                  
                                    2
                                  
                                
                              
                            
                          
                          )
                        
                        
                          t
                        
                      
                    
                    
                      2
                      
                        N
                        
                          2
                        
                      
                    
                  
                
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}\operatorname {E} [X(t)\mid X(0)=i]&=i\\\operatorname {Var} (X(t)\mid X(0)=i)&={\tfrac {2i}{N}}\left(1-{\tfrac {i}{N}}\right){\frac {1-\left(1-{\frac {2}{N^{2}}}\right)^{t}}{\frac {2}{N^{2}}}}\end{aligned}}}
  

The probability that A reaches fixation is called fixation probability. For the simple Moran process this probability is xi = ⁠i/N⁠.
Since all individuals have the same fitness, they also have the same chance of becoming the ancestor of the whole population; this probability is ⁠1/N⁠ and thus the sum of all i probabilities (for all A individuals) is just ⁠i/N⁠. The mean time to absorption starting in state i is given by

  
    
      
        
          k
          
            i
          
        
        =
        N
        
          [
          
            
              ∑
              
                j
                =
                1
              
              
                i
              
            
            
              
                
                  N
                  −
                  i
                
                
                  N
                  −
                  j
                
              
            
            +
            
              ∑
              
                j
                =
                i
                +
                1
              
              
                N
                −
                1
              
            
            
              
                i
                j
              
            
          
          ]
        
      
    
    {\displaystyle k_{i}=N\left[\sum _{j=1}^{i}{\frac {N-i}{N-j}}+\sum _{j=i+1}^{N-1}{\frac {i}{j}}\right]}
  

For large N the approximation

  
    
      
        
          lim
          
            N
            →
            ∞
          
        
        
          k
          
            i
          
        
        ≈
        −
        
          N
          
            2
          
        
        
          [
          
            (
            1
            −
            
              x
              
                i
              
            
            )
            ln
            ⁡
            (
            1
            −
            
              x
              
                i
              
            
            )
            +
            
              x
              
                i
              
            
            ln
            ⁡
            (
            
              x
              
                i
              
            
            )
          
          ]
        
      
    
    {\displaystyle \lim _{N\to \infty }k_{i}\approx -N^{2}\left[(1-x_{i})\ln(1-x_{i})+x_{i}\ln(x_{i})\right]}
  

holds.


== Selection ==
If one allele has a fitness advantage over the other allele, it will be more likely to be chosen for reproduction. This can be incorporated into the model if individuals with allele A have fitness 
  
    
      
        
          f
          
            i
          
        
        >
        0
      
    
    {\displaystyle f_{i}>0}
  
 and individuals with allele B have fitness 
  
    
      
        
          g
          
            i
          
        
        >
        0
      
    
    {\displaystyle g_{i}>0}
  
 where 
  
    
      
        i
      
    
    {\displaystyle i}
  
 is the number of individuals of type A; thus describing a general birth-death process. The transition matrix of the stochastic process is tri-diagonal in shape. Let 
  
    
      
        
          r
          
            i
          
        
        :=
        
          f
          
            i
          
        
        
          /
        
        
          g
          
            i
          
        
      
    
    {\displaystyle r_{i}:=f_{i}/g_{i}}
  
, then the transition probabilities are

  
    
      
        
          
            
              
                
                  P
                  
                    i
                    ,
                    i
                    −
                    1
                  
                
              
              
                
                =
                
                  
                    
                      
                        g
                        
                          i
                        
                      
                      ⋅
                      (
                      N
                      −
                      i
                      )
                    
                    
                      
                        f
                        
                          i
                        
                      
                      ⋅
                      i
                      +
                      
                        g
                        
                          i
                        
                      
                      ⋅
                      (
                      N
                      −
                      i
                      )
                    
                  
                
                ⋅
                
                  
                    i
                    N
                  
                
                =
                
                  
                    
                      
                        N
                        −
                        i
                      
                      N
                    
                    
                      
                        r
                        
                          i
                        
                      
                      ⋅
                      
                        
                          i
                          N
                        
                      
                      +
                      
                        
                          
                            N
                            −
                            i
                          
                          N
                        
                      
                    
                  
                
                ⋅
                
                  
                    i
                    N
                  
                
              
            
            
              
                
                  P
                  
                    i
                    ,
                    i
                  
                
              
              
                
                =
                1
                −
                
                  P
                  
                    i
                    ,
                    i
                    −
                    1
                  
                
                −
                
                  P
                  
                    i
                    ,
                    i
                    +
                    1
                  
                
              
            
            
              
                
                  P
                  
                    i
                    ,
                    i
                    +
                    1
                  
                
              
              
                
                =
                
                  
                    
                      
                        f
                        
                          i
                        
                      
                      ⋅
                      i
                    
                    
                      
                        f
                        
                          i
                        
                      
                      ⋅
                      i
                      +
                      
                        g
                        
                          i
                        
                      
                      ⋅
                      (
                      N
                      −
                      i
                      )
                    
                  
                
                ⋅
                
                  
                    
                      N
                      −
                      i
                    
                    N
                  
                
                =
                
                  
                    
                      
                        r
                        
                          i
                        
                      
                      ⋅
                      
                        
                          i
                          N
                        
                      
                    
                    
                      
                        r
                        
                          i
                        
                      
                      ⋅
                      
                        
                          i
                          N
                        
                      
                      +
                      
                        
                          
                            N
                            −
                            i
                          
                          N
                        
                      
                    
                  
                
                ⋅
                
                  
                    
                      N
                      −
                      i
                    
                    N
                  
                
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}P_{i,i-1}&={\frac {g_{i}\cdot (N-i)}{f_{i}\cdot i+g_{i}\cdot (N-i)}}\cdot {\frac {i}{N}}={\frac {\frac {N-i}{N}}{r_{i}\cdot {\frac {i}{N}}+{\frac {N-i}{N}}}}\cdot {\frac {i}{N}}\\P_{i,i}&=1-P_{i,i-1}-P_{i,i+1}\\P_{i,i+1}&={\frac {f_{i}\cdot i}{f_{i}\cdot i+g_{i}\cdot (N-i)}}\cdot {\frac {N-i}{N}}={\frac {r_{i}\cdot {\frac {i}{N}}}{r_{i}\cdot {\frac {i}{N}}+{\frac {N-i}{N}}}}\cdot {\frac {N-i}{N}}\\\end{aligned}}}
  

The entry 
  
    
      
        
          P
          
            i
            ,
            j
          
        
      
    
    {\displaystyle P_{i,j}}
  
 denotes the probability to go from state i to state j. The difference to neutral selection above is now that a mutant, i.e. an individual with allele A, is selected for procreation with probability

  
    
      
        
          
            
              
                r
                
                  i
                
              
              ⋅
              
                
                  i
                  N
                
              
            
            
              
                r
                
                  i
                
              
              ⋅
              
                
                  i
                  N
                
              
              +
              
                
                  
                    N
                    −
                    i
                  
                  i
                
              
            
          
        
        ,
      
    
    {\displaystyle {\frac {r_{i}\cdot {\frac {i}{N}}}{r_{i}\cdot {\frac {i}{N}}+{\frac {N-i}{i}}}},}
  

and an individual with allele B is chosen with probability

  
    
      
        
          
            
              
                N
                −
                i
              
              N
            
            
              
                r
                
                  i
                
              
              ⋅
              
                
                  i
                  N
                
              
              +
              
                
                  
                    N
                    −
                    i
                  
                  i
                
              
            
          
        
        ,
      
    
    {\displaystyle {\frac {\frac {N-i}{N}}{r_{i}\cdot {\frac {i}{N}}+{\frac {N-i}{i}}}},}
  

when the number of individuals with allele A is exactly i.
Also in this case, fixation probabilities when starting in state i is defined by the recurrence

  
    
      
        
          x
          
            i
          
        
        =
        
          
            {
            
              
                
                  0
                
                
                  i
                  =
                  0
                
              
              
                
                  
                    β
                    
                      i
                    
                  
                  
                    x
                    
                      i
                      −
                      1
                    
                  
                  +
                  (
                  1
                  −
                  
                    α
                    
                      i
                    
                  
                  −
                  
                    β
                    
                      i
                    
                  
                  )
                  
                    x
                    
                      i
                    
                  
                  +
                  
                    α
                    
                      i
                    
                  
                  
                    x
                    
                      i
                      +
                      1
                    
                  
                
                
                  1
                  ≤
                  i
                  ≤
                  N
                  −
                  1
                
              
              
                
                  1
                
                
                  i
                  =
                  N
                
              
            
            
          
        
      
    
    {\displaystyle x_{i}={\begin{cases}0&i=0\\\beta _{i}x_{i-1}+(1-\alpha _{i}-\beta _{i})x_{i}+\alpha _{i}x_{i+1}&1\leq i\leq N-1\\1&i=N\end{cases}}}
  

And the closed form is given by

  
    
      
        
          x
          
            i
          
        
        =
        
          
            
              1
              +
              
                ∑
                
                  j
                  =
                  1
                
                
                  i
                  −
                  1
                
              
              
                ∏
                
                  k
                  =
                  1
                
                
                  j
                
              
              
                γ
                
                  k
                
              
            
            
              1
              +
              
                ∑
                
                  j
                  =
                  1
                
                
                  N
                  −
                  1
                
              
              
                ∏
                
                  k
                  =
                  1
                
                
                  j
                
              
              
                γ
                
                  k
                
              
            
          
        
        
        
          (1)
        
      
    
    {\displaystyle x_{i}={\frac {\displaystyle 1+\sum _{j=1}^{i-1}\prod _{k=1}^{j}\gamma _{k}}{\displaystyle 1+\sum _{j=1}^{N-1}\prod _{k=1}^{j}\gamma _{k}}}\qquad {\text{(1)}}}
  

where 
  
    
      
        
          γ
          
            i
          
        
        =
        
          P
          
            i
            ,
            i
            −
            1
          
        
        
          /
        
        
          P
          
            i
            ,
            i
            +
            1
          
        
      
    
    {\displaystyle \gamma _{i}=P_{i,i-1}/P_{i,i+1}}
  
 per definition and will just be 
  
    
      
        
          g
          
            i
          
        
        
          /
        
        
          f
          
            i
          
        
      
    
    {\displaystyle g_{i}/f_{i}}
  
 for the general case.

This general case where the fitness of A and B depends on the abundance of each type is studied in evolutionary game theory.
Less complex results are obtained if a constant fitness ratio 
  
    
      
        r
        =
        1
        
          /
        
        
          γ
          
            i
          
        
      
    
    {\displaystyle r=1/\gamma _{i}}
  
, for all i, is assumed. Individuals of type A reproduce with a constant rate r and individuals with allele B reproduce with rate 1. Thus if A has a fitness advantage over B, r will be larger than one, otherwise it will be smaller than one. Thus the transition matrix of the stochastic process is tri-diagonal in shape and the transition probabilities are

  
    
      
        
          
            
              
                
                  P
                  
                    0
                    ,
                    0
                  
                
              
              
                
                =
                1
              
            
            
              
                
                  P
                  
                    i
                    ,
                    i
                    −
                    1
                  
                
              
              
                
                =
                
                  
                    
                      N
                      −
                      i
                    
                    
                      r
                      ⋅
                      i
                      +
                      N
                      −
                      i
                    
                  
                
                ⋅
                
                  
                    i
                    N
                  
                
                =
                
                  
                    
                      
                        N
                        −
                        i
                      
                      N
                    
                    
                      r
                      ⋅
                      
                        
                          i
                          N
                        
                      
                      +
                      
                        
                          
                            N
                            −
                            i
                          
                          N
                        
                      
                    
                  
                
                ⋅
                
                  
                    i
                    N
                  
                
              
            
            
              
                
                  P
                  
                    i
                    ,
                    i
                  
                
              
              
                
                =
                1
                −
                
                  P
                  
                    i
                    ,
                    i
                    −
                    1
                  
                
                −
                
                  P
                  
                    i
                    ,
                    i
                    +
                    1
                  
                
              
            
            
              
                
                  P
                  
                    i
                    ,
                    i
                    +
                    1
                  
                
              
              
                
                =
                
                  
                    
                      r
                      ⋅
                      i
                    
                    
                      r
                      ⋅
                      i
                      +
                      N
                      −
                      i
                    
                  
                
                ⋅
                
                  
                    
                      N
                      −
                      i
                    
                    N
                  
                
                =
                
                  
                    
                      r
                      ⋅
                      
                        
                          i
                          N
                        
                      
                    
                    
                      r
                      ⋅
                      
                        
                          i
                          N
                        
                      
                      +
                      
                        
                          
                            N
                            −
                            i
                          
                          N
                        
                      
                    
                  
                
                ⋅
                
                  
                    
                      N
                      −
                      i
                    
                    N
                  
                
              
            
            
              
                
                  P
                  
                    N
                    ,
                    N
                  
                
              
              
                
                =
                1.
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}P_{0,0}&=1\\P_{i,i-1}&={\frac {N-i}{r\cdot i+N-i}}\cdot {\frac {i}{N}}={\frac {\frac {N-i}{N}}{r\cdot {\frac {i}{N}}+{\frac {N-i}{N}}}}\cdot {\frac {i}{N}}\\P_{i,i}&=1-P_{i,i-1}-P_{i,i+1}\\P_{i,i+1}&={\frac {r\cdot i}{r\cdot i+N-i}}\cdot {\frac {N-i}{N}}={\frac {r\cdot {\frac {i}{N}}}{r\cdot {\frac {i}{N}}+{\frac {N-i}{N}}}}\cdot {\frac {N-i}{N}}\\P_{N,N}&=1.\end{aligned}}}
  

In this case 
  
    
      
        
          γ
          
            i
          
        
        =
        1
        
          /
        
        r
      
    
    {\displaystyle \gamma _{i}=1/r}
  
 is a constant factor for each composition of the population and thus the fixation probability from equation (1) simplifies to

  
    
      
        
          x
          
            i
          
        
        =
        
          
            
              1
              −
              
                r
                
                  −
                  i
                
              
            
            
              1
              −
              
                r
                
                  −
                  N
                
              
            
          
        
        
        ⇒
        
        
          x
          
            1
          
        
        =
        ρ
        =
        
          
            
              1
              −
              
                r
                
                  −
                  1
                
              
            
            
              1
              −
              
                r
                
                  −
                  N
                
              
            
          
        
        
        
          (2)
        
      
    
    {\displaystyle x_{i}={\frac {1-r^{-i}}{1-r^{-N}}}\quad \Rightarrow \quad x_{1}=\rho ={\frac {1-r^{-1}}{1-r^{-N}}}\qquad {\text{(2)}}}
  

where the fixation probability of a single mutant A in a population of otherwise all B is often of interest and is denoted by ρ.
Also in the case of selection, the expected value and the variance of the number of A individuals may be computed

  
    
      
        
          
            
              
                E
                ⁡
                [
                X
                (
                t
                )
                ∣
                X
                (
                t
                −
                1
                )
                =
                i
                ]
              
              
                
                =
                p
                s
                
                  
                    
                      
                        1
                        −
                        p
                      
                      
                        p
                        s
                        +
                        1
                      
                    
                  
                
                +
                i
              
            
            
              
                Var
                ⁡
                (
                X
                (
                t
                +
                1
                )
                ∣
                X
                (
                t
                )
                =
                i
                )
              
              
                
                =
                p
                (
                1
                −
                p
                )
                
                  
                    
                      
                        (
                        s
                        +
                        1
                        )
                        +
                        (
                        p
                        s
                        +
                        1
                        
                          )
                          
                            2
                          
                        
                      
                      
                        (
                        p
                        s
                        +
                        1
                        
                          )
                          
                            2
                          
                        
                      
                    
                  
                
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}\operatorname {E} [X(t)\mid X(t-1)=i]&=ps{\dfrac {1-p}{ps+1}}+i\\\operatorname {Var} (X(t+1)\mid X(t)=i)&=p(1-p){\dfrac {(s+1)+(ps+1)^{2}}{(ps+1)^{2}}}\end{aligned}}}
  

where p = ⁠i/N⁠, and r = 1 + s.


== Rate of evolution ==
In a population of all B individuals, a single mutant A will take over the whole population with the probability

  
    
      
        ρ
        =
        
          
            
              1
              −
              
                r
                
                  −
                  1
                
              
            
            
              1
              −
              
                r
                
                  −
                  N
                
              
            
          
        
        .
        
        
          (2)
        
      
    
    {\displaystyle \rho ={\frac {1-r^{-1}}{1-r^{-N}}}.\qquad {\text{(2)}}}
  

If the mutation rate (to go from the B to the A allele) in the population is u then the rate with which one member of the population will mutate to A is given by N × u and the rate with which the whole population goes from all B to all A is the rate that a single mutant A arises times the probability that it will take over the population (fixation probability):

  
    
      
        R
        =
        N
        ⋅
        u
        ⋅
        ρ
        =
        u
        
        
          if
        
        
        ρ
        =
        
          
            1
            N
          
        
        .
      
    
    {\displaystyle R=N\cdot u\cdot \rho =u\quad {\text{if}}\quad \rho ={\frac {1}{N}}.}
  

Thus if the mutation is neutral (i.e. the fixation probability is just 1/N) then the rate with which an allele arises and takes over a population is independent of the population size and is equal to the mutation rate. This important result is the basis of the neutral theory of evolution and suggests that the number of observed point mutations in the genomes of two different species would simply be given by the mutation rate multiplied by two times the time since divergence. Thus the neutral theory of evolution provides a molecular clock, given that the assumptions are fulfilled which may not be the case in reality.


== See also ==
Weak Selection


== References ==


== Further reading ==
Nowak, Martin A. (2006). Evolutionary Dynamics: Exploring the Equations of Life. Belknap Press. ISBN 978-0-674-02338-3.
Moran, Patrick Alfred Pierce (1962). The Statistical Processes of Evolutionary Theory. Oxford: Clarendon Press.


== External links ==
"Evolutionary Dynamics on Graphs".