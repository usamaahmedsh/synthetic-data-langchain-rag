In statistics, EM (expectation maximization) algorithm handles latent variables, while GMM is the Gaussian mixture model.


== Background ==
In the picture below, are shown the red blood cell hemoglobin concentration and the red blood cell volume data of two groups of people, the Anemia group and the Control Group (i.e. the group of people without Anemia). As expected, people with Anemia have lower red blood cell volume and lower red blood cell hemoglobin concentration than those without Anemia.

  
    
      
        x
      
    
    {\displaystyle x}
  
 is a random vector such as 
  
    
      
        x
        :=
        
          
            (
          
        
        
          red blood cell volume
        
        ,
        
          red blood cell hemoglobin concentration
        
        
          
            )
          
        
      
    
    {\displaystyle x:={\big (}{\text{red blood cell volume}},{\text{red blood cell hemoglobin concentration}}{\big )}}
  
, and from medical studies it is known that 
  
    
      
        x
      
    
    {\displaystyle x}
  
 are normally distributed in each group, i.e. 
  
    
      
        x
        ∼
        
          
            N
          
        
        (
        μ
        ,
        Σ
        )
      
    
    {\displaystyle x\sim {\mathcal {N}}(\mu ,\Sigma )}
  
.

  
    
      
        z
      
    
    {\displaystyle z}
  
 is denoted as the group where 
  
    
      
        x
      
    
    {\displaystyle x}
  
 belongs, with 
  
    
      
        
          z
          
            i
          
        
        =
        0
      
    
    {\displaystyle z_{i}=0}
  
 when 
  
    
      
        
          x
          
            i
          
        
      
    
    {\displaystyle x_{i}}
  
 belongs to Anemia Group and 
  
    
      
        
          z
          
            i
          
        
        =
        1
      
    
    {\displaystyle z_{i}=1}
  
 when 
  
    
      
        
          x
          
            i
          
        
      
    
    {\displaystyle x_{i}}
  
 belongs to Control Group. Also 
  
    
      
        z
        ∼
        Categorical
        ⁡
        (
        k
        ,
        ϕ
        )
      
    
    {\displaystyle z\sim \operatorname {Categorical} (k,\phi )}
  
 where 
  
    
      
        k
        =
        2
      
    
    {\displaystyle k=2}
  
, 
  
    
      
        
          ϕ
          
            j
          
        
        ≥
        0
        ,
      
    
    {\displaystyle \phi _{j}\geq 0,}
  
 and 
  
    
      
        
          ∑
          
            j
            =
            1
          
          
            k
          
        
        
          ϕ
          
            j
          
        
        =
        1
      
    
    {\displaystyle \sum _{j=1}^{k}\phi _{j}=1}
  
. See Categorical distribution.
The following procedure can be used to estimate 
  
    
      
        ϕ
        ,
        μ
        ,
        Σ
      
    
    {\displaystyle \phi ,\mu ,\Sigma }
  
.
A maximum likelihood estimation can be applied:

  
    
      
        ℓ
        (
        ϕ
        ,
        μ
        ,
        Σ
        )
        =
        
          ∑
          
            i
            =
            1
          
          
            m
          
        
        log
        ⁡
        (
        p
        (
        
          x
          
            (
            i
            )
          
        
        ;
        ϕ
        ,
        μ
        ,
        Σ
        )
        )
        =
        
          ∑
          
            i
            =
            1
          
          
            m
          
        
        log
        ⁡
        
          ∑
          
            
              z
              
                (
                i
                )
              
            
            =
            1
          
          
            k
          
        
        p
        
          (
          
            
              x
              
                (
                i
                )
              
            
            ∣
            
              z
              
                (
                i
                )
              
            
            ;
            μ
            ,
            Σ
          
          )
        
        p
        (
        
          z
          
            (
            i
            )
          
        
        ;
        ϕ
        )
      
    
    {\displaystyle \ell (\phi ,\mu ,\Sigma )=\sum _{i=1}^{m}\log(p(x^{(i)};\phi ,\mu ,\Sigma ))=\sum _{i=1}^{m}\log \sum _{z^{(i)}=1}^{k}p\left(x^{(i)}\mid z^{(i)};\mu ,\Sigma \right)p(z^{(i)};\phi )}
  

As the 
  
    
      
        
          z
          
            i
          
        
      
    
    {\displaystyle z_{i}}
  
 for each 
  
    
      
        
          x
          
            i
          
        
      
    
    {\displaystyle x_{i}}
  
 are known, the log likelihood function can be simplified as below:

  
    
      
        ℓ
        (
        ϕ
        ,
        μ
        ,
        Σ
        )
        =
        
          ∑
          
            i
            =
            1
          
          
            m
          
        
        log
        ⁡
        p
        
          (
          
            
              x
              
                (
                i
                )
              
            
            ∣
            
              z
              
                (
                i
                )
              
            
            ;
            μ
            ,
            Σ
          
          )
        
        +
        log
        ⁡
        p
        
          (
          
            
              z
              
                (
                i
                )
              
            
            ;
            ϕ
          
          )
        
      
    
    {\displaystyle \ell (\phi ,\mu ,\Sigma )=\sum _{i=1}^{m}\log p\left(x^{(i)}\mid z^{(i)};\mu ,\Sigma \right)+\log p\left(z^{(i)};\phi \right)}
  

Now the likelihood function can be maximized by making partial derivative over 
  
    
      
        μ
        ,
        Σ
        ,
        ϕ
      
    
    {\displaystyle \mu ,\Sigma ,\phi }
  
, obtaining:

  
    
      
        
          ϕ
          
            j
          
        
        =
        
          
            1
            m
          
        
        
          ∑
          
            i
            =
            1
          
          
            m
          
        
        1
        {
        
          z
          
            (
            i
            )
          
        
        =
        j
        }
      
    
    {\displaystyle \phi _{j}={\frac {1}{m}}\sum _{i=1}^{m}1\{z^{(i)}=j\}}
  

  
    
      
        
          μ
          
            j
          
        
        =
        
          
            
              
                ∑
                
                  i
                  =
                  1
                
                
                  m
                
              
              1
              {
              
                z
                
                  (
                  i
                  )
                
              
              =
              j
              }
              
                x
                
                  (
                  i
                  )
                
              
            
            
              
                ∑
                
                  i
                  =
                  1
                
                
                  m
                
              
              1
              
                {
                
                  
                    z
                    
                      (
                      i
                      )
                    
                  
                  =
                  j
                
                }
              
            
          
        
      
    
    {\displaystyle \mu _{j}={\frac {\sum _{i=1}^{m}1\{z^{(i)}=j\}x^{(i)}}{\sum _{i=1}^{m}1\left\{z^{(i)}=j\right\}}}}
  

  
    
      
        
          Σ
          
            j
          
        
        =
        
          
            
              
                ∑
                
                  i
                  =
                  1
                
                
                  m
                
              
              1
              {
              
                z
                
                  (
                  i
                  )
                
              
              =
              j
              }
              (
              
                x
                
                  (
                  i
                  )
                
              
              −
              
                μ
                
                  j
                
              
              )
              (
              
                x
                
                  (
                  i
                  )
                
              
              −
              
                μ
                
                  j
                
              
              
                )
                
                  T
                
              
            
            
              
                ∑
                
                  i
                  =
                  1
                
                
                  m
                
              
              1
              {
              
                z
                
                  (
                  i
                  )
                
              
              =
              j
              }
            
          
        
      
    
    {\displaystyle \Sigma _{j}={\frac {\sum _{i=1}^{m}1\{z^{(i)}=j\}(x^{(i)}-\mu _{j})(x^{(i)}-\mu _{j})^{T}}{\sum _{i=1}^{m}1\{z^{(i)}=j\}}}}
  

If 
  
    
      
        
          z
          
            i
          
        
      
    
    {\displaystyle z_{i}}
  
 is known, the estimation of the parameters results to be quite simple with maximum likelihood estimation. But if 
  
    
      
        
          z
          
            i
          
        
      
    
    {\displaystyle z_{i}}
  
 is unknown it is much more complicated.

Being 
  
    
      
        z
      
    
    {\displaystyle z}
  
 a latent variable (i.e. not observed), with unlabeled scenario, the Expectation Maximization Algorithm is needed to estimate 
  
    
      
        z
      
    
    {\displaystyle z}
  
 as well as other parameters. Generally, this problem is set as a GMM since the data in each group is normally distributed.

In machine learning, the latent variable 
  
    
      
        z
      
    
    {\displaystyle z}
  
 is considered as a latent pattern lying under the data, which the observer is not able to see very directly.  
  
    
      
        
          x
          
            i
          
        
      
    
    {\displaystyle x_{i}}
  
 is the known data, while 
  
    
      
        ϕ
        ,
        μ
        ,
        Σ
      
    
    {\displaystyle \phi ,\mu ,\Sigma }
  
 are the parameter of the model. With the EM algorithm, some underlying pattern 
  
    
      
        z
      
    
    {\displaystyle z}
  
 in the data 
  
    
      
        
          x
          
            i
          
        
      
    
    {\displaystyle x_{i}}
  
 can be found, along with the estimation of the parameters. The wide application of this circumstance in machine learning is what makes EM algorithm so important.


== EM algorithm in GMM ==
The EM algorithm consists of two steps: the E-step and the M-step. Firstly, the model parameters and the 
  
    
      
        
          z
          
            (
            i
            )
          
        
      
    
    {\displaystyle z^{(i)}}
  
 can be randomly initialized. In the E-step, the algorithm tries to guess the value of 
  
    
      
        
          z
          
            (
            i
            )
          
        
      
    
    {\displaystyle z^{(i)}}
  
 based on the parameters, while in the M-step, the algorithm updates the value of the model parameters based on the guess of 
  
    
      
        
          z
          
            (
            i
            )
          
        
      
    
    {\displaystyle z^{(i)}}
  
of the E-step. These two steps are repeated until convergence is reached.
The algorithm in GMM is:
Repeat until convergence:

   1. (E-step) For each 
  
    
      
        i
        ,
        j
      
    
    {\displaystyle i,j}
  
, set
   
  
    
      
        
          w
          
            j
          
          
            (
            i
            )
          
        
        :=
        p
        
          (
          
            
              z
              
                (
                i
                )
              
            
            =
            j
            
              |
            
            
              x
              
                (
                i
                )
              
            
            ;
            ϕ
            ,
            μ
            ,
            Σ
          
          )
        
      
    
    {\displaystyle w_{j}^{(i)}:=p\left(z^{(i)}=j|x^{(i)};\phi ,\mu ,\Sigma \right)}
  

   2. (M-step) Update the parameters
   
  
    
      
        
          ϕ
          
            j
          
        
        :=
        
          
            1
            m
          
        
        
          ∑
          
            i
            =
            1
          
          
            m
          
        
        
          w
          
            j
          
          
            (
            i
            )
          
        
      
    
    {\displaystyle \phi _{j}:={\frac {1}{m}}\sum _{i=1}^{m}w_{j}^{(i)}}
  

      
  
    
      
        
          μ
          
            j
          
        
        :=
        
          
            
              
                ∑
                
                  i
                  =
                  1
                
                
                  m
                
              
              
                w
                
                  j
                
                
                  (
                  i
                  )
                
              
              
                x
                
                  (
                  i
                  )
                
              
            
            
              
                ∑
                
                  i
                  =
                  1
                
                
                  m
                
              
              
                w
                
                  j
                
                
                  (
                  i
                  )
                
              
            
          
        
      
    
    {\displaystyle \mu _{j}:={\frac {\sum _{i=1}^{m}w_{j}^{(i)}x^{(i)}}{\sum _{i=1}^{m}w_{j}^{(i)}}}}
  

      
  
    
      
        
          Σ
          
            j
          
        
        :=
        
          
            
              
                ∑
                
                  i
                  =
                  1
                
                
                  m
                
              
              
                w
                
                  j
                
                
                  (
                  i
                  )
                
              
              
                (
                
                  
                    x
                    
                      (
                      i
                      )
                    
                  
                  −
                  
                    μ
                    
                      j
                    
                  
                
                )
              
              
                
                  (
                  
                    
                      x
                      
                        (
                        i
                        )
                      
                    
                    −
                    
                      μ
                      
                        j
                      
                    
                  
                  )
                
                
                  T
                
              
            
            
              
                ∑
                
                  i
                  =
                  1
                
                
                  m
                
              
              
                w
                
                  j
                
                
                  (
                  i
                  )
                
              
            
          
        
      
    
    {\displaystyle \Sigma _{j}:={\frac {\sum _{i=1}^{m}w_{j}^{(i)}\left(x^{(i)}-\mu _{j}\right)\left(x^{(i)}-\mu _{j}\right)^{T}}{\sum _{i=1}^{m}w_{j}^{(i)}}}}
  

With Bayes Rule, the following result is obtained by the E-step:

  
    
      
        p
        
          (
          
            
              z
              
                (
                i
                )
              
            
            =
            j
            
              |
            
            
              x
              
                (
                i
                )
              
            
            ;
            ϕ
            ,
            μ
            ,
            Σ
          
          )
        
        =
        
          
            
              p
              
                (
                
                  
                    x
                    
                      (
                      i
                      )
                    
                  
                  
                    |
                  
                  
                    z
                    
                      (
                      i
                      )
                    
                  
                  =
                  j
                  ;
                  μ
                  ,
                  Σ
                
                )
              
              p
              
                (
                
                  
                    z
                    
                      (
                      i
                      )
                    
                  
                  =
                  j
                  ;
                  ϕ
                
                )
              
            
            
              
                ∑
                
                  l
                  =
                  1
                
                
                  k
                
              
              p
              
                (
                
                  
                    x
                    
                      (
                      i
                      )
                    
                  
                  
                    |
                  
                  
                    z
                    
                      (
                      i
                      )
                    
                  
                  =
                  l
                  ;
                  μ
                  ,
                  Σ
                
                )
              
              p
              
                (
                
                  
                    z
                    
                      (
                      i
                      )
                    
                  
                  =
                  l
                  ;
                  ϕ
                
                )
              
            
          
        
      
    
    {\displaystyle p\left(z^{(i)}=j|x^{(i)};\phi ,\mu ,\Sigma \right)={\frac {p\left(x^{(i)}|z^{(i)}=j;\mu ,\Sigma \right)p\left(z^{(i)}=j;\phi \right)}{\sum _{l=1}^{k}p\left(x^{(i)}|z^{(i)}=l;\mu ,\Sigma \right)p\left(z^{(i)}=l;\phi \right)}}}
  

According to GMM setting, these following formulas are obtained:

  
    
      
        p
        
          (
          
            
              x
              
                (
                i
                )
              
            
            
              |
            
            
              z
              
                (
                i
                )
              
            
            =
            j
            ;
            μ
            ,
            Σ
          
          )
        
        =
        
          
            1
            
              (
              2
              π
              
                )
                
                  n
                  
                    /
                  
                  2
                
              
              
                
                  |
                  
                    Σ
                    
                      j
                    
                  
                  |
                
                
                  1
                  
                    /
                  
                  2
                
              
            
          
        
        exp
        ⁡
        
          (
          
            −
            
              
                1
                2
              
            
            
              
                (
                
                  
                    x
                    
                      (
                      i
                      )
                    
                  
                  −
                  
                    μ
                    
                      j
                    
                  
                
                )
              
              
                T
              
            
            
              Σ
              
                j
              
              
                −
                1
              
            
            
              (
              
                
                  x
                  
                    (
                    i
                    )
                  
                
                −
                
                  μ
                  
                    j
                  
                
              
              )
            
          
          )
        
      
    
    {\displaystyle p\left(x^{(i)}|z^{(i)}=j;\mu ,\Sigma \right)={\frac {1}{(2\pi )^{n/2}\left|\Sigma _{j}\right|^{1/2}}}\exp \left(-{\frac {1}{2}}\left(x^{(i)}-\mu _{j}\right)^{T}\Sigma _{j}^{-1}\left(x^{(i)}-\mu _{j}\right)\right)}
  

  
    
      
        p
        
          (
          
            
              z
              
                (
                i
                )
              
            
            =
            j
            ;
            ϕ
          
          )
        
        =
        
          ϕ
          
            j
          
        
      
    
    {\displaystyle p\left(z^{(i)}=j;\phi \right)=\phi _{j}}
  

In this way, a switch between the E-step and the M-step is possible, according to the randomly initialized parameters.


== References ==