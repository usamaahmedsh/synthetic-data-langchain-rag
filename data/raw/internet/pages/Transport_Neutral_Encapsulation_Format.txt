Transport Neutral Encapsulation Format or TNEF is a proprietary email attachment format used by Microsoft Outlook and Microsoft Exchange Server. An attached file with TNEF encoding is most often named winmail.dat or win.dat, and has a MIME type of Application/MS-TNEF.
The official (IANA) media type, however, is application/vnd.ms-tnef.


== Overview ==
Some TNEF files contain information used only by Outlook to generate a richly formatted view of the message, such as embedded (OLE) documents or Outlook-specific features such as forms, voting buttons, and meeting requests. Other TNEF files may contain files which have been attached to an e-mail message.
Within the Outlook e-mail client, TNEF encoding cannot be explicitly enabled or disabled (except via a registry setting). Selecting RTF as the format for sending an e-mail implicitly enables TNEF encoding, using it instead of the more common and widely compatible MIME standard. When sending plain text or HTML format messages, some versions of Outlook (apparently including Outlook 2000) prefer MIME, but may still use TNEF under some circumstances (for example, if an Outlook feature requires it).
TNEF attachments can contain security-sensitive information such as user login name and file paths, from which access controls could possibly be inferred.


== Exchange Server ==

Native-mode Microsoft Exchange 2000 organizations will, in some circumstances, send entire messages as TNEF-encoded raw binary independent of what is advertised by the receiving SMTP server. As documented in Microsoft KBA #323483, this technique is not RFC-compliant because these messages have the following characteristics:

They may include non-ASCII characters outside the 0–127 US-ASCII range.
The lines in these messages are often too long for transport via SMTP.
They do not follow the CRLF.CRLF message termination semantics as specified in RFC 821.
Internal communications between Exchange Servers (2000 and later) over SMTP encode the message in S/TNEF (Summary TNEF) format. The conversion between the format needed by the end client on the Internet is performed on the last Hub Transport server before final delivery, and when the Hub Transport role of an Exchange Server is about to deliver the message to a mailbox role server, the message is converted to MAPI format for storage.
S/TNEF differs from TNEF in that it is 8-bit (not 7-bit for TNEF) and does not contain a plain-text portion.


== Decoding ==
Programs to decode and extract files from TNEF-encoded attachments are available on many platforms.


=== Multiplatform ===
Geary (email client) supports TNEF since version 3.33.1
TNEF Parse – Claws Mail plugin
LookOut or its successor LookOut (fix version) – Mozilla Thunderbird extension. See also:
LookOut project page at MozDev.org
Bug 77811 – Inline viewer for Microsoft proprietary mail formats, a 21-plus-year-old bug report at the Mozilla Bugzilla
Wireshark – Version 1.2 and later can open and dissect winmail.dat files, although it is not useful as a mail reader
KTNEF – LGPL TNEF extractor by KDE


=== Unix-like or POSIX command-line ===
yTNEF – GPL TNEF extractor from the POSIX command-line, designed specifically for reading winmail.dat
TNEF – GPL TNEF extractor from the POSIX command-line


=== Mac ===
Klammer – Shareware for Mac OS X, available on App store; also supports MSG files
MailRaider Pro - Application for Mac OS X, available on App store; also supports MSG files
Winmail Viewer – Shareware Winmail.dat viewer for Mac OS X 10.6 or later, available on App Store, support open Microsoft Outlook (1997, 2000, 2003, 2007, 2010). Winmail.dat files, can extract and save Winmail.dat attachments
TNEF's Enough – Freeware decoder for Mac OS 9 and Mac OS X
tnefDD – Free GPL decoder with drag-and-drop functionality for Mac OS X
TNEF – MacPorts version of the TNEF command-line decoder Mac OS X
Letter Opener (previously known as OMiC) – Shareware, plugin for Apple Mail


=== iPhone and iPad ===
Winmail File Viewer – Paid universal app for the iPhone, iPod Touch and iPad to open winmail.dat attachments with option to save and share extracted files
WinMail.dat Viewer - Browse Outlook winmail.dat files – Paid universal app for the iPhone, iPod Touch and iPad to open winmail.dat attachments with option to view, save and share extracted files
Winmail File Viewer+ – Paid universal app for the iPhone, iPod Touch and iPad to open winmail.dat attachments with option to save and share extracted files
Klammer - open EML, MSG and Winmail.dat files – Paid universal app for the iPhone, iPod Touch and iPad with in-app purchase to provide functionality
WinDat Opener – Paid app for the iPhone, iPod Touch and iPad
Letter Opener – Free Universal app for the iPhone, iPod Touch and iPad with in-app purchase to provide functionality
TNEF's Enough - Free Universal app for iPhone, iPod Touch, and iPad


=== Microsoft Windows ===
Winmail.dat Reader – Freeware easy-to-use decoder
Winmail Opener – Freeware decoder
tnef2win – Freeware decoder
Free File Viewer – Freeware decoder
fentun – Freeware decoder
Winmail.dat Viewer – modern Windows 8 app (non-free)


=== Android ===
TNEF Extractor – A free and open source (GPLv3) Android app
Opener – A free Android app
Reader - Free Android app also available


=== Online ===
winmail.dat extractor and document converter – Free, in modern, responsive theme
Reader Online – The online version of the Winmail.dat Reader (free)
tud.at service – Web service and GPL licensed PHP script for reading attachments in winmail.dat files
www.winmaildat.com – Another online winmail.dat extractor which allows to upload up to 5 MB
the-computer-site.com – converts winmail.dat file to a zip file


=== Software libraries ===
JTNEF – GPL Java TNEF package
POI-HMEF – Java library of the Apache POI project
MVCOM – Commercial COM component to parse TNEF
Convert::TNEF – TNEF library written in Perl
tnefparse library – TNEF access library written in Python, licensed under LGPL
Aspose Email – Commercial Java and .NET library that can parse and extract TNEF data
EAGetMail Component – Commercial .NET and ActiveX library that can parse and extract TNEF data
node-tnef - NodeJS command line tool/library that can parse and extract TNEF data
libytnef – GPL TNEF extractor library written in C
MimeKit – A .NET MIME creation and parser library with support for TNEF
TNEF Decoder - A PHP Library to extract TNEF


== References ==


== External links ==
Specification:
"M-OXTNEF: Transport Neutral Encapsulation Format (TNEF) Data Algorithm" - MS-TNEF format specifications
Microsoft Support:
"How message format affects email messages" - How to disable TNEF in Outlook for Windows
"Description of Transport Neutral Encapsulation Format (TNEF) in Outlook 2000" - How to disable TNEF in Outlook 2000
"How to configure Internet e-mail message formats at the user and the domain levels in Exchange Server 2003" - Includes instructions on disabling TNEF
Other:
"Microsoft Outlook MS-TNEF handling (aka Winmail.dat or 'Part 1.2' problem of unopenable email attachments)"