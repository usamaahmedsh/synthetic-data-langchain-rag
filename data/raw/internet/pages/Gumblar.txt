Gumblar is a malicious JavaScript trojan horse file that redirects a user's Google searches, and then installs rogue security software.  Also known as Troj/JSRedir-R this botnet first appeared in 2009. 


== Infection ==


=== Windows Personal Computers ===
Gumblar.X infections were widely seen on systems running newer MacOS operating systems.  Visitors to an infected site will be redirected to an alternative site containing further malware. Initially, this alternative site was gumblar.cn, but it has since switched to a variety of domains. The site sends the visitor an infected PDF that is opened by the visitor's browser or Acrobat Reader. The PDF will then exploit a known vulnerability in Acrobat to gain access to the user's computer. Newer variations of Gumblar redirect users to sites running fake anti-virus software.
The virus will find FTP clients such as FileZilla and Dreamweaver and download the clients' stored passwords. Gumblar also enables promiscuous mode on the network card, allowing it to sniff local network traffic for FTP details. It is one of the first viruses to incorporate an automated packet analyzer.


=== Servers ===
Using passwords obtained from site admins, the host site will access a website via FTP and infect that website. It will download large portions of the website and inject malicious code into the website's files before uploading the files back onto the server. The code is inserted in any file that contains a <body> tag, such as HTML, PHP, JavaScript, ASP and ASPx files. The inserted PHP code contains base64-encoded JavaScript that will infect computers that execute the code. In addition, some pages may have inline frames inserted into them. Typically, iframe code contains hidden links to malicious websites.
The virus will also modify .htaccess and HOSTS files, and create images.php files in directories named 'images'. The infection is not a server-wide exploit. It will only infect sites on the server that it has passwords to.


== Gumblar variants ==
Different companies use different names for Gumblar and variants. Initially, the malware was connecting to gumblar.cn domain but this server was shut down in May 2009. However, many badware variants have emerged after that and they connect to other malicious servers via iframe code.
Gumblar resurfaced in January 2010, stealing FTP usernames and passwords and infecting HTML, PHP and JavaScript files on webservers to help spread itself. This time it used multiple domains, making it harder to detect/stop.


== See also ==
E-mail spam

Malware


== References ==


== External links ==
Staff (15 May 2009). "New computer virus on rise, warn security experts". The Telegraph (London). Archived from the original on 18 May 2009. Retrieved 2009-07-07.
Leyden, John (19 May 2009). "Gumblar Google-poisoning attack morphs". The Register. Retrieved 2009-07-07.