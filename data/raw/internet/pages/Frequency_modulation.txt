Frequency modulation (FM) is a  signal modulation technique used in electronic communication, originally for transmitting messages with a radio wave. In frequency modulation a carrier wave is varied in its instantaneous frequency in proportion to a property, primarily the instantaneous amplitude, of a message signal, such as an audio signal. The technology is used in telecommunications, radio broadcasting, signal processing, and computing.
In analog frequency modulation, such as radio broadcasting of voice and music, the instantaneous frequency deviation, i.e. the difference between the frequency of the carrier and its center frequency, has a functional relation to the modulating signal amplitude.
Digital data can be encoded and transmitted with a type of frequency modulation known as frequency-shift keying (FSK), in which the instantaneous frequency of the carrier is shifted among a set of frequencies. The frequencies may represent digits, such as 0 and 1. FSK is widely used in computer modems such as fax modems, telephone caller ID systems, garage door openers, and other low-frequency transmissions. Radioteletype also uses FSK.
Frequency modulation is widely used for FM radio broadcasting. It is also used in telemetry, radar, seismic prospecting, and monitoring newborns for seizures via EEG, two-way radio systems, sound synthesis, magnetic tape-recording systems and some video-transmission systems. In radio transmission, an advantage of frequency modulation is that it has a larger signal-to-noise ratio and therefore rejects radio frequency interference better than an equal power amplitude modulation (AM) signal. For this reason, most music is broadcast over FM radio.
Frequency modulation and phase modulation are the two complementary principal methods of angle modulation; phase modulation is often used as an intermediate step to achieve frequency modulation. These methods contrast with amplitude modulation, in which the amplitude of the carrier wave varies, while the frequency and phase remain constant.


== FM Signal ==
According to Paul Nahin, "To apply the baseband signal of a microphone output directly to the transmitter antenna won't work, because ...a quarter-wavelength antenna at audio frequencies is physically enormous. To have a reasonably sized antenna requires a transmitter signal at frequencies considerably higher than those of the bandwidth spectrum; that is, the baseband spectrum must be upshifted to the radio frequencies." This is called signal modulation. According to Ron Bertrand, "Frequency modulation is a method of modulating a carrier wave whereby the modulating audio causes the instantaneous frequency of the carrier to change. Without modulation, an FM transmitter produces a single carrier frequency."
The FM signal produced by a sinusoidal carrier of frequency ωc, modulated by an audio tone of frequency ωa with amplitude A, can be written as:

  
    
      
        
          
            
              
                e
                (
                t
                )
              
              
                
                =
                sin
                ⁡
                
                  (
                  
                    
                      ω
                      
                        c
                      
                    
                    t
                    +
                    k
                    A
                    sin
                    ⁡
                    
                      (
                      
                        
                          ω
                          
                            a
                          
                        
                        t
                      
                      )
                    
                  
                  )
                
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}e(t)&=\sin \left(\omega _{c}t+kA\sin \left(\omega _{a}t\right)\right)\\\end{aligned}}}
  

We need the  instantaneous frequency, which describes a frequency varying above and below the carrier frequency at the audio tone frequency, which we derive by using Carson's time derivative method:

  
    
      
        
          
            
              
                
                  
                    d
                    
                      d
                      t
                    
                  
                
                
                  (
                  
                    
                      ω
                      
                        c
                      
                    
                    t
                    +
                    k
                    A
                    sin
                    ⁡
                    
                      (
                      
                        
                          ω
                          
                            a
                          
                        
                        t
                      
                      )
                    
                  
                  )
                
              
              
                
                =
                
                  ω
                  
                    c
                  
                
                +
                k
                A
                
                  ω
                  
                    a
                  
                
                cos
                ⁡
                
                  (
                  
                    
                      ω
                      
                        a
                      
                    
                    t
                  
                  )
                
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}{\frac {d}{dt}}\left(\omega _{c}t+kA\sin \left(\omega _{a}t\right)\right)&=\omega _{c}+kA\omega _{a}\cos \left(\omega _{a}t\right)\\\end{aligned}}}
  

The amplitude factor kAωa defines the maximum Frequency deviation around ωc. Dividing by ωa, gives us the modulation index kA, which "is the ratio of the amount of frequency deviation to the audio modulating frequency."
While most of the energy of the signal is contained within fc ± fΔ, it can be shown by Fourier analysis that a wider range of frequencies is required to precisely represent an FM signal. The frequency spectrum of an actual FM signal has components extending infinitely, although their amplitude decreases and higher-order components are often neglected in practical design problems.


== Sinusoidal baseband signal ==
Mathematically, a baseband modulating signal may be approximated by a sinusoidal continuous wave signal with a frequency fm. This method is also named as single-tone modulation. The integral of such a signal 
  
    
      
        
          x
          
            m
          
        
        (
        t
        )
        =
        c
        o
        s
        (
        2
        π
        
          f
          
            m
          
        
        t
        )
      
    
    {\displaystyle x_{m}(t)=cos(2\pi f_{m}t)}
  
 is:

  
    
      
        
          ∫
          
            0
          
          
            t
          
        
        
          x
          
            m
          
        
        (
        τ
        )
        d
        τ
        =
        
          
            
              sin
              ⁡
              
                (
                
                  2
                  π
                  
                    f
                    
                      m
                    
                  
                  t
                
                )
              
            
            
              2
              π
              
                f
                
                  m
                
              
            
          
        
        
      
    
    {\displaystyle \int _{0}^{t}x_{m}(\tau )d\tau ={\frac {\sin \left(2\pi f_{m}t\right)}{2\pi f_{m}}}\,}
  

In this case, the expression for y(t) above simplifies to:

  
    
      
        y
        (
        t
        )
        =
        
          A
          
            c
          
        
        cos
        ⁡
        
          (
          
            2
            π
            
              f
              
                c
              
            
            t
            +
            
              
                
                  f
                  
                    Δ
                  
                
                
                  f
                  
                    m
                  
                
              
            
            sin
            ⁡
            
              (
              
                2
                π
                
                  f
                  
                    m
                  
                
                t
              
              )
            
          
          )
        
        
      
    
    {\displaystyle y(t)=A_{c}\cos \left(2\pi f_{c}t+{\frac {f_{\Delta }}{f_{m}}}\sin \left(2\pi f_{m}t\right)\right)\,}
  

where the amplitude 
  
    
      
        
          A
          
            m
          
        
        
      
    
    {\displaystyle A_{m}\,}
  
 of the modulating sinusoid is represented in the peak deviation 
  
    
      
        
          f
          
            Δ
          
        
        =
        
          K
          
            f
          
        
        
          A
          
            m
          
        
      
    
    {\displaystyle f_{\Delta }=K_{f}A_{m}}
  
 (see frequency deviation).
The harmonic distribution of a sine wave carrier modulated by such a sinusoidal signal can be represented with Bessel functions; this provides the basis for a mathematical understanding of frequency modulation in the frequency domain.


== Modulation index ==
As in other modulation systems, the modulation index indicates by how much the modulated variable varies around its unmodulated level. It relates to variations in the carrier frequency:

  
    
      
        h
        =
        
          
            
              Δ
              

              
              f
            
            
              f
              
                m
              
            
          
        
        =
        
          
            
              
                f
                
                  Δ
                
              
              
                |
                
                  
                    x
                    
                      m
                    
                  
                  (
                  t
                  )
                
                |
              
            
            
              f
              
                m
              
            
          
        
      
    
    {\displaystyle h={\frac {\Delta {}f}{f_{m}}}={\frac {f_{\Delta }\left|x_{m}(t)\right|}{f_{m}}}}
  

where 
  
    
      
        
          f
          
            m
          
        
        
      
    
    {\displaystyle f_{m}\,}
  
 is the highest frequency component present in the modulating signal xm(t), and 
  
    
      
        Δ
        

        
        f
        
      
    
    {\displaystyle \Delta {}f\,}
  
 is the peak frequency-deviation – i.e. the maximum deviation of the instantaneous frequency from the carrier frequency. For a sine wave modulation, the modulation index is seen to be the ratio of the peak frequency deviation of the carrier wave to the frequency of the modulating sine wave.
If 
  
    
      
        h
        ≪
        1
      
    
    {\displaystyle h\ll 1}
  
, the modulation is called narrowband FM (NFM), and its bandwidth is approximately 
  
    
      
        2
        
          f
          
            m
          
        
        
      
    
    {\displaystyle 2f_{m}\,}
  
. Sometimes modulation index 
  
    
      
        h
        <
        0.3
      
    
    {\displaystyle h<0.3}
  
 is considered NFM and other modulation indices are considered wideband FM (WFM or FM).
For digital modulation systems, for example, binary frequency shift keying (BFSK), where a binary signal modulates the carrier, the modulation index is given by:

  
    
      
        h
        =
        
          
            
              Δ
              

              
              f
            
            
              f
              
                m
              
            
          
        
        =
        
          
            
              Δ
              

              
              f
            
            
              1
              
                2
                
                  T
                  
                    s
                  
                
              
            
          
        
        =
        2
        Δ
        

        
        f
        
          T
          
            s
          
        
         
      
    
    {\displaystyle h={\frac {\Delta {}f}{f_{m}}}={\frac {\Delta {}f}{\frac {1}{2T_{s}}}}=2\Delta {}fT_{s}\ }
  

where 
  
    
      
        
          T
          
            s
          
        
        
      
    
    {\displaystyle T_{s}\,}
  
 is the symbol period, and 
  
    
      
        
          f
          
            m
          
        
        =
        
          
            1
            
              2
              
                T
                
                  s
                
              
            
          
        
        
      
    
    {\displaystyle f_{m}={\frac {1}{2T_{s}}}\,}
  
 is used as the highest frequency of the modulating binary waveform by convention, even though it would be more accurate to say it is the highest fundamental of the modulating binary waveform. In the case of digital modulation, the carrier 
  
    
      
        
          f
          
            c
          
        
        
      
    
    {\displaystyle f_{c}\,}
  
 is never transmitted. Rather, one of two frequencies is transmitted, either 
  
    
      
        
          f
          
            c
          
        
        +
        Δ
        f
      
    
    {\displaystyle f_{c}+\Delta f}
  
 or 
  
    
      
        
          f
          
            c
          
        
        −
        Δ
        f
      
    
    {\displaystyle f_{c}-\Delta f}
  
, depending on the binary state 0 or 1 of the modulation signal.
If 
  
    
      
        h
        ≫
        1
      
    
    {\displaystyle h\gg 1}
  
, the modulation is called wideband FM and its bandwidth is approximately 
  
    
      
        2
        
          f
          
            Δ
          
        
        
      
    
    {\displaystyle 2f_{\Delta }\,}
  
. While wideband FM uses more bandwidth, it can improve the signal-to-noise ratio significantly; for example, doubling the value of 
  
    
      
        Δ
        

        
        f
        
      
    
    {\displaystyle \Delta {}f\,}
  
, while keeping 
  
    
      
        
          f
          
            m
          
        
      
    
    {\displaystyle f_{m}}
  
 constant, results in an eight-fold improvement in the signal-to-noise ratio. (Compare this with chirp spread spectrum, which uses extremely wide frequency deviations to achieve processing gains comparable to traditional, better-known spread-spectrum modes).
With a tone-modulated FM wave, if the modulation frequency is held constant and the modulation index is increased, the (non-negligible) bandwidth of the FM signal increases but the spacing between spectra remains the same; some spectral components decrease in strength as others increase. If the frequency deviation is held constant and the modulation frequency increased, the spacing between spectra increases.

Frequency modulation can be classified as narrowband if the change in the carrier frequency is about the same as the signal frequency, or as wideband if the change in the carrier frequency is much higher (modulation index > 1) than the signal frequency. For example, narrowband FM (NFM) is used for two-way radio systems such as Family Radio Service, in which the carrier is allowed to deviate only 2.5 kHz above and below the center frequency with speech signals of no more than 3.5 kHz bandwidth. Wideband FM is used for FM broadcasting, in which music and speech are transmitted with up to 75 kHz deviation from the center frequency and carry audio with up to a 20 kHz bandwidth and subcarriers up to 92 kHz.


== Bessel functions ==

In his 1922 FM paper, Carson pointed out an infinite number of side frequencies are generated when a carrier frequency is modulated by a signal frequency, the amplitudes expressed as Bessel functions. The separation is determined by the frequency of the modulating signal, and the amplitude dependent upon the modulation index. A table of Bessel functions of the first kind is used to determine the side frequency amplitudes. 
For the case of a carrier modulated by a single sine wave, the resulting frequency spectrum can be calculated using Bessel functions of the first kind, as a function of the sideband number and the modulation index. The carrier and sideband amplitudes are illustrated for different modulation indices of FM signals. For particular values of the modulation index, the carrier amplitude becomes zero and all the signal power is in the sidebands.
Since the sidebands are on both sides of the carrier, their count is doubled, and then multiplied by the modulating frequency to find the bandwidth. For example, 3 kHz deviation modulated by a 2.2 kHz audio tone produces a modulation index of 1.36. Suppose that we limit ourselves to only those sidebands that have a relative amplitude of at least 0.01. Then, examining the chart shows this modulation index will produce three sidebands. These three sidebands, when doubled, gives us (6 × 2.2 kHz) or a 13.2 kHz required bandwidth.


== Carson's rule ==

A rule of thumb, Carson's rule states that the frequency-modulated signal lies within a bandwidth 
  
    
      
        
          B
          
            T
          
        
        
      
    
    {\displaystyle B_{T}\,}
  
 of:

  
    
      
        
          B
          
            T
          
        
        =
        2
        
          (
          
            Δ
            f
            +
            
              f
              
                m
              
            
          
          )
        
        =
        2
        
          f
          
            m
          
        
        (
        h
        +
        1
        )
      
    
    {\displaystyle B_{T}=2\left(\Delta f+f_{m}\right)=2f_{m}(h+1)}
  

where 
  
    
      
        Δ
        f
        
      
    
    {\displaystyle \Delta f\,}
  
, as defined above, is the peak deviation of the instantaneous frequency 
  
    
      
        f
        (
        t
        )
        
      
    
    {\displaystyle f(t)\,}
  
 from the center carrier frequency 
  
    
      
        
          f
          
            c
          
        
      
    
    {\displaystyle f_{c}}
  
, 
  
    
      
        h
      
    
    {\displaystyle h}
  
 is the modulation index which is the ratio of frequency deviation to highest frequency in the modulating signal, and 
  
    
      
        
          f
          
            m
          
        
        
      
    
    {\displaystyle f_{m}\,}
  
is the highest frequency in the modulating signal.
Carson's rule can only be applied to sinusoidal signals. For non-sinusoidal signals:

  
    
      
        
          B
          
            T
          
        
        =
        2
        (
        Δ
        f
        +
        W
        )
        =
        2
        W
        (
        D
        +
        1
        )
      
    
    {\displaystyle B_{T}=2(\Delta f+W)=2W(D+1)}
  

where W  is the highest frequency in the modulating signal but non-sinusoidal in nature and D is the Deviation ratio which is the ratio of frequency deviation to highest frequency of modulating non-sinusoidal signal.


== Noise reduction ==
FM provides improved signal-to-noise ratio (SNR), as compared for example with AM. Compared with an optimum AM scheme, FM typically has poorer SNR below a certain signal level called the noise threshold, but above a higher level – the full improvement or full quieting threshold – the SNR is much improved over AM. The improvement depends on modulation level and deviation. For typical voice communications channels, improvements are typically 5–15 dB. FM broadcasting using wider deviation can achieve even greater improvements. Additional techniques, such as pre-emphasis of higher audio frequencies with corresponding de-emphasis in the receiver, are generally used to improve overall SNR in FM circuits. Since FM signals have constant amplitude, FM receivers normally have limiters that remove AM noise, further improving SNR.


== Implementation ==


=== Modulation ===
FM signals can be generated using either direct or indirect frequency modulation:

Direct FM modulation can be achieved by directly feeding the modulating audio voltage into a voltage-controlled oscillator.
For indirect FM modulation, the message signal is integrated to generate a phase-modulated signal. This is used to modulate a crystal-controlled oscillator, and the result is passed through a frequency multiplier to produce an FM signal. In this modulation, narrowband FM is generated leading to wideband FM later and hence the modulation is known as indirect FM modulation.


=== Demodulation ===

Many FM detector circuits exist. A common method for recovering the information signal is through a Foster–Seeley discriminator or ratio detector. A phase-locked loop can be used as an FM demodulator. Slope detection demodulates an FM signal by using a tuned circuit which has its resonant frequency slightly offset from the carrier. The input FM wave of constant amplitude and instantaneous frequency, is converted to an FM wave with instantaneous frequency and instantaneous amplitude, which is then sent to an envelop detector. AM receivers may detect some FM transmissions by this means, although it does not provide an efficient means of detection for FM broadcasts.
In software-defined radio implementations, the demodulation may be carried out by using the Hilbert transform (implemented as a filter) to recover the instantaneous phase, and thereafter differentiating this phase (using another filter) to recover the instantaneous frequency. Alternatively, a complex mixer followed by a bandpass filter may be used to translate the signal to baseband, and then proceeding as before. For sampled signals, phase detection, and therefore frequency modulation detection, can be approximated by taking the IQ (complex) sample and multiplying it with the complex conjugate of the previous IQ sample, 
  
    
      
        x
        [
        n
        ]
        ⋅
        
          
            
              x
              [
              n
              −
              1
              ]
            
            ¯
          
        
      
    
    {\displaystyle x[n]\cdot {\overline {x[n-1]}}}
  
. If the demodulated signal is sampled at or above Nyquist, this allows for recovery of near-instantaneous phase changes.


== Applications ==


=== Doppler effect ===
In 1968, Schnitzler noted certain bats lower the animal echolocation emission frequency by 13 to 16 kHz, compensating for Doppler shifts caused by the bat’s own movement. Doppler shift compensation, dynamic frequency modulation, ensures that the returning echo frequency is optimally adjusted for the bat's auditory fovea.


=== Magnetic tape storage ===
FM is also used at intermediate frequencies by analog VCR systems (including VHS) to record the luminance (black and white) portions of the video signal. Commonly, the chrominance component is recorded as a conventional AM signal, using the higher-frequency FM signal as bias. FM is the only feasible method of recording the luminance ("black-and-white") component of video to (and retrieving video from) magnetic tape without distortion; video signals have a large range of frequency components – from a few hertz to several megahertz, too wide for equalizers to work with due to electronic noise below −60 dB. FM also keeps the tape at saturation level, acting as a form of noise reduction; a limiter can mask variations in playback output, and the FM capture effect removes print-through and pre-echo. A continuous pilot-tone, if added to the signal – as was done on V2000 and many Hi-band formats – can keep mechanical jitter under control and assist timebase correction.
These FM systems are unusual, in that they have a ratio of carrier to maximum modulation frequency of less than two; contrast this with FM audio broadcasting, where the ratio is around 10,000. Consider, for example, a 6-MHz carrier modulated at a 3.5-MHz rate; by Bessel analysis, the first sidebands are on 9.5 and 2.5 MHz and the second sidebands are on 13 MHz and −1 MHz. The result is a reversed-phase sideband on +1 MHz; on demodulation, this results in unwanted output at 6 – 1 = 5 MHz. The system must be designed so that this unwanted output is reduced to an acceptable level.


=== Sound ===
FM is also used at audio frequencies to synthesize sound. This technique, known as FM synthesis, was popularized by early digital synthesizers and became a standard feature in several generations of personal computer sound cards.


=== Radio ===

Edwin Howard Armstrong (1890–1954) was an American electrical engineer who invented wideband frequency modulation (FM) radio.
He patented the regenerative circuit in 1914, the superheterodyne receiver in 1918 and the super-regenerative circuit in 1922. Armstrong presented his paper, "A Method of Reducing Disturbances in Radio Signaling by a System of Frequency Modulation", (which first described FM radio) before the New York section of the Institute of Radio Engineers on November 6, 1935. The paper was published in 1936. The first experimental station, W2XMN, went on the air in 1937.
As the name implies, wideband FM (WFM) requires a wider signal bandwidth than amplitude modulation by an equivalent modulating signal; this also makes the signal more robust against noise and interference. Frequency modulation is also more robust against signal-amplitude-fading phenomena. As a result, FM was chosen as the modulation standard for high frequency, high fidelity radio transmission, hence the term "FM radio" (although for many years the BBC called it "VHF radio" because commercial FM broadcasting uses part of the VHF band – the FM broadcast band). FM receivers employ a special detector for FM signals and exhibit a phenomenon known as the capture effect, in which the tuner "captures" the stronger of two stations on the same frequency while rejecting the other (compare this with a similar situation on an AM receiver, where both stations can be heard simultaneously). Frequency drift or a lack of selectivity may cause one station to be overtaken by another on an adjacent channel. Frequency drift was a problem in early (or inexpensive) receivers; inadequate selectivity may affect any tuner.
A wideband FM signal can also be used to carry a stereo signal; this is done with multiplexing and demultiplexing before and after the FM process. The FM modulation and demodulation process is identical in stereo and monaural processes.
FM is commonly used at VHF radio frequencies for high-fidelity broadcasts of music and speech. In broadcast services, where audio fidelity is important, wideband FM is generally used. Analog TV sound is also broadcast using FM. Narrowband FM is used for voice communications in commercial and amateur radio settings. In two-way radio, narrowband FM (NBFM) is used to conserve bandwidth for land mobile, marine mobile and other radio services.
A high-efficiency radio-frequency switching amplifier can be used to transmit FM signals (and other constant-amplitude signals). For a given signal strength (measured at the receiver antenna), switching amplifiers use less battery power and typically cost less than a linear amplifier. This gives FM another advantage over other modulation methods requiring linear amplifiers, such as AM and QAM.
There are reports that on October 5, 1924, Professor Mikhail A. Bonch-Bruevich, during a scientific and technical conversation in the Nizhny Novgorod Radio Laboratory, reported about his new method of telephony, based on a change in the period of oscillations. Demonstration of frequency modulation was carried out on the laboratory model.


=== Hearing assistive technology ===
Frequency modulated systems are a widespread and commercially available assistive technology that make speech more understandable by improving the signal-to-noise ratio in the user's ear. They are also called auditory trainers, a term which refers to any sound amplification system not classified as a hearing aid. They intensify signal levels from the source by 15 to 20 decibels. FM systems are used by hearing-impaired people as well as children whose listening is affected by disorders such as auditory processing disorder or ADHD. For people with sensorineural hearing loss, FM systems result in better speech perception than hearing aids. They can be coupled with behind-the-ear hearing aids to allow the user to alternate the setting. FM systems are more convenient and cost-effective than alternatives such as cochlear implants, but many users use FM systems infrequently due to their conspicuousness and need for recharging.


== See also ==

Continuous-wave frequency-modulated radar
Chirp
FM stereo
FM-UWB (FM and Ultra Wideband)
History of radio
Modulation, for a list of other modulation techniques


== References ==


== Further reading ==
Carlson, A. Bruce (2001). Communication Systems. Science/Engineering/Math (4th ed.). McGraw-Hill. ISBN 978-0-07-011127-1.
Frost, Gary L. (2010). Early FM Radio: Incremental technology in twentieth-century America. Baltimore, MD: Johns Hopkins University Press. ISBN 978-0-8018-9440-4.
Seymour, Ken (2005) [1996]. "Frequency Modulation". The Electronics Handbook (2nd ed.). CRC Press. pp. 1188–1200. ISBN 0-8493-8345-5.


== External links ==
Analog Modulation online interactive demonstration using Python in Google Colab Platform, by C Foh.