In cryptography, the ElGamal encryption system is a public-key encryption algorithm based on the Diffie–Hellman key exchange. It was described by Taher Elgamal in 1985. ElGamal encryption is used in the free GNU Privacy Guard software, recent versions of PGP, and other cryptosystems. The Digital Signature Algorithm (DSA) is a variant of the ElGamal signature scheme, which should not be confused with ElGamal encryption.
ElGamal encryption can be defined over any cyclic group 
  
    
      
        G
      
    
    {\displaystyle G}
  
, like multiplicative group of integers modulo n if and only if n is 1, 2, 4, pk or 2pk, where p is an odd prime and k > 0. Its security depends upon the difficulty of the Decisional Diffie Hellman Problem in 
  
    
      
        G
      
    
    {\displaystyle G}
  
.


== Algorithm ==
The algorithm first performs a Diffie–Hellman key exchange to establish a shared secret 
  
    
      
        s
      
    
    {\displaystyle s}
  
, then uses this as a one-time pad for encrypting the message. ElGamal encryption is performed in three phases: the key generation, the encryption, and the decryption. The first is purely key exchange, whereas the latter two mix key exchange computations with message computations.


=== Key generation ===
The first party, Alice, generates a key pair as follows:

Generate an efficient description of a cyclic group 
  
    
      
        G
        
      
    
    {\displaystyle G\,}
  
 of order 
  
    
      
        q
        
      
    
    {\displaystyle q\,}
  
 with generator 
  
    
      
        g
      
    
    {\displaystyle g}
  
.  Let 
  
    
      
        e
      
    
    {\displaystyle e}
  
 represent the identity element of 
  
    
      
        G
      
    
    {\displaystyle G}
  
.
It is not necessary to come up with a group and generator for each new key. Indeed, one may expect a specific implementation of ElGamal to be hardcoded to use a specific group, or a group from a specific suite. The choice of group is mostly about how large keys you want to use.
Choose an integer 
  
    
      
        x
      
    
    {\displaystyle x}
  
 randomly from 
  
    
      
        {
        1
        ,
        …
        ,
        q
        −
        1
        }
      
    
    {\displaystyle \{1,\ldots ,q-1\}}
  
.
Compute 
  
    
      
        h
        :=
        
          g
          
            x
          
        
      
    
    {\displaystyle h:=g^{x}}
  
.
The public key consists of the values 
  
    
      
        (
        G
        ,
        q
        ,
        g
        ,
        h
        )
      
    
    {\displaystyle (G,q,g,h)}
  
. Alice publishes this public key and retains 
  
    
      
        x
      
    
    {\displaystyle x}
  
 as her private key, which must be kept secret.


=== Encryption ===
A second party, Bob, encrypts a message 
  
    
      
        M
      
    
    {\displaystyle M}
  
 to Alice under her public key 
  
    
      
        (
        G
        ,
        q
        ,
        g
        ,
        h
        )
      
    
    {\displaystyle (G,q,g,h)}
  
 as follows:

Map the message 
  
    
      
        M
      
    
    {\displaystyle M}
  
 to an element 
  
    
      
        m
      
    
    {\displaystyle m}
  
 of 
  
    
      
        G
      
    
    {\displaystyle G}
  
 using a reversible mapping function.
Choose an integer 
  
    
      
        y
      
    
    {\displaystyle y}
  
 randomly from 
  
    
      
        {
        1
        ,
        …
        ,
        q
        −
        1
        }
      
    
    {\displaystyle \{1,\ldots ,q-1\}}
  
.
Compute 
  
    
      
        s
        :=
        
          h
          
            y
          
        
      
    
    {\displaystyle s:=h^{y}}
  
. This is called the shared secret.
Compute 
  
    
      
        
          c
          
            1
          
        
        :=
        
          g
          
            y
          
        
      
    
    {\displaystyle c_{1}:=g^{y}}
  
.
Compute 
  
    
      
        
          c
          
            2
          
        
        :=
        m
        ⋅
        s
      
    
    {\displaystyle c_{2}:=m\cdot s}
  
.
Bob sends the ciphertext 
  
    
      
        (
        
          c
          
            1
          
        
        ,
        
          c
          
            2
          
        
        )
      
    
    {\displaystyle (c_{1},c_{2})}
  
 to Alice.
Note that if one knows both the ciphertext 
  
    
      
        (
        
          c
          
            1
          
        
        ,
        
          c
          
            2
          
        
        )
      
    
    {\displaystyle (c_{1},c_{2})}
  
 and the plaintext 
  
    
      
        m
      
    
    {\displaystyle m}
  
, one can easily find the shared secret 
  
    
      
        s
      
    
    {\displaystyle s}
  
, since 
  
    
      
        
          c
          
            2
          
        
        ⋅
        
          m
          
            −
            1
          
        
        =
        s
      
    
    {\displaystyle c_{2}\cdot m^{-1}=s}
  
. Therefore, a new 
  
    
      
        y
      
    
    {\displaystyle y}
  
 and hence a new 
  
    
      
        s
      
    
    {\displaystyle s}
  
 is generated for every message to improve security. For this reason, 
  
    
      
        y
      
    
    {\displaystyle y}
  
 is also called an ephemeral key.


=== Decryption ===
Alice decrypts a ciphertext 
  
    
      
        (
        
          c
          
            1
          
        
        ,
        
          c
          
            2
          
        
        )
      
    
    {\displaystyle (c_{1},c_{2})}
  
 with her private key 
  
    
      
        x
      
    
    {\displaystyle x}
  
 as follows:

Compute 
  
    
      
        s
        :=
        
          c
          
            1
          
          
            x
          
        
      
    
    {\displaystyle s:=c_{1}^{x}}
  
. Since 
  
    
      
        
          c
          
            1
          
        
        =
        
          g
          
            y
          
        
      
    
    {\displaystyle c_{1}=g^{y}}
  
, 
  
    
      
        
          c
          
            1
          
          
            x
          
        
        =
        
          g
          
            x
            y
          
        
        =
        
          h
          
            y
          
        
      
    
    {\displaystyle c_{1}^{x}=g^{xy}=h^{y}}
  
, and thus it is the same shared secret that was used by Bob in encryption.
Compute 
  
    
      
        
          s
          
            −
            1
          
        
      
    
    {\displaystyle s^{-1}}
  
, the inverse of 
  
    
      
        s
      
    
    {\displaystyle s}
  
 in the group 
  
    
      
        G
      
    
    {\displaystyle G}
  
. This can be computed in one of several ways. If 
  
    
      
        G
      
    
    {\displaystyle G}
  
 is a subgroup of a multiplicative group of integers modulo 
  
    
      
        n
      
    
    {\displaystyle n}
  
, where 
  
    
      
        n
      
    
    {\displaystyle n}
  
 is prime, the modular multiplicative inverse can be computed using the extended Euclidean algorithm. An alternative is to compute 
  
    
      
        
          s
          
            −
            1
          
        
      
    
    {\displaystyle s^{-1}}
  
 as 
  
    
      
        
          c
          
            1
          
          
            q
            −
            x
          
        
      
    
    {\displaystyle c_{1}^{q-x}}
  
. This is the inverse of 
  
    
      
        s
      
    
    {\displaystyle s}
  
 because of Lagrange's theorem, since 
  
    
      
        s
        ⋅
        
          c
          
            1
          
          
            q
            −
            x
          
        
        =
        
          g
          
            x
            y
          
        
        ⋅
        
          g
          
            (
            q
            −
            x
            )
            y
          
        
        =
        (
        
          g
          
            q
          
        
        
          )
          
            y
          
        
        =
        
          e
          
            y
          
        
        =
        e
      
    
    {\displaystyle s\cdot c_{1}^{q-x}=g^{xy}\cdot g^{(q-x)y}=(g^{q})^{y}=e^{y}=e}
  
.
Compute 
  
    
      
        m
        :=
        
          c
          
            2
          
        
        ⋅
        
          s
          
            −
            1
          
        
      
    
    {\displaystyle m:=c_{2}\cdot s^{-1}}
  
. This calculation produces the original message 
  
    
      
        m
      
    
    {\displaystyle m}
  
, because 
  
    
      
        
          c
          
            2
          
        
        =
        m
        ⋅
        s
      
    
    {\displaystyle c_{2}=m\cdot s}
  
; hence 
  
    
      
        
          c
          
            2
          
        
        ⋅
        
          s
          
            −
            1
          
        
        =
        (
        m
        ⋅
        s
        )
        ⋅
        
          s
          
            −
            1
          
        
        =
        m
        ⋅
        e
        =
        m
      
    
    {\displaystyle c_{2}\cdot s^{-1}=(m\cdot s)\cdot s^{-1}=m\cdot e=m}
  
.
Map 
  
    
      
        m
      
    
    {\displaystyle m}
  
 back to the plaintext message 
  
    
      
        M
      
    
    {\displaystyle M}
  
.


=== Practical use ===
Like most public key systems, the ElGamal cryptosystem is usually used as part of a hybrid cryptosystem, where the message itself is encrypted using a symmetric cryptosystem, and ElGamal is then used to encrypt only the symmetric key. This is because asymmetric cryptosystems like ElGamal are usually slower than symmetric ones for the same level of security, so it is faster to encrypt the message, which can be arbitrarily large, with a symmetric cipher, and then use ElGamal only to encrypt the symmetric key, which usually is quite small compared to the size of the message.


== Security ==
The security of the ElGamal scheme depends on the properties of the underlying group 
  
    
      
        G
      
    
    {\displaystyle G}
  
 as well as any padding scheme used on the messages. If the computational Diffie–Hellman assumption (CDH) holds in the underlying cyclic group 
  
    
      
        G
      
    
    {\displaystyle G}
  
, then the encryption function is one-way.
If the decisional Diffie–Hellman assumption (DDH) holds in 
  
    
      
        G
      
    
    {\displaystyle G}
  
, then
ElGamal achieves semantic security. Semantic security is not implied by the computational Diffie–Hellman assumption alone. See Decisional Diffie–Hellman assumption for a discussion of groups where the assumption is believed to hold.
ElGamal encryption is unconditionally malleable, and therefore is not secure under chosen ciphertext attack. For example, given an encryption 
  
    
      
        (
        
          c
          
            1
          
        
        ,
        
          c
          
            2
          
        
        )
      
    
    {\displaystyle (c_{1},c_{2})}
  
 of some (possibly unknown) message 
  
    
      
        m
      
    
    {\displaystyle m}
  
, one can easily construct a valid encryption 
  
    
      
        (
        
          c
          
            1
          
        
        ,
        2
        
          c
          
            2
          
        
        )
      
    
    {\displaystyle (c_{1},2c_{2})}
  
 of the message 
  
    
      
        2
        m
      
    
    {\displaystyle 2m}
  
.
To achieve chosen-ciphertext security, the scheme must be further modified, or an appropriate padding scheme must be used. Depending on the modification, the DDH assumption may or may not be necessary.
Other schemes related to ElGamal which achieve security against chosen ciphertext attacks have also been proposed. The Cramer–Shoup cryptosystem is secure under chosen ciphertext attack assuming DDH holds for 
  
    
      
        G
      
    
    {\displaystyle G}
  
. Its proof does not use the random oracle model. Another proposed scheme is DHIES, whose proof requires an assumption that is stronger than the DDH assumption.


== Efficiency ==
ElGamal encryption is probabilistic, meaning that a single plaintext can be encrypted to many possible ciphertexts, with the consequence that a general ElGamal encryption produces a 1:2 expansion in size from plaintext to ciphertext.
Encryption under ElGamal requires two exponentiations; however, these exponentiations are independent of the message and can be computed ahead of time if needed. Decryption requires one exponentiation and one computation of a group inverse, which can, however, be easily combined into just one exponentiation.


== See also ==
Taher Elgamal, designer of this and other cryptosystems
ElGamal signature scheme
Homomorphic encryption


== Further reading ==
A. J. Menezes; P. C. van Oorschot; S. A. Vanstone. "Chapter 8.4 ElGamal public-key encryption" (PDF). Handbook of Applied Cryptography. CRC Press.
Dan Boneh (1998). "The Decision Diffie-Hellman problem". Algorithmic Number Theory. Lecture Notes in Computer Science. Vol. 1423. pp. 48–63. CiteSeerX 10.1.1.461.9971. doi:10.1007/BFb0054851. ISBN 978-3-540-64657-0.


== References ==