In cryptography, a pseudorandom permutation (PRP) is a function that cannot be distinguished from a random permutation (that is, a permutation selected at random with uniform probability, from the family of all permutations on the function's domain) with practical effort.


== Definition ==
Let F be a mapping 
  
    
      
        
          
            {
            
              0
              ,
              1
            
            }
          
          
            n
          
        
        ×
        
          
            {
            
              0
              ,
              1
            
            }
          
          
            s
          
        
        →
        
          
            {
            
              0
              ,
              1
            
            }
          
          
            n
          
        
      
    
    {\displaystyle \left\{0,1\right\}^{n}\times \left\{0,1\right\}^{s}\rightarrow \left\{0,1\right\}^{n}}
  
. F is a PRP if and only if

For any 
  
    
      
        K
        ∈
        
          
            {
            
              0
              ,
              1
            
            }
          
          
            s
          
        
      
    
    {\displaystyle K\in \left\{0,1\right\}^{s}}
  
, 
  
    
      
        
          F
          
            K
          
        
      
    
    {\displaystyle F_{K}}
  
 is a bijection from 
  
    
      
        
          
            {
            
              0
              ,
              1
            
            }
          
          
            n
          
        
      
    
    {\displaystyle \left\{0,1\right\}^{n}}
  
 to 
  
    
      
        
          
            {
            
              0
              ,
              1
            
            }
          
          
            n
          
        
      
    
    {\displaystyle \left\{0,1\right\}^{n}}
  
, where 
  
    
      
        
          F
          
            K
          
        
        (
        x
        )
        =
        F
        (
        x
        ,
        K
        )
      
    
    {\displaystyle F_{K}(x)=F(x,K)}
  
.
For any 
  
    
      
        K
        ∈
        
          
            {
            
              0
              ,
              1
            
            }
          
          
            s
          
        
      
    
    {\displaystyle K\in \left\{0,1\right\}^{s}}
  
, there is an "efficient" algorithm to evaluate 
  
    
      
        
          F
          
            K
          
        
        (
        x
        )
      
    
    {\displaystyle F_{K}(x)}
  
 for any 
  
    
      
        x
        ∈
        
          
            {
            
              0
              ,
              1
            
            }
          
          
            n
          
        
      
    
    {\displaystyle x\in \left\{0,1\right\}^{n}}
  
,.
For all probabilistic polynomial-time distinguishers 
  
    
      
        D
      
    
    {\displaystyle D}
  
: 
  
    
      
        
          |
          
            P
            r
            
              (
              
                
                  D
                  
                    
                      F
                      
                        K
                      
                    
                  
                
                (
                
                  1
                  
                    n
                  
                
                )
                =
                1
              
              )
            
            −
            P
            r
            
              (
              
                
                  D
                  
                    
                      f
                      
                        n
                      
                    
                  
                
                (
                
                  1
                  
                    n
                  
                
                )
                =
                1
              
              )
            
          
          |
        
        <
        ε
        (
        s
        )
      
    
    {\displaystyle \left|Pr\left(D^{F_{K}}(1^{n})=1\right)-Pr\left(D^{f_{n}}(1^{n})=1\right)\right|<\varepsilon (s)}
  
, where 
  
    
      
        K
        ∈
        
          
            {
            
              0
              ,
              1
            
            }
          
          
            s
          
        
      
    
    {\displaystyle K\in \left\{0,1\right\}^{s}}
  
 is chosen uniformly at random and 
  
    
      
        
          f
          
            n
          
        
      
    
    {\displaystyle f_{n}}
  
 is chosen uniformly at random from the set of permutations on n-bit strings.
A pseudorandom permutation family is a collection of pseudorandom permutations, where a specific permutation may be chosen using a key.


== The model of block ciphers ==
The idealized abstraction of a (keyed) block cipher is a truly random permutation on the mappings between plaintext and ciphertext.  If a distinguishing algorithm exists that achieves significant advantage with less effort than specified by the block cipher's security parameter (this usually means the effort required should be about the same as a brute force search through the cipher's key space), then the cipher is considered broken at least in a certificational sense, even if such a break doesn't immediately lead to a practical security failure.
Modern ciphers are expected to have super pseudorandomness.
That is, the cipher should be indistinguishable from a randomly chosen permutation on the same message space, even if the adversary has black-box access to the forward and inverse directions of the cipher.


== Connections with pseudorandom function ==
Michael Luby and Charles Rackoff showed that a "strong" pseudorandom permutation can be built from a pseudorandom function using a Luby–Rackoff construction which is built using a Feistel cipher.


== Related concepts ==


=== Unpredictable permutation ===
An unpredictable permutation (UP) Fk is a permutation whose values cannot be predicted by a fast randomized algorithm. Unpredictable permutations may be used as a cryptographic primitive, a building block for cryptographic systems with more complex properties.
An adversary for an unpredictable permutation is defined to be an algorithm that is given access to an oracle for both forward and inverse permutation operations. The adversary is given a challenge input k and is asked to predict the value of Fk. It is allowed to make a series of queries to the oracle to help it make this prediction, but is not allowed to query the value of k itself.
A randomized algorithm for generating permutations generates an unpredictable permutation if its outputs are permutations on a set of items (described by length-n binary strings)  that cannot be predicted with accuracy significantly better than random by an adversary that makes a polynomial (in n) number of queries to the oracle prior to the challenge round, whose running time is polynomial in n, and whose error probability is less than 1/2 for all instances. That is, it cannot be predicted in the complexity class PP, relativized by the oracle for the permutation.


==== Properties of unpredictable permutations ====
It can be shown that a function Fk is not a secure message authentication code (MAC) if it satisfies only the unpredictability requirement. It can also be shown that one cannot build an efficient variable input length MAC from a block cipher which is modelled as a UP of n bits. It has been shown that the output of a k = n/ω(log λ) round Feistel construction with unpredictable round functions may leak all the intermediate round values. Even for realistic Unpredictable Functions (UF), some partial information about the intermediate round values may be leaked through the output. It was later shown that if a super-logarithmic number of rounds in the Feistel construction is used, then the resulting UP construction is secure even if the adversary gets all the intermediate round values along with the permutation output.
There is also a theorem that has been proven in this regard which states that if there exists an efficient UP adversary Aπ that has non-negligible advantage επ in the unpredictability game against UP construction ψU,k and which makes a polynomial number of queries to the challenger, then there also exists a UF adversary Af that has non-negligible advantage in the unpredictability game against a UF sampled from the UF family F . From this, it can be shown that the maximum advantage of the UP adversary Aπ is επ = O (εf. (qk)6). Here εf denotes the maximum advantage of a UF adversary running in time O(t + (qk)5) against a UF sampled from F, where t is the running time of the PRP adversary Aψ and q is the number of queries made by it.
In addition, a signature scheme that satisfies the property of unpredictability and not necessarily pseudo-randomness is essentially a Verifiable Unpredictable Function (VUF). A verifiable unpredictable function is defined analogously to a Verifiable Pseudorandom Function (VRF) but for pseudo-randomness being substituted with weaker unpredictability. Verifiable unpredictable permutations are the permutation analogs of VUFs or unpredictable analogs of VRPs. A VRP is also a VUP and a VUP can actually be built by building a VRP via the Feistel construction applied to a VRF. But this is not viewed useful since VUFs appear to be much easier to construct than VRFs.


== Applications ==
DES
K x X → X ∀  X={0,1}64, K={0,1}56
AES-128
K x X → X ∀  k=X={0,1}128


== See also ==
Block cipher (pseudorandom permutation families operating on fixed-size blocks of bits)
Format-preserving encryption (pseudorandom permutation families operating on arbitrary finite sets)


== References ==