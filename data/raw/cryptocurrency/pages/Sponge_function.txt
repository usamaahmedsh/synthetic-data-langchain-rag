In cryptography, a sponge function or sponge construction is any of a class of algorithms with finite internal state that take an input bit stream of any length and produce an output bit stream of any desired length. Sponge functions have both theoretical and practical uses. They can be used to model or implement many cryptographic primitives, including cryptographic hashes, message authentication codes, mask generation functions, stream ciphers, pseudo-random number generators, and authenticated encryption.


== Construction ==
A sponge function is built from three components:

a state memory, S, containing b bits,
a function 
  
    
      
        f
        :
        {
        0
        ,
        1
        
          }
          
            b
          
        
        â†’
        {
        0
        ,
        1
        
          }
          
            b
          
        
      
    
    {\displaystyle f:\{0,1\}^{b}\rightarrow \{0,1\}^{b}}
  

a padding function P
S is divided into two sections: one of size r (the bitrate) and the remaining part of size c (the capacity). These sections are denoted R and C respectively.
f produces a pseudorandom permutation of the 
  
    
      
        
          2
          
            b
          
        
      
    
    {\displaystyle 2^{b}}
  
 states from S.
P appends enough bits to the input string so that the length of the padded input is a whole multiple of the bitrate, r. This means the input is segmented into blocks of r bits.


=== Operation ===
The sponge function "absorbs" (in the sponge metaphor) all blocks of a padded input string as follows:

S is initialized to zero
for each r-bit block B of P(string)
R is replaced with R XOR B (using bitwise XOR)
S is replaced by f(S)
The sponge function output is now ready to be produced ("squeezed out") as follows:

repeat until output is full
output the R portion of S
S is replaced by f(S)
If less than r bits remain to be output, then R will be truncated (only part of R will be output).
Another metaphor describes the state memory as an "entropy pool", with input "poured into" the pool, and the transformation function referred to as "stirring the entropy pool".
Note that input bits are never XORed into the C portion of the state memory, nor are any bits of C ever output directly. The extent to which C is altered by the input depends entirely on the transformation function f. In hash applications, resistance to collision or preimage attacks depends on C, and its size (the "capacity" c) is typically twice the desired resistance level.


=== Duplex construction ===
It is also possible to absorb and squeeze in an alternating fashion. This operation is called the duplex construction or duplexing. It can be the basis of a single pass authenticated encryption system. This have also been used as an efficient variant of the Fiat-Shamir transformation for some protocols.

The state S is initialized to zero
for each r-bit block B of the input
R is XORed with B
S is replaced by f(S)
R is now an output block of size r bits.


=== Overwrite mode ===
It is possible to omit the XOR operations during absorption, while still maintaining the chosen security level. In this mode, in the absorbing phase, the next block of the input overwrites the R part of the state. This allows keeping a smaller state between the steps. Since the R part will be overwritten anyway, it can be discarded in advance, only the C part must be kept.


== Applications ==
Sponge functions have both theoretical and practical uses. In theoretical cryptanalysis, a random sponge function is a sponge construction where f is a random permutation or transformation, as appropriate. Random sponge functions capture more of the practical limitations of cryptographic primitives than does the widely used random oracle model, in particular the finite internal state.
The sponge construction can also be used to build practical cryptographic primitives. For example, the Keccak cryptographic sponge with a 1600-bit state has been selected by NIST as the winner in the SHA-3 competition. The strength of Keccak derives from the intricate, multi-round permutation f that its authors developed. The RC4-redesign called Spritz refers to the sponge-construct to define the algorithm.
For other examples, a sponge function can be used to build authenticated encryption with associated data (AEAD), as well as password hashing schemes.


== References ==


== External links ==