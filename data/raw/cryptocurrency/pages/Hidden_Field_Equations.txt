Hidden Fields Equations (HFE), also known as HFE trapdoor function, is a public key cryptosystem which was introduced at Eurocrypt in 1996 and proposed by (in French) Jacques Patarin following the idea of the Matsumoto and Imai system. It is based on polynomials over finite fields 
  
    
      
        
          
            F
          
          
            q
          
        
      
    
    {\displaystyle \mathbb {F} _{q}}
  
 of different size to disguise the relationship between the private key and public key. HFE is in fact a family which consists of basic HFE and combinatorial versions of HFE. The HFE family of cryptosystems is based on the hardness of the problem of finding solutions to a system of multivariate quadratic equations (the so-called MQ problem) since it uses private affine transformations to hide the extension field and the private polynomials. Hidden Field Equations also have been used to construct digital signature schemes, e.g. Quartz and Sflash.


== Mathematical background ==
One of the central notions to understand how Hidden Field Equations work is to see that for two  extension fields 
  
    
      
        
          
            F
          
          
            
              q
              
                n
              
            
          
        
      
    
    {\displaystyle \mathbb {F} _{q^{n}}}
  
 
  
    
      
        
          
            F
          
          
            
              q
              
                m
              
            
          
        
      
    
    {\displaystyle \mathbb {F} _{q^{m}}}
  
 over the same base field 
  
    
      
        
          
            F
          
          
            q
          
        
      
    
    {\displaystyle \mathbb {F} _{q}}
  
 one can interpret a system of 
  
    
      
        m
      
    
    {\displaystyle m}
  
 multivariate polynomials in 
  
    
      
        n
      
    
    {\displaystyle n}
  
 variables over 
  
    
      
        
          
            F
          
          
            q
          
        
      
    
    {\displaystyle \mathbb {F} _{q}}
  
 as a function 
  
    
      
        
          
            F
          
          
            
              q
              
                n
              
            
          
        
        →
        
          
            F
          
          
            
              q
              
                m
              
            
          
        
      
    
    {\displaystyle \mathbb {F} _{q^{n}}\to \mathbb {F} _{q^{m}}}
  
 by using a suitable basis of 
  
    
      
        
          
            F
          
          
            
              q
              
                n
              
            
          
        
      
    
    {\displaystyle \mathbb {F} _{q^{n}}}
  
 over 
  
    
      
        
          
            F
          
          
            q
          
        
      
    
    {\displaystyle \mathbb {F} _{q}}
  
. In almost all applications the polynomials are quadratic, i.e. they have degree 2. We start with the simplest kind of polynomials, namely monomials, and show how they lead to quadratic systems of equations.
Consider a finite field 
  
    
      
        
          
            F
          
          
            q
          
        
      
    
    {\displaystyle \mathbb {F} _{q}}
  
, where 
  
    
      
        q
      
    
    {\displaystyle q}
  
 is a power of 2, and an extension field 
  
    
      
        K
      
    
    {\displaystyle K}
  
. Let 
  
    
      
        0
        <
        h
        <
        
          q
          
            n
          
        
      
    
    {\displaystyle 0<h<q^{n}}
  
 such that 
  
    
      
        h
        =
        
          q
          
            θ
          
        
        +
        1
      
    
    {\displaystyle h=q^{\theta }+1}
  
 for some 
  
    
      
        θ
      
    
    {\displaystyle \theta }
  
 and gcd
  
    
      
        (
        h
        ,
        
          q
          
            n
          
        
        −
        1
        )
        =
        1
      
    
    {\displaystyle (h,q^{n}-1)=1}
  
. The condition gcd
  
    
      
        (
        h
        ,
        
          q
          
            n
          
        
        −
        1
        )
        =
        1
      
    
    {\displaystyle (h,q^{n}-1)=1}
  
 is equivalent to requiring that the map 
  
    
      
        u
        →
        
          u
          
            h
          
        
      
    
    {\displaystyle u\to u^{h}}
  
 on 
  
    
      
        K
      
    
    {\displaystyle K}
  
 is one to one and its inverse is the map 
  
    
      
        u
        →
        
          u
          
            
              h
              ′
            
          
        
      
    
    {\displaystyle u\to u^{h'}}
  
 where 
  
    
      
        
          h
          ′
        
      
    
    {\displaystyle h'}
  
 is the multiplicative inverse of 
  
    
      
        h
         
        
          
            mod
            
              q
            
          
          
            n
          
        
        −
        1
      
    
    {\displaystyle h\ {\bmod {q}}^{n}-1}
  
. 
Take a random element 
  
    
      
        u
        ∈
        
          
            F
          
          
            
              q
              
                n
              
            
          
        
      
    
    {\displaystyle u\in \mathbb {F} _{q^{n}}}
  
. Define 
  
    
      
        w
        ∈
        
          
            F
          
          
            
              q
              
                n
              
            
          
        
      
    
    {\displaystyle w\in \mathbb {F} _{q^{n}}}
  
 by

  
    
      
        w
        =
        
          u
          
            h
          
        
        =
        
          u
          
            
              q
              
                θ
              
            
          
        
        u
         
         
         
         
        (
        1
        )
      
    
    {\displaystyle w=u^{h}=u^{q^{\theta }}u\ \ \ \ (1)}
  

Let 
  
    
      
        
          β
          
            1
          
        
        ,
        .
        .
        .
        ,
        
          β
          
            n
          
        
      
    
    {\displaystyle \beta _{1},...,\beta _{n}}
  
 to be a basis of 
  
    
      
        K
      
    
    {\displaystyle K}
  
 as an 
  
    
      
        
          
            F
          
          
            q
          
        
      
    
    {\displaystyle \mathbb {F} _{q}}
  
 vector space. We represent 
  
    
      
        u
      
    
    {\displaystyle u}
  
 with respect to the basis as 
  
    
      
        u
        =
        (
        
          u
          
            1
          
        
        ,
        .
        .
        .
        ,
        
          u
          
            n
          
        
        )
      
    
    {\displaystyle u=(u_{1},...,u_{n})}
  
 and 
  
    
      
        w
        =
        (
        
          w
          
            1
          
        
        ,
        .
        .
        .
        ,
        
          w
          
            n
          
        
        )
      
    
    {\displaystyle w=(w_{1},...,w_{n})}
  
. Let 
  
    
      
        
          A
          
            (
            k
            )
          
        
        =
        
          
            a
            
              i
              j
            
            
              (
              k
              )
            
          
        
      
    
    {\displaystyle A^{(k)}={a_{ij}^{(k)}}}
  
 be the matrix of the linear transformation 
  
    
      
        u
        →
        
          u
          
            
              q
              
                k
              
            
          
        
      
    
    {\displaystyle u\to u^{q^{k}}}
  
 with respect to the basis 
  
    
      
        
          β
          
            1
          
        
        ,
        .
        .
        .
        ,
        
          β
          
            n
          
        
      
    
    {\displaystyle \beta _{1},...,\beta _{n}}
  
, i.e. such that

  
    
      
        
          β
          
            i
          
          
            
              q
              
                k
              
            
          
        
        =
        
          ∑
          
            j
            =
            1
          
          
            n
          
        
        
          a
          
            i
            j
          
          
            k
          
        
        
          β
          
            j
          
        
        ,
         
         
        
          a
          
            i
            j
          
          
            k
          
        
        ∈
        
          
            F
          
          
            q
          
        
      
    
    {\displaystyle \beta _{i}^{q^{k}}=\sum _{j=1}^{n}a_{ij}^{k}\beta _{j},\ \ a_{ij}^{k}\in \mathbb {F} _{q}}
  

for 
  
    
      
        1
        ≤
        i
        ,
        k
        ≤
        n
      
    
    {\displaystyle 1\leq i,k\leq n}
  
.  Additionally, write all products of basis elements in terms of the basis, i.e.:

  
    
      
        
          β
          
            i
          
        
        
          β
          
            j
          
        
        =
        
          ∑
          
            l
            =
            1
          
          
            n
          
        
        
          m
          
            i
            j
            l
          
        
        
          β
          
            l
          
        
        ,
         
         
        
          m
          
            i
            j
            l
          
        
        ∈
        
          
            F
          
          
            q
          
        
      
    
    {\displaystyle \beta _{i}\beta _{j}=\sum _{l=1}^{n}m_{ijl}\beta _{l},\ \ m_{ijl}\in \mathbb {F} _{q}}
  

for each 
  
    
      
        1
        ≤
        i
        ,
        j
        ≤
        n
      
    
    {\displaystyle 1\leq i,j\leq n}
  
. The system of 
  
    
      
        n
      
    
    {\displaystyle n}
  
 equations which is explicit in the 
  
    
      
        
          w
          
            i
          
        
      
    
    {\displaystyle w_{i}}
  
 and quadratic in the 
  
    
      
        
          u
          
            j
          
        
      
    
    {\displaystyle u_{j}}
  
 can be obtained by expanding (1) and equating to zero the coefficients of the 
  
    
      
        
          β
          
            i
          
        
      
    
    {\displaystyle \beta _{i}}
  
. 
Choose two secret affine transformations  
  
    
      
        S
      
    
    {\displaystyle S}
  
 and 
  
    
      
        T
      
    
    {\displaystyle T}
  
 , i.e. two invertible 
  
    
      
        n
        ×
        n
      
    
    {\displaystyle n\times n}
  
 matrices 
  
    
      
        
          M
          
            S
          
        
        =
        {
        
          S
          
            i
            j
          
        
        }
      
    
    {\displaystyle M_{S}=\{S_{ij}\}}
  
 and 
  
    
      
        
          M
          
            T
          
        
        =
        {
        
          T
          
            i
            j
          
        
        }
      
    
    {\displaystyle M_{T}=\{T_{ij}\}}
  
 with entries in 
  
    
      
        
          
            F
          
          
            q
          
        
      
    
    {\displaystyle \mathbb {F} _{q}}
  
 and two vectors 
  
    
      
        
          v
          
            S
          
        
      
    
    {\displaystyle v_{S}}
  
 and 
  
    
      
        
          v
          
            T
          
        
      
    
    {\displaystyle v_{T}}
  
 of length 
  
    
      
        n
      
    
    {\displaystyle n}
  
 over 
  
    
      
        
          
            F
          
          
            q
          
        
      
    
    {\displaystyle \mathbb {F} _{q}}
  
 and define 
  
    
      
        x
      
    
    {\displaystyle x}
  
 and 
  
    
      
        y
      
    
    {\displaystyle y}
  
 via:

  
    
      
        u
        =
        S
        x
        =
        
          M
          
            S
          
        
        x
        +
        
          v
          
            S
          
        
         
         
         
         
        w
        =
        T
        y
        =
        
          M
          
            T
          
        
        y
        +
        
          v
          
            T
          
        
         
         
         
         
        (
        2
        )
      
    
    {\displaystyle u=Sx=M_{S}x+v_{S}\ \ \ \ w=Ty=M_{T}y+v_{T}\ \ \ \ (2)}
  

By using the affine relations in (2) to replace the 
  
    
      
        
          u
          
            j
          
        
        ,
        
          w
          
            i
          
        
      
    
    {\displaystyle u_{j},w_{i}}
  
 with 
  
    
      
        
          x
          
            k
          
        
        ,
        
          y
          
            l
          
        
      
    
    {\displaystyle x_{k},y_{l}}
  
, the system of 
  
    
      
        n
      
    
    {\displaystyle n}
  
 equations is linear in the 
  
    
      
        
          y
          
            l
          
        
      
    
    {\displaystyle y_{l}}
  
 and of degree 2 in the 
  
    
      
        
          x
          
            k
          
        
      
    
    {\displaystyle x_{k}}
  
. Applying linear algebra it will give 
  
    
      
        n
      
    
    {\displaystyle n}
  
 explicit equations, one for each 
  
    
      
        
          y
          
            l
          
        
      
    
    {\displaystyle y_{l}}
  
 as polynomials of degree 2 in the 
  
    
      
        
          x
          
            k
          
        
      
    
    {\displaystyle x_{k}}
  
.


== Multivariate cryptosystem ==
The basic idea of the HFE family of using this as a  multivariate cryptosystem is to build the secret key starting from a polynomial 
  
    
      
        P
      
    
    {\displaystyle P}
  
 in one unknown 
  
    
      
        x
      
    
    {\displaystyle x}
  
 over some finite field 
  
    
      
        
          
            F
          
          
            
              q
              
                n
              
            
          
        
      
    
    {\displaystyle \mathbb {F} _{q^{n}}}
  
 (normally value 
  
    
      
        q
        =
        2
      
    
    {\displaystyle q=2}
  
 is used). This polynomial can be easily inverted over 
  
    
      
        
          
            F
          
          
            
              q
              
                n
              
            
          
        
      
    
    {\displaystyle \mathbb {F} _{q^{n}}}
  
, i.e. it is feasible to find any solutions to the equation 
  
    
      
        P
        (
        x
        )
        =
        y
      
    
    {\displaystyle P(x)=y}
  
 when such solution exist. The secret transformation either decryption and/or signature is based on this inversion. As explained above 
  
    
      
        P
      
    
    {\displaystyle P}
  
 can be identified with a system of 
  
    
      
        n
      
    
    {\displaystyle n}
  
 equations 
  
    
      
        (
        
          p
          
            1
          
        
        ,
        .
        .
        .
        ,
        
          p
          
            n
          
        
        )
      
    
    {\displaystyle (p_{1},...,p_{n})}
  
 using a fixed basis. To build a cryptosystem the polynomial 
  
    
      
        (
        
          p
          
            1
          
        
        ,
        .
        .
        .
        ,
        
          p
          
            n
          
        
        )
      
    
    {\displaystyle (p_{1},...,p_{n})}
  
 must be transformed so that the public information hides the original structure and prevents inversion. This is done by viewing the finite fields 
  
    
      
        
          
            F
          
          
            
              q
              
                n
              
            
          
        
      
    
    {\displaystyle \mathbb {F} _{q^{n}}}
  
 as a vector space over 
  
    
      
        
          
            F
          
          
            q
          
        
      
    
    {\displaystyle \mathbb {F} _{q}}
  
 and by choosing two linear affine transformations 
  
    
      
        S
      
    
    {\displaystyle S}
  
 and 
  
    
      
        T
      
    
    {\displaystyle T}
  
. The triplet 
  
    
      
        (
        S
        ,
        P
        ,
        T
        )
      
    
    {\displaystyle (S,P,T)}
  
 constitute the private key. The private polynomial 
  
    
      
        P
      
    
    {\displaystyle P}
  
 is defined over 
  
    
      
        
          
            F
          
          
            
              q
              
                n
              
            
          
        
      
    
    {\displaystyle \mathbb {F} _{q^{n}}}
  
. The public key is 
  
    
      
        (
        
          p
          
            1
          
        
        ,
        .
        .
        .
        ,
        
          p
          
            n
          
        
        )
      
    
    {\displaystyle (p_{1},...,p_{n})}
  
. Below is the diagram for MQ-trapdoor 
  
    
      
        (
        S
        ,
        P
        ,
        T
        )
      
    
    {\displaystyle (S,P,T)}
  
 in HFE

  
    
      
        
          input
        
        x
        →
        x
        =
        (
        
          x
          
            1
          
        
        ,
        .
        .
        .
        ,
        
          x
          
            n
          
        
        )
        
          
            →
            
              
                secret
              
              :
              S
            
          
        
        
          x
          ′
        
        
          
            →
            
              
                secret
              
              :
              P
            
          
        
        
          y
          ′
        
        
          
            →
            
              
                secret
              
              :
              T
            
          
        
        
          output
        
        y
      
    
    {\displaystyle {\text{input}}x\to x=(x_{1},...,x_{n}){\overset {{\text{secret}}:S}{\to }}x'{\overset {{\text{secret}}:P}{\to }}y'{\overset {{\text{secret}}:T}{\to }}{\text{output}}y}
  


== HFE polynomial ==
The private polynomial 
  
    
      
        P
      
    
    {\displaystyle P}
  
 with degree 
  
    
      
        d
      
    
    {\displaystyle d}
  
 over 
  
    
      
        
          
            F
          
          
            
              q
              
                n
              
            
          
        
      
    
    {\displaystyle \mathbb {F} _{q^{n}}}
  
 is an element of 
  
    
      
        
          
            F
          
          
            
              q
              
                n
              
            
          
        
        [
        x
        ]
      
    
    {\displaystyle \mathbb {F} _{q^{n}}[x]}
  
. If the terms of polynomial 
  
    
      
        P
      
    
    {\displaystyle P}
  
 have at most quadratic terms over 
  
    
      
        
          
            F
          
          
            q
          
        
      
    
    {\displaystyle \mathbb {F} _{q}}
  
 then it will keep the public polynomial small. The case that 
  
    
      
        P
      
    
    {\displaystyle P}
  
 consists of monomials of the form 
  
    
      
        
          x
          
            
              q
              
                
                  s
                  
                    i
                  
                
              
            
            +
            
              q
              
                
                  t
                  
                    i
                  
                
              
            
          
        
      
    
    {\displaystyle x^{q^{s_{i}}+q^{t_{i}}}}
  
, i.e. with 2 powers of 
  
    
      
        q
      
    
    {\displaystyle q}
  
 in the exponent
is the basic version of HFE, i.e. 
  
    
      
        P
      
    
    {\displaystyle P}
  
 is chosen as

  
    
      
        P
        (
        x
        )
        =
        ∑
        
          c
          
            i
          
        
        
          x
          
            
              q
              
                
                  s
                  
                    i
                  
                
              
            
            +
            
              q
              
                
                  t
                  
                    i
                  
                
              
            
          
        
      
    
    {\displaystyle P(x)=\sum c_{i}x^{q^{s_{i}}+q^{t_{i}}}}
  

The degree 
  
    
      
        d
      
    
    {\displaystyle d}
  
 of the polynomial is also known as security parameter and the bigger its value the better for security since the resulting set of quadratic equations resembles a randomly chosen set of quadratic equations. On the other side large 
  
    
      
        d
      
    
    {\displaystyle d}
  
 slows down the deciphering. Since 
  
    
      
        P
      
    
    {\displaystyle P}
  
 is a polynomial of degree at most 
  
    
      
        d
      
    
    {\displaystyle d}
  
 the inverse of 
  
    
      
        P
      
    
    {\displaystyle P}
  
, denoted by 
  
    
      
        
          P
          
            −
            1
          
        
      
    
    {\displaystyle P^{-1}}
  
 can be computed in 
  
    
      
        
          d
          
            2
          
        
        (
        ln
        ⁡
        d
        
          )
          
            O
            (
            1
            )
          
        
        
          n
          
            2
          
        
        
          
            F
          
          
            q
          
        
      
    
    {\displaystyle d^{2}(\ln d)^{O(1)}n^{2}\mathbb {F} _{q}}
  
 operations.


== Encryption and decryption ==
The public key is given by the 
  
    
      
        n
      
    
    {\displaystyle n}
  
 multivariate polynomials 
  
    
      
        (
        
          p
          
            1
          
        
        ,
        .
        .
        .
        ,
        
          p
          
            n
          
        
        )
      
    
    {\displaystyle (p_{1},...,p_{n})}
  
 over 
  
    
      
        
          
            F
          
          
            q
          
        
      
    
    {\displaystyle \mathbb {F} _{q}}
  
. It is thus necessary to transfer the message 
  
    
      
        M
      
    
    {\displaystyle M}
  
 from 
  
    
      
        
          
            F
          
          
            
              q
              
                n
              
            
          
        
        →
        
          
            F
          
          
            q
          
          
            n
          
        
      
    
    {\displaystyle \mathbb {F} _{q^{n}}\to \mathbb {F} _{q}^{n}}
  
 in order to encrypt it, i.e. we assume that 
  
    
      
        M
      
    
    {\displaystyle M}
  
 is a vector 
  
    
      
        (
        
          x
          
            1
          
        
        ,
        .
        .
        .
        ,
        
          x
          
            n
          
        
        )
        ∈
        
          
            F
          
          
            q
          
          
            n
          
        
      
    
    {\displaystyle (x_{1},...,x_{n})\in \mathbb {F} _{q}^{n}}
  
. To encrypt message 
  
    
      
        M
      
    
    {\displaystyle M}
  
 we evaluate each 
  
    
      
        
          p
          
            i
          
        
      
    
    {\displaystyle p_{i}}
  
 at 
  
    
      
        (
        
          x
          
            1
          
        
        ,
        .
        .
        .
        ,
        
          x
          
            n
          
        
        )
      
    
    {\displaystyle (x_{1},...,x_{n})}
  
. The ciphertext is 
  
    
      
        (
        
          p
          
            1
          
        
        (
        
          x
          
            1
          
        
        ,
        .
        .
        .
        ,
        
          x
          
            n
          
        
        )
        ,
        
          p
          
            2
          
        
        (
        
          x
          
            1
          
        
        ,
        .
        .
        .
        ,
        
          x
          
            n
          
        
        )
        ,
        .
        .
        .
        ,
        
          p
          
            n
          
        
        (
        
          x
          
            1
          
        
        ,
        .
        .
        .
        ,
        
          x
          
            n
          
        
        )
        )
        ∈
        
          
            F
          
          
            q
          
          
            n
          
        
      
    
    {\displaystyle (p_{1}(x_{1},...,x_{n}),p_{2}(x_{1},...,x_{n}),...,p_{n}(x_{1},...,x_{n}))\in \mathbb {F} _{q}^{n}}
  
.
To understand decryption let us express encryption in terms of 
  
    
      
        S
        ,
        T
        ,
        P
      
    
    {\displaystyle S,T,P}
  
. Note that these are not available to the sender. By evaluating the 
  
    
      
        
          p
          
            i
          
        
      
    
    {\displaystyle p_{i}}
  
 at the message we first apply 
  
    
      
        S
      
    
    {\displaystyle S}
  
, resulting in 
  
    
      
        
          x
          ′
        
      
    
    {\displaystyle x'}
  
. At this point 
  
    
      
        
          x
          ′
        
      
    
    {\displaystyle x'}
  
 is transferred from 
  
    
      
        
          
            F
          
          
            
              q
              
                n
              
            
          
        
        →
        
          
            F
          
          
            
              q
              
                n
              
            
          
        
      
    
    {\displaystyle \mathbb {F} _{q^{n}}\to \mathbb {F} _{q^{n}}}
  
 so we can apply the private polynomial 
  
    
      
        P
      
    
    {\displaystyle P}
  
 which is over 
  
    
      
        
          
            F
          
          
            
              q
              
                n
              
            
          
        
      
    
    {\displaystyle \mathbb {F} _{q^{n}}}
  
 and this result is denoted by 
  
    
      
        
          y
          ′
        
        ∈
        
          
            F
          
          
            
              q
              
                n
              
            
          
        
      
    
    {\displaystyle y'\in \mathbb {F} _{q^{n}}}
  
. Once again, 
  
    
      
        
          y
          ′
        
      
    
    {\displaystyle y'}
  
 is transferred to the vector 
  
    
      
        (
        
          y
          
            1
          
          ′
        
        ,
        .
        .
        .
        ,
        
          y
          
            n
          
          ′
        
        )
      
    
    {\displaystyle (y_{1}',...,y_{n}')}
  
 and the transformation 
  
    
      
        T
      
    
    {\displaystyle T}
  
 is applied and the final output 
  
    
      
        y
        ∈
        
          
            F
          
          
            
              q
              
                n
              
            
          
        
      
    
    {\displaystyle y\in \mathbb {F} _{q^{n}}}
  
 is produced from 
  
    
      
        (
        
          y
          
            1
          
        
        ,
        .
        .
        .
        ,
        
          y
          
            n
          
        
        )
        ∈
        
          
            F
          
          
            q
          
          
            n
          
        
      
    
    {\displaystyle (y_{1},...,y_{n})\in \mathbb {F} _{q}^{n}}
  
.
To decrypt 
  
    
      
        y
      
    
    {\displaystyle y}
  
, the above steps are done in reverse order. This is possible if the private key 
  
    
      
        (
        S
        ,
        P
        ,
        T
        )
      
    
    {\displaystyle (S,P,T)}
  
 is known. The crucial step in the deciphering is not the inversion of 
  
    
      
        S
      
    
    {\displaystyle S}
  
 and 
  
    
      
        T
      
    
    {\displaystyle T}
  
 but rather the computations of the solution of 
  
    
      
        P
        (
        
          x
          ′
        
        )
        =
        
          y
          ′
        
      
    
    {\displaystyle P(x')=y'}
  
. Since 
  
    
      
        P
      
    
    {\displaystyle P}
  
 is not necessary a bijection, one may find more than one solution to this inversion (there exist at most d different solutions 
  
    
      
        
          X
          ′
        
        =
        (
        
          x
          
            1
          
          ′
        
        ,
        .
        .
        .
        ,
        
          x
          
            d
          
          ′
        
        )
        ∈
        
          
            F
          
          
            
              q
              
                n
              
            
          
        
      
    
    {\displaystyle X'=(x_{1}',...,x_{d}')\in \mathbb {F} _{q^{n}}}
  
 since 
  
    
      
        P
      
    
    {\displaystyle P}
  
 is a polynomial of degree d). The redundancy denoted as 
  
    
      
        r
      
    
    {\displaystyle r}
  
 is added at the first step to the message 
  
    
      
        M
      
    
    {\displaystyle M}
  
 in order to select the right 
  
    
      
        M
      
    
    {\displaystyle M}
  
 from the set of solutions 
  
    
      
        
          X
          ′
        
      
    
    {\displaystyle X'}
  
. The diagram below shows the basic HFE for encryption.

  
    
      
        M
        
          
            →
            
              +
              r
            
          
        
        x
        
          
            →
            
              
                secret
              
              :
              S
            
          
        
        
          x
          ′
        
        
          
            →
            
              
                secret
              
              :
              P
            
          
        
        
          y
          ′
        
        
          
            →
            
              
                secret
              
              :
              T
            
          
        
        y
      
    
    {\displaystyle M{\overset {+r}{\to }}x{\overset {{\text{secret}}:S}{\to }}x'{\overset {{\text{secret}}:P}{\to }}y'{\overset {{\text{secret}}:T}{\to }}y}
  


== HFE variations ==
Hidden Field Equations has four basic variations namely +,-,v and f and it is possible to combine them in various way. The basic principle is the following:

01. The + sign consists of linearity mixing of the public equations with some random equations.
02. The - sign is due to Adi Shamir and intends to remove the redundancy 'r' of the public equations.
03. The f sign consists of fixing some 
  
    
      
        f
      
    
    {\displaystyle f}
  
 input variables of the public key, this variant is sometimes called p for projection.
04. The v sign is defined as a construction and sometimes quite complex such that the inverse of the function can be found only if some v of the variables called vinegar variables are fixed. This idea is due to Jacques Patarin.
05. The IP sign means Internal perturbation, it consists in adding random quadratic polynomial to the secret equations. However the random quadratic polynomial is composed with a small rank linear map. Making it possible to invert.
06. The LL'  variant consist in adding a random linear combination of a small number of product of linear map to every public equations. It is meant to be used in encryption mode.
The operations above preserve to some extent the trapdoor solvability of the function.
HFE- and HFEv were useful in signature schemes as they prevent from slowing down the signature generation and also enhance the overall security of HFE whereas for encryption both HFE- and HFEv will lead to a rather slow decryption process so neither too many equations can be removed (HFE-) nor too many variables should be added (HFEv). Both HFE- and HFEv were used to obtain Quartz. However due to new Min-Ranks attack by Ding, Petzoldt and Tao it made these scheme obsolete.
For Signatures it is now recommended to use HFE IP- or HFE IPv. Indeed the IP variant is very effective against certain type of Min-Rank attacks (Min-Rank S) while v or - variant are effective against all other attacks (Mainly Min-Rank T or Gröbner Basis attacks).
For encryption, the only current recommended scheme is HFE LL'.


== HFE attacks ==
There are two famous attacks on HFE:
Recover the Private Key (Shamir-Kipnis): The key point of this attack is to recover the private key as sparse univariate polynomials over the extension field 
  
    
      
        
          
            F
          
          
            
              q
              
                n
              
            
          
        
      
    
    {\displaystyle \mathbb {F} _{q^{n}}}
  
. The attack only works for basic HFE and fails for all its variations.
Fast Gröbner Bases (Faugère): The idea of Faugère's attacks is to use fast algorithm to compute a Gröbner basis of  the system of polynomial equations. Faugère broke the HFE challenge 1 in 96 hours in 2002, and in 2003 Faugère and Joux worked together on the security of HFE.


== References ==

Nicolas T. Courtois, Magnus Daum and Patrick Felke, On the Security of HFE, HFEv- and Quartz
Andrey Sidorenko, Hidden Field Equations, EIDMA Seminar 2004 Technische Universiteit Eindhoven
Yvo G. Desmet, Public Key Cryptography-PKC 2003, ISBN 3-540-00324-X