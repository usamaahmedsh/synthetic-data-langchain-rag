In mathematics, the discrete Fourier transform over a ring generalizes the discrete Fourier transform (DFT), of a function whose values are commonly complex numbers, over an arbitrary ring.


== Definition ==
Let R be any ring, let 
  
    
      
        n
        ≥
        1
      
    
    {\displaystyle n\geq 1}
  
 be an integer, and let 
  
    
      
        α
        ∈
        R
      
    
    {\displaystyle \alpha \in R}
  
 be a principal nth root of unity, defined by:

The discrete Fourier transform maps an n-tuple 
  
    
      
        (
        
          v
          
            0
          
        
        ,
        …
        ,
        
          v
          
            n
            −
            1
          
        
        )
      
    
    {\displaystyle (v_{0},\ldots ,v_{n-1})}
  
 of elements of R to another n-tuple 
  
    
      
        (
        
          f
          
            0
          
        
        ,
        …
        ,
        
          f
          
            n
            −
            1
          
        
        )
      
    
    {\displaystyle (f_{0},\ldots ,f_{n-1})}
  
 of elements of R according to the following formula:

By convention, the tuple 
  
    
      
        (
        
          v
          
            0
          
        
        ,
        …
        ,
        
          v
          
            n
            −
            1
          
        
        )
      
    
    {\displaystyle (v_{0},\ldots ,v_{n-1})}
  
 is said to be in the time domain and the index j is called time. The tuple 
  
    
      
        (
        
          f
          
            0
          
        
        ,
        …
        ,
        
          f
          
            n
            −
            1
          
        
        )
      
    
    {\displaystyle (f_{0},\ldots ,f_{n-1})}
  
 is said to be in the frequency domain and the index k is called frequency. The tuple 
  
    
      
        (
        
          f
          
            0
          
        
        ,
        …
        ,
        
          f
          
            n
            −
            1
          
        
        )
      
    
    {\displaystyle (f_{0},\ldots ,f_{n-1})}
  
 is also called the spectrum of 
  
    
      
        (
        
          v
          
            0
          
        
        ,
        …
        ,
        
          v
          
            n
            −
            1
          
        
        )
      
    
    {\displaystyle (v_{0},\ldots ,v_{n-1})}
  
. This terminology derives from the applications of Fourier transforms in signal processing.
If R is an integral domain (which includes fields), it is sufficient to choose 
  
    
      
        α
      
    
    {\displaystyle \alpha }
  
 as a primitive nth root of unity, which replaces the condition (1) by:

  
    
      
        
          α
          
            k
          
        
        ≠
        1
      
    
    {\displaystyle \alpha ^{k}\neq 1}
  
 for 
  
    
      
        1
        ≤
        k
        <
        n
      
    
    {\displaystyle 1\leq k<n}
  

Another simple condition applies in the case where n is a power of two: (1) may be replaced by 
  
    
      
        
          α
          
            n
            
              /
            
            2
          
        
        =
        −
        1
      
    
    {\displaystyle \alpha ^{n/2}=-1}
  
.


== Inverse ==
The inverse of the discrete Fourier transform is given as:

where 
  
    
      
        1
        
          /
        
        n
      
    
    {\displaystyle 1/n}
  
 is the multiplicative inverse of n in R (if this inverse does not exist, the DFT cannot be inverted).


== Matrix formulation ==
Since the discrete Fourier transform is a linear operator, it can be described by matrix multiplication. In matrix notation, the discrete Fourier transform is expressed as follows:

  
    
      
        
          
            [
            
              
                
                  
                    f
                    
                      0
                    
                  
                
              
              
                
                  
                    f
                    
                      1
                    
                  
                
              
              
                
                  ⋮
                
              
              
                
                  
                    f
                    
                      n
                      −
                      1
                    
                  
                
              
            
            ]
          
        
        =
        
          
            [
            
              
                
                  1
                
                
                  1
                
                
                  1
                
                
                  ⋯
                
                
                  1
                
              
              
                
                  1
                
                
                  α
                
                
                  
                    α
                    
                      2
                    
                  
                
                
                  ⋯
                
                
                  
                    α
                    
                      n
                      −
                      1
                    
                  
                
              
              
                
                  1
                
                
                  
                    α
                    
                      2
                    
                  
                
                
                  
                    α
                    
                      4
                    
                  
                
                
                  ⋯
                
                
                  
                    α
                    
                      2
                      (
                      n
                      −
                      1
                      )
                    
                  
                
              
              
                
                  ⋮
                
                
                  ⋮
                
                
                  ⋮
                
                
                  ⋱
                
                
                  ⋮
                
              
              
                
                  1
                
                
                  
                    α
                    
                      n
                      −
                      1
                    
                  
                
                
                  
                    α
                    
                      2
                      (
                      n
                      −
                      1
                      )
                    
                  
                
                
                  ⋯
                
                
                  
                    α
                    
                      (
                      n
                      −
                      1
                      )
                      (
                      n
                      −
                      1
                      )
                    
                  
                
              
            
            ]
          
        
        
          
            [
            
              
                
                  
                    v
                    
                      0
                    
                  
                
              
              
                
                  
                    v
                    
                      1
                    
                  
                
              
              
                
                  ⋮
                
              
              
                
                  
                    v
                    
                      n
                      −
                      1
                    
                  
                
              
            
            ]
          
        
        .
      
    
    {\displaystyle {\begin{bmatrix}f_{0}\\f_{1}\\\vdots \\f_{n-1}\end{bmatrix}}={\begin{bmatrix}1&1&1&\cdots &1\\1&\alpha &\alpha ^{2}&\cdots &\alpha ^{n-1}\\1&\alpha ^{2}&\alpha ^{4}&\cdots &\alpha ^{2(n-1)}\\\vdots &\vdots &\vdots &\ddots &\vdots \\1&\alpha ^{n-1}&\alpha ^{2(n-1)}&\cdots &\alpha ^{(n-1)(n-1)}\\\end{bmatrix}}{\begin{bmatrix}v_{0}\\v_{1}\\\vdots \\v_{n-1}\end{bmatrix}}.}
  

The matrix for this transformation is called the DFT matrix.
Similarly, the matrix notation for the inverse Fourier transform is 

  
    
      
        
          
            [
            
              
                
                  
                    v
                    
                      0
                    
                  
                
              
              
                
                  
                    v
                    
                      1
                    
                  
                
              
              
                
                  ⋮
                
              
              
                
                  
                    v
                    
                      n
                      −
                      1
                    
                  
                
              
            
            ]
          
        
        =
        
          
            1
            n
          
        
        
          
            [
            
              
                
                  1
                
                
                  1
                
                
                  1
                
                
                  ⋯
                
                
                  1
                
              
              
                
                  1
                
                
                  
                    α
                    
                      −
                      1
                    
                  
                
                
                  
                    α
                    
                      −
                      2
                    
                  
                
                
                  ⋯
                
                
                  
                    α
                    
                      −
                      (
                      n
                      −
                      1
                      )
                    
                  
                
              
              
                
                  1
                
                
                  
                    α
                    
                      −
                      2
                    
                  
                
                
                  
                    α
                    
                      −
                      4
                    
                  
                
                
                  ⋯
                
                
                  
                    α
                    
                      −
                      2
                      (
                      n
                      −
                      1
                      )
                    
                  
                
              
              
                
                  ⋮
                
                
                  ⋮
                
                
                  ⋮
                
                
                  ⋱
                
                
                  ⋮
                
              
              
                
                  1
                
                
                  
                    α
                    
                      −
                      (
                      n
                      −
                      1
                      )
                    
                  
                
                
                  
                    α
                    
                      −
                      2
                      (
                      n
                      −
                      1
                      )
                    
                  
                
                
                  ⋯
                
                
                  
                    α
                    
                      −
                      (
                      n
                      −
                      1
                      )
                      (
                      n
                      −
                      1
                      )
                    
                  
                
              
            
            ]
          
        
        
          
            [
            
              
                
                  
                    f
                    
                      0
                    
                  
                
              
              
                
                  
                    f
                    
                      1
                    
                  
                
              
              
                
                  ⋮
                
              
              
                
                  
                    f
                    
                      n
                      −
                      1
                    
                  
                
              
            
            ]
          
        
        .
      
    
    {\displaystyle {\begin{bmatrix}v_{0}\\v_{1}\\\vdots \\v_{n-1}\end{bmatrix}}={\frac {1}{n}}{\begin{bmatrix}1&1&1&\cdots &1\\1&\alpha ^{-1}&\alpha ^{-2}&\cdots &\alpha ^{-(n-1)}\\1&\alpha ^{-2}&\alpha ^{-4}&\cdots &\alpha ^{-2(n-1)}\\\vdots &\vdots &\vdots &\ddots &\vdots \\1&\alpha ^{-(n-1)}&\alpha ^{-2(n-1)}&\cdots &\alpha ^{-(n-1)(n-1)}\end{bmatrix}}{\begin{bmatrix}f_{0}\\f_{1}\\\vdots \\f_{n-1}\end{bmatrix}}.}
  


== Polynomial formulation ==
Sometimes it is convenient to identify an n-tuple 
  
    
      
        (
        
          v
          
            0
          
        
        ,
        …
        ,
        
          v
          
            n
            −
            1
          
        
        )
      
    
    {\displaystyle (v_{0},\ldots ,v_{n-1})}
  
 with a formal polynomial

  
    
      
        
          p
          
            v
          
        
        (
        x
        )
        =
        
          v
          
            0
          
        
        +
        
          v
          
            1
          
        
        x
        +
        
          v
          
            2
          
        
        
          x
          
            2
          
        
        +
        ⋯
        +
        
          v
          
            n
            −
            1
          
        
        
          x
          
            n
            −
            1
          
        
        .
        
      
    
    {\displaystyle p_{v}(x)=v_{0}+v_{1}x+v_{2}x^{2}+\cdots +v_{n-1}x^{n-1}.\,}
  

By writing out the summation in the definition of the discrete Fourier transform (2), we obtain:

  
    
      
        
          f
          
            k
          
        
        =
        
          v
          
            0
          
        
        +
        
          v
          
            1
          
        
        
          α
          
            k
          
        
        +
        
          v
          
            2
          
        
        
          α
          
            2
            k
          
        
        +
        ⋯
        +
        
          v
          
            n
            −
            1
          
        
        
          α
          
            (
            n
            −
            1
            )
            k
          
        
        .
        
      
    
    {\displaystyle f_{k}=v_{0}+v_{1}\alpha ^{k}+v_{2}\alpha ^{2k}+\cdots +v_{n-1}\alpha ^{(n-1)k}.\,}
  

This means that 
  
    
      
        
          f
          
            k
          
        
      
    
    {\displaystyle f_{k}}
  
 is just the value of the polynomial 
  
    
      
        
          p
          
            v
          
        
        (
        x
        )
      
    
    {\displaystyle p_{v}(x)}
  
 for 
  
    
      
        x
        =
        
          α
          
            k
          
        
      
    
    {\displaystyle x=\alpha ^{k}}
  
, i.e.,

The Fourier transform can therefore be seen to relate the coefficients and the values of a polynomial: the coefficients are in the time-domain, and the values are in the frequency domain. Here, of course, it is important that the polynomial is evaluated at the nth roots of unity, which are exactly the powers of 
  
    
      
        α
      
    
    {\displaystyle \alpha }
  
.
Similarly, the definition of the inverse Fourier transform (3) can be written:

With

  
    
      
        
          p
          
            f
          
        
        (
        x
        )
        =
        
          f
          
            0
          
        
        +
        
          f
          
            1
          
        
        x
        +
        
          f
          
            2
          
        
        
          x
          
            2
          
        
        +
        ⋯
        +
        
          f
          
            n
            −
            1
          
        
        
          x
          
            n
            −
            1
          
        
        ,
      
    
    {\displaystyle p_{f}(x)=f_{0}+f_{1}x+f_{2}x^{2}+\cdots +f_{n-1}x^{n-1},}
  

this means that

  
    
      
        
          v
          
            j
          
        
        =
        
          
            1
            n
          
        
        
          p
          
            f
          
        
        (
        
          α
          
            −
            j
          
        
        )
        .
      
    
    {\displaystyle v_{j}={\frac {1}{n}}p_{f}(\alpha ^{-j}).}
  

We can summarize this as follows: if the values of 
  
    
      
        
          p
          
            v
          
        
        (
        x
        )
      
    
    {\displaystyle p_{v}(x)}
  
 are the coefficients of 
  
    
      
        
          p
          
            f
          
        
        (
        x
        )
      
    
    {\displaystyle p_{f}(x)}
  
, then the values of 
  
    
      
        
          p
          
            f
          
        
        (
        x
        )
      
    
    {\displaystyle p_{f}(x)}
  
 are the coefficients of 
  
    
      
        
          p
          
            v
          
        
        (
        x
        )
      
    
    {\displaystyle p_{v}(x)}
  
, up to a scalar factor and reordering.


== Special cases ==


=== Complex numbers ===
If 
  
    
      
        F
        =
        
          
            C
          
        
      
    
    {\displaystyle F={\mathbb {C} }}
  
 is the field of complex numbers, then the 
  
    
      
        n
      
    
    {\displaystyle n}
  
th roots of unity can be visualized as points on the unit circle of the complex plane. In this case, one usually takes

  
    
      
        α
        =
        
          e
          
            
              
                −
                2
                π
                i
              
              n
            
          
        
        ,
      
    
    {\displaystyle \alpha =e^{\frac {-2\pi i}{n}},}
  

which yields the usual formula for the complex discrete Fourier transform:

  
    
      
        
          f
          
            k
          
        
        =
        
          ∑
          
            j
            =
            0
          
          
            n
            −
            1
          
        
        
          v
          
            j
          
        
        
          e
          
            
              
                
                  −
                  2
                  π
                  i
                
                n
              
            
            j
            k
          
        
        .
      
    
    {\displaystyle f_{k}=\sum _{j=0}^{n-1}v_{j}e^{{\frac {-2\pi i}{n}}jk}.}
  

Over the complex numbers, it is often customary to normalize the formulas for the DFT and inverse DFT by using the scalar factor 
  
    
      
        
          
            1
            
              n
            
          
        
      
    
    {\displaystyle {\frac {1}{\sqrt {n}}}}
  
 in both formulas, rather than 
  
    
      
        1
      
    
    {\displaystyle 1}
  
 in the formula for the DFT and 
  
    
      
        
          
            1
            n
          
        
      
    
    {\displaystyle {\frac {1}{n}}}
  
 in the formula for the inverse DFT. With this normalization, the DFT matrix is then unitary. 
Note that 
  
    
      
        
          
            n
          
        
      
    
    {\displaystyle {\sqrt {n}}}
  
 does not make sense in an arbitrary field.


=== Finite fields ===
If 
  
    
      
        F
        =
        
          G
          F
        
        (
        q
        )
      
    
    {\displaystyle F=\mathrm {GF} (q)}
  
 is a finite field, where q is a prime power, then the existence of a primitive nth root automatically implies that n divides 
  
    
      
        q
        −
        1
      
    
    {\displaystyle q-1}
  
, because the multiplicative order of each element must divide the size of the multiplicative group of F, which is 
  
    
      
        q
        −
        1
      
    
    {\displaystyle q-1}
  
. This in particular ensures that 
  
    
      
        n
        =
        
          
            
              
                1
                +
                1
                +
                ⋯
                +
                1
              
              ⏟
            
          
          
            n
             
            
              
                t
                i
                m
                e
                s
              
            
          
        
      
    
    {\displaystyle n=\underbrace {1+1+\cdots +1} _{n\ {\rm {times}}}}
  
 is invertible, so that the notation 
  
    
      
        
          
            1
            n
          
        
      
    
    {\displaystyle {\frac {1}{n}}}
  
 in (3) makes sense.
An application of the discrete Fourier transform over 
  
    
      
        
          G
          F
        
        (
        q
        )
      
    
    {\displaystyle \mathrm {GF} (q)}
  
 is the reduction of Reed–Solomon codes to BCH codes in coding theory. Such transform can be carried out efficiently with proper fast algorithms, for example, cyclotomic fast Fourier transform.


==== Polynomial formulation without nth root ====
Suppose 
  
    
      
        F
        =
        
          G
          F
        
        (
        p
        )
      
    
    {\displaystyle F=\mathrm {GF} (p)}
  
. If 
  
    
      
        p
        ∤
        n
      
    
    {\displaystyle p\nmid n}
  
, it may be the case that 
  
    
      
        n
        ∤
        p
        −
        1
      
    
    {\displaystyle n\nmid p-1}
  
. This means we cannot find an 
  
    
      
        
          n
          
            t
            h
          
        
      
    
    {\displaystyle n^{th}}
  
 root of unity in 
  
    
      
        F
      
    
    {\displaystyle F}
  
. We may view the Fourier transform as an isomorphism 
  
    
      
        
          F
        
        [
        
          C
          
            n
          
        
        ]
        =
        
          F
        
        [
        x
        ]
        
          /
        
        (
        
          x
          
            n
          
        
        −
        1
        )
        ≅
        
          ⨁
          
            i
          
        
        
          F
        
        [
        x
        ]
        
          /
        
        (
        
          P
          
            i
          
        
        (
        x
        )
        )
      
    
    {\displaystyle \mathrm {F} [C_{n}]=\mathrm {F} [x]/(x^{n}-1)\cong \bigoplus _{i}\mathrm {F} [x]/(P_{i}(x))}
  
 for some polynomials 
  
    
      
        
          P
          
            i
          
        
        (
        x
        )
      
    
    {\displaystyle P_{i}(x)}
  
, in accordance with Maschke's theorem. The map is given by the Chinese remainder theorem, and the inverse is given by applying Bézout's identity for polynomials.

  
    
      
        
          x
          
            n
          
        
        −
        1
        =
        
          ∏
          
            d
            
              |
            
            n
          
        
        
          Φ
          
            d
          
        
        (
        x
        )
      
    
    {\displaystyle x^{n}-1=\prod _{d|n}\Phi _{d}(x)}
  
, a product of cyclotomic polynomials. Factoring 
  
    
      
        
          Φ
          
            d
          
        
        (
        x
        )
      
    
    {\displaystyle \Phi _{d}(x)}
  
 in 
  
    
      
        F
        [
        x
        ]
      
    
    {\displaystyle F[x]}
  
 is equivalent to factoring the prime ideal 
  
    
      
        (
        p
        )
      
    
    {\displaystyle (p)}
  
 in 
  
    
      
        
          Z
        
        [
        ζ
        ]
        =
        
          Z
        
        [
        x
        ]
        
          /
        
        (
        
          Φ
          
            d
          
        
        (
        x
        )
        )
      
    
    {\displaystyle \mathrm {Z} [\zeta ]=\mathrm {Z} [x]/(\Phi _{d}(x))}
  
. We obtain 
  
    
      
        g
      
    
    {\displaystyle g}
  
 polynomials 
  
    
      
        
          P
          
            1
          
        
        …
        
          P
          
            g
          
        
      
    
    {\displaystyle P_{1}\ldots P_{g}}
  
 of degree 
  
    
      
        f
      
    
    {\displaystyle f}
  
 where 
  
    
      
        f
        g
        =
        φ
        (
        d
        )
      
    
    {\displaystyle fg=\varphi (d)}
  
 and 
  
    
      
        f
      
    
    {\displaystyle f}
  
 is the order of 
  
    
      
        p
        
           mod 
        
        d
      
    
    {\displaystyle p{\text{ mod }}d}
  
.
As above, we may extend the base field to 
  
    
      
        
          G
          F
        
        (
        q
        )
      
    
    {\displaystyle \mathrm {GF} (q)}
  
 in order to find a primitive root, i.e. a splitting field for 
  
    
      
        
          x
          
            n
          
        
        −
        1
      
    
    {\displaystyle x^{n}-1}
  
. Now 
  
    
      
        
          x
          
            n
          
        
        −
        1
        =
        
          ∏
          
            k
          
        
        (
        x
        −
        
          α
          
            k
          
        
        )
      
    
    {\displaystyle x^{n}-1=\prod _{k}(x-\alpha ^{k})}
  
, so an element 
  
    
      
        
          ∑
          
            j
            =
            0
          
          
            n
            −
            1
          
        
        
          v
          
            j
          
        
        
          x
          
            j
          
        
        ∈
        F
        [
        x
        ]
        
          /
        
        (
        
          x
          
            n
          
        
        −
        1
        )
      
    
    {\displaystyle \sum _{j=0}^{n-1}v_{j}x^{j}\in F[x]/(x^{n}-1)}
  
 maps to 
  
    
      
        
          ∑
          
            j
            =
            0
          
          
            n
            −
            1
          
        
        
          v
          
            j
          
        
        
          x
          
            j
          
        
        
        mod
        
        
        (
        x
        −
        
          α
          
            k
          
        
        )
        ≡
        
          ∑
          
            j
            =
            0
          
          
            n
            −
            1
          
        
        
          v
          
            j
          
        
        (
        
          α
          
            k
          
        
        
          )
          
            j
          
        
      
    
    {\displaystyle \sum _{j=0}^{n-1}v_{j}x^{j}\mod (x-\alpha ^{k})\equiv \sum _{j=0}^{n-1}v_{j}(\alpha ^{k})^{j}}
  
 for each 
  
    
      
        k
      
    
    {\displaystyle k}
  
.


==== When p divides n ====
When 
  
    
      
        p
        
          |
        
        n
      
    
    {\displaystyle p|n}
  
, we may still define an 
  
    
      
        
          F
          
            p
          
        
      
    
    {\displaystyle F_{p}}
  
-linear isomorphism as above. Note that 
  
    
      
        (
        
          x
          
            n
          
        
        −
        1
        )
        =
        (
        
          x
          
            m
          
        
        −
        1
        
          )
          
            
              p
              
                s
              
            
          
        
      
    
    {\displaystyle (x^{n}-1)=(x^{m}-1)^{p^{s}}}
  
 where 
  
    
      
        n
        =
        m
        
          p
          
            s
          
        
      
    
    {\displaystyle n=mp^{s}}
  
 and 
  
    
      
        p
        ∤
        m
      
    
    {\displaystyle p\nmid m}
  
. We apply the above factorization to 
  
    
      
        
          x
          
            m
          
        
        −
        1
      
    
    {\displaystyle x^{m}-1}
  
, and now obtain the decomposition 
  
    
      
        F
        [
        x
        ]
        
          /
        
        (
        
          x
          
            n
          
        
        −
        1
        )
        ≅
        
          ⨁
          
            i
          
        
        F
        [
        x
        ]
        
          /
        
        (
        
          P
          
            i
          
        
        (
        x
        
          )
          
            
              p
              
                s
              
            
          
        
        )
      
    
    {\displaystyle F[x]/(x^{n}-1)\cong \bigoplus _{i}F[x]/(P_{i}(x)^{p^{s}})}
  
. The modules occurring are now indecomposable rather than irreducible.


==== Order of the DFT matrix ====
Suppose 
  
    
      
        p
        ∤
        n
      
    
    {\displaystyle p\nmid n}
  
 so we have an 
  
    
      
        
          n
          
            t
            h
          
        
      
    
    {\displaystyle n^{th}}
  
 root of unity 
  
    
      
        α
      
    
    {\displaystyle \alpha }
  
. Let 
  
    
      
        A
      
    
    {\displaystyle A}
  
 be the above DFT matrix, a Vandermonde matrix with entries 
  
    
      
        
          A
          
            i
            j
          
        
        =
        
          α
          
            i
            j
          
        
      
    
    {\displaystyle A_{ij}=\alpha ^{ij}}
  
 for 
  
    
      
        0
        ≤
        i
        ,
        j
        <
        n
      
    
    {\displaystyle 0\leq i,j<n}
  
. Recall that 
  
    
      
        
          ∑
          
            j
            =
            0
          
          
            n
            −
            1
          
        
        
          α
          
            (
            k
            −
            l
            )
            j
          
        
        =
        n
        
          δ
          
            k
            ,
            l
          
        
      
    
    {\displaystyle \sum _{j=0}^{n-1}\alpha ^{(k-l)j}=n\delta _{k,l}}
  
 since if 
  
    
      
        k
        =
        l
      
    
    {\displaystyle k=l}
  
, then every entry is 1. If 
  
    
      
        k
        ≠
        l
      
    
    {\displaystyle k\neq l}
  
, then we have a geometric series with common ratio 
  
    
      
        
          α
          
            k
            −
            l
          
        
      
    
    {\displaystyle \alpha ^{k-l}}
  
, so we obtain 
  
    
      
        
          
            
              1
              −
              
                α
                
                  n
                  (
                  k
                  −
                  l
                  )
                
              
            
            
              1
              −
              
                α
                
                  k
                  −
                  l
                
              
            
          
        
      
    
    {\displaystyle {\frac {1-\alpha ^{n(k-l)}}{1-\alpha ^{k-l}}}}
  
. Since 
  
    
      
        
          α
          
            n
          
        
        =
        1
      
    
    {\displaystyle \alpha ^{n}=1}
  
 the numerator is zero, but 
  
    
      
        k
        −
        l
        ≠
        0
      
    
    {\displaystyle k-l\neq 0}
  
 so the denominator is nonzero.
First computing the square, 
  
    
      
        (
        
          A
          
            2
          
        
        
          )
          
            i
            k
          
        
        =
        
          ∑
          
            j
            =
            0
          
          
            n
            −
            1
          
        
        
          α
          
            j
            (
            i
            +
            k
            )
          
        
        =
        n
        
          δ
          
            i
            ,
            −
            k
          
        
      
    
    {\displaystyle (A^{2})_{ik}=\sum _{j=0}^{n-1}\alpha ^{j(i+k)}=n\delta _{i,-k}}
  
. Computing 
  
    
      
        
          A
          
            4
          
        
        =
        (
        
          A
          
            2
          
        
        
          )
          
            2
          
        
      
    
    {\displaystyle A^{4}=(A^{2})^{2}}
  
 similarly and simplifying the deltas, we obtain 
  
    
      
        (
        
          A
          
            4
          
        
        
          )
          
            i
            k
          
        
        =
        
          n
          
            2
          
        
        
          δ
          
            i
            ,
            k
          
        
      
    
    {\displaystyle (A^{4})_{ik}=n^{2}\delta _{i,k}}
  
. Thus, 
  
    
      
        
          A
          
            4
          
        
        =
        
          n
          
            2
          
        
        
          I
          
            n
          
        
      
    
    {\displaystyle A^{4}=n^{2}I_{n}}
  
 and the order is 
  
    
      
        4
        ⋅
        
          ord
        
        (
        
          n
          
            2
          
        
        )
      
    
    {\displaystyle 4\cdot {\text{ord}}(n^{2})}
  
.


==== Normalizing the DFT matrix ====
In order to align with the complex case and ensure the matrix is order 4 exactly, we can normalize the above DFT matrix 
  
    
      
        A
      
    
    {\displaystyle A}
  
 with 
  
    
      
        
          
            1
            
              n
            
          
        
      
    
    {\displaystyle {\frac {1}{\sqrt {n}}}}
  
. Note that though 
  
    
      
        
          
            n
          
        
      
    
    {\displaystyle {\sqrt {n}}}
  
 may not exist in the splitting field 
  
    
      
        
          F
          
            q
          
        
      
    
    {\displaystyle F_{q}}
  
 of 
  
    
      
        
          x
          
            n
          
        
        −
        1
      
    
    {\displaystyle x^{n}-1}
  
, we may form a quadratic extension 
  
    
      
        
          F
          
            
              q
              
                2
              
            
          
        
        ≅
        
          F
          
            q
          
        
        [
        x
        ]
        
          /
        
        (
        
          x
          
            2
          
        
        −
        n
        )
      
    
    {\displaystyle F_{q^{2}}\cong F_{q}[x]/(x^{2}-n)}
  
 in which the square root exists. We may then set 
  
    
      
        U
        =
        
          
            1
            
              n
            
          
        
        A
      
    
    {\displaystyle U={\frac {1}{\sqrt {n}}}A}
  
, and 
  
    
      
        
          U
          
            4
          
        
        =
        
          I
          
            n
          
        
      
    
    {\displaystyle U^{4}=I_{n}}
  
.


==== Unitarity ====
Suppose 
  
    
      
        p
        ∤
        n
      
    
    {\displaystyle p\nmid n}
  
. One can ask whether the DFT matrix is unitary over a finite field. If the matrix entries are over 
  
    
      
        
          F
          
            q
          
        
      
    
    {\displaystyle F_{q}}
  
, then one must ensure 
  
    
      
        q
      
    
    {\displaystyle q}
  
 is a perfect square or extend to 
  
    
      
        
          F
          
            
              q
              
                2
              
            
          
        
      
    
    {\displaystyle F_{q^{2}}}
  
 in order to define the order two automorphism 
  
    
      
        x
        ↦
        
          x
          
            q
          
        
      
    
    {\displaystyle x\mapsto x^{q}}
  
. Consider the above DFT matrix 
  
    
      
        
          A
          
            i
            j
          
        
        =
        
          α
          
            i
            j
          
        
      
    
    {\displaystyle A_{ij}=\alpha ^{ij}}
  
. Note that 
  
    
      
        A
      
    
    {\displaystyle A}
  
 is symmetric. Conjugating and transposing, we obtain 
  
    
      
        
          A
          
            i
            j
          
          
            ∗
          
        
        =
        
          α
          
            q
            j
            i
          
        
      
    
    {\displaystyle A_{ij}^{*}=\alpha ^{qji}}
  
.

  
    
      
        (
        A
        
          A
          
            ∗
          
        
        
          )
          
            i
            k
          
        
        =
        
          ∑
          
            j
            =
            0
          
          
            n
            −
            1
          
        
        
          α
          
            j
            (
            i
            +
            q
            k
            )
          
        
        =
        n
        
          δ
          
            i
            ,
            −
            q
            k
          
        
      
    
    {\displaystyle (AA^{*})_{ik}=\sum _{j=0}^{n-1}\alpha ^{j(i+qk)}=n\delta _{i,-qk}}
  

by a similar geometric series argument as above. We may remove the 
  
    
      
        n
      
    
    {\displaystyle n}
  
 by normalizing so that 
  
    
      
        U
        =
        
          
            1
            
              n
            
          
        
        A
      
    
    {\displaystyle U={\frac {1}{\sqrt {n}}}A}
  
 and 
  
    
      
        (
        U
        
          U
          
            ∗
          
        
        
          )
          
            i
            k
          
        
        =
        
          δ
          
            i
            ,
            −
            q
            k
          
        
      
    
    {\displaystyle (UU^{*})_{ik}=\delta _{i,-qk}}
  
. Thus 
  
    
      
        U
      
    
    {\displaystyle U}
  
 is unitary iff 
  
    
      
        q
        ≡
        −
        1
        
        (
        
          mod
        
        
        n
        )
      
    
    {\displaystyle q\equiv -1\,({\text{mod}}\,n)}
  
. Recall that since we have an 
  
    
      
        
          n
          
            t
            h
          
        
      
    
    {\displaystyle n^{th}}
  
 root of unity, 
  
    
      
        n
        
          |
        
        
          q
          
            2
          
        
        −
        1
      
    
    {\displaystyle n|q^{2}-1}
  
. This means that 
  
    
      
        
          q
          
            2
          
        
        −
        1
        ≡
        (
        q
        +
        1
        )
        (
        q
        −
        1
        )
        ≡
        0
        
        (
        
          mod
        
        
        n
        )
      
    
    {\displaystyle q^{2}-1\equiv (q+1)(q-1)\equiv 0\,({\text{mod}}\,n)}
  
. Note if 
  
    
      
        q
      
    
    {\displaystyle q}
  
 was not a perfect square to begin with, then 
  
    
      
        n
        
          |
        
        q
        −
        1
      
    
    {\displaystyle n|q-1}
  
 and so 
  
    
      
        q
        ≡
        1
        
        (
        
          mod
        
        
        n
        )
      
    
    {\displaystyle q\equiv 1\,({\text{mod}}\,n)}
  
.
For example, when 
  
    
      
        p
        =
        3
        ,
        n
        =
        5
      
    
    {\displaystyle p=3,n=5}
  
 we need to extend to 
  
    
      
        
          q
          
            2
          
        
        =
        
          3
          
            4
          
        
      
    
    {\displaystyle q^{2}=3^{4}}
  
 to get a 5th root of unity. 
  
    
      
        q
        =
        9
        ≡
        −
        1
        
        (
        
          mod
        
        
        5
        )
      
    
    {\displaystyle q=9\equiv -1\,({\text{mod}}\,5)}
  
.
For a nonexample, when 
  
    
      
        p
        =
        3
        ,
        n
        =
        8
      
    
    {\displaystyle p=3,n=8}
  
 we extend to 
  
    
      
        
          F
          
            
              3
              
                2
              
            
          
        
      
    
    {\displaystyle F_{3^{2}}}
  
 to get an 8th root of unity. 
  
    
      
        
          q
          
            2
          
        
        =
        9
      
    
    {\displaystyle q^{2}=9}
  
, so 
  
    
      
        q
        ≡
        3
        
        (
        
          mod
        
        
        8
        )
      
    
    {\displaystyle q\equiv 3\,({\text{mod}}\,8)}
  
, and in this case 
  
    
      
        q
        +
        1
        ≢
        0
      
    
    {\displaystyle q+1\not \equiv 0}
  
 and 
  
    
      
        q
        −
        1
        ≢
        0
      
    
    {\displaystyle q-1\not \equiv 0}
  
. 
  
    
      
        U
        
          U
          
            ∗
          
        
      
    
    {\displaystyle UU^{*}}
  
 is a square root of the identity, so 
  
    
      
        U
      
    
    {\displaystyle U}
  
 is not unitary.


==== Eigenvalues of the DFT matrix ====
When 
  
    
      
        p
        ∤
        n
      
    
    {\displaystyle p\nmid n}
  
, we have an 
  
    
      
        
          n
          
            t
            h
          
        
      
    
    {\displaystyle n^{th}}
  
 root of unity 
  
    
      
        α
      
    
    {\displaystyle \alpha }
  
 in the splitting field 
  
    
      
        
          F
          
            q
          
        
        ≅
        
          F
          
            p
          
        
        [
        x
        ]
        
          /
        
        (
        
          x
          
            n
          
        
        −
        1
        )
      
    
    {\displaystyle F_{q}\cong F_{p}[x]/(x^{n}-1)}
  
. Note that the characteristic polynomial of the above DFT matrix may not split over 
  
    
      
        
          F
          
            q
          
        
      
    
    {\displaystyle F_{q}}
  
. 
The DFT matrix is order 4. We may need to go to a further extension 
  
    
      
        
          F
          
            
              q
              ′
            
          
        
      
    
    {\displaystyle F_{q'}}
  
, the splitting extension of the characteristic polynomial of the DFT matrix, which at least contains fourth roots of unity. If 
  
    
      
        a
      
    
    {\displaystyle a}
  
 is a generator of the multiplicative group of 
  
    
      
        
          F
          
            
              q
              ′
            
          
        
      
    
    {\displaystyle F_{q'}}
  
, then the eigenvalues are 
  
    
      
        {
        ±
        1
        ,
        ±
        
          a
          
            (
            
              q
              ′
            
            −
            1
            )
            
              /
            
            4
          
        
        }
      
    
    {\displaystyle \{\pm 1,\pm a^{(q'-1)/4}\}}
  
, in exact analogy with the complex case. They occur with some nonnegative multiplicity.


=== Number-theoretic transform ===
The number-theoretic transform (NTT) is obtained by specializing the discrete Fourier transform to 
  
    
      
        F
        =
        
          
            Z
          
        
        
          /
        
        p
      
    
    {\displaystyle F={\mathbb {Z} }/p}
  
, the integers modulo a prime p. This is a finite field, and primitive nth roots of unity exist whenever n divides 
  
    
      
        p
        −
        1
      
    
    {\displaystyle p-1}
  
, so we have 
  
    
      
        p
        =
        ξ
        n
        +
        1
      
    
    {\displaystyle p=\xi n+1}
  
 for a positive integer ξ. Specifically, let 
  
    
      
        ω
      
    
    {\displaystyle \omega }
  
 be a primitive 
  
    
      
        (
        p
        −
        1
        )
      
    
    {\displaystyle (p-1)}
  
th root of unity, then an nth root of unity 
  
    
      
        α
      
    
    {\displaystyle \alpha }
  
 can be found by letting 
  
    
      
        α
        =
        
          ω
          
            ξ
          
        
      
    
    {\displaystyle \alpha =\omega ^{\xi }}
  
.
e.g. for 
  
    
      
        p
        =
        5
      
    
    {\displaystyle p=5}
  
, 
  
    
      
        α
        =
        2
      
    
    {\displaystyle \alpha =2}
  

  
    
      
        
          
            
              
                
                  2
                  
                    1
                  
                
              
              
                
                =
                2
                
                  
                  (
                  mod
                  
                  5
                  )
                
              
            
            
              
                
                  2
                  
                    2
                  
                
              
              
                
                =
                4
                
                  
                  (
                  mod
                  
                  5
                  )
                
              
            
            
              
                
                  2
                  
                    3
                  
                
              
              
                
                =
                3
                
                  
                  (
                  mod
                  
                  5
                  )
                
              
            
            
              
                
                  2
                  
                    4
                  
                
              
              
                
                =
                1
                
                  
                  (
                  mod
                  
                  5
                  )
                
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}2^{1}&=2{\pmod {5}}\\2^{2}&=4{\pmod {5}}\\2^{3}&=3{\pmod {5}}\\2^{4}&=1{\pmod {5}}\end{aligned}}}
  

when 
  
    
      
        N
        =
        4
      
    
    {\displaystyle N=4}
  

  
    
      
        
          
            [
            
              
                
                  F
                  (
                  0
                  )
                
              
              
                
                  F
                  (
                  1
                  )
                
              
              
                
                  F
                  (
                  2
                  )
                
              
              
                
                  F
                  (
                  3
                  )
                
              
            
            ]
          
        
        =
        
          
            [
            
              
                
                  1
                
                
                  1
                
                
                  1
                
                
                  1
                
              
              
                
                  1
                
                
                  2
                
                
                  4
                
                
                  3
                
              
              
                
                  1
                
                
                  4
                
                
                  1
                
                
                  4
                
              
              
                
                  1
                
                
                  3
                
                
                  4
                
                
                  2
                
              
            
            ]
          
        
        
          
            [
            
              
                
                  f
                  (
                  0
                  )
                
              
              
                
                  f
                  (
                  1
                  )
                
              
              
                
                  f
                  (
                  2
                  )
                
              
              
                
                  f
                  (
                  3
                  )
                
              
            
            ]
          
        
      
    
    {\displaystyle {\begin{bmatrix}F(0)\\F(1)\\F(2)\\F(3)\end{bmatrix}}={\begin{bmatrix}1&1&1&1\\1&2&4&3\\1&4&1&4\\1&3&4&2\end{bmatrix}}{\begin{bmatrix}f(0)\\f(1)\\f(2)\\f(3)\end{bmatrix}}}
  

The number theoretic transform may be meaningful in the ring 
  
    
      
        
          Z
        
        
          /
        
        m
      
    
    {\displaystyle \mathbb {Z} /m}
  
, even when the modulus m is  not prime, provided a principal root of order n exists. Special cases of the number theoretic transform such as the Fermat Number Transform (m = 2k+1), used by the Schönhage–Strassen algorithm, or Mersenne Number Transform (m = 2k − 1) use a composite modulus. 
In general, if 
  
    
      
        m
        =
        
          ∏
          
            i
          
        
        
          p
          
            i
          
          
            
              e
              
                i
              
            
          
        
      
    
    {\textstyle m=\prod _{i}p_{i}^{e_{i}}}
  
, then one may find an 
  
    
      
        
          n
          
            t
            h
          
        
      
    
    {\textstyle n^{th}}
  
 root of unity mod m by finding primitive 
  
    
      
        
          n
          
            t
            h
          
        
      
    
    {\textstyle n^{th}}
  
 roots of unity 
  
    
      
        
          g
          
            i
          
        
      
    
    {\displaystyle g_{i}}
  
 mod 
  
    
      
        
          p
          
            i
          
          
            
              e
              
                i
              
            
          
        
      
    
    {\textstyle p_{i}^{e_{i}}}
  
, yielding a tuple 
  
    
      
        g
        =
        
          
            (
            
              g
              
                i
              
            
            )
          
          
            i
          
        
        ∈
        
          ∏
          
            i
          
        
        
          
            (
            
              
                Z
              
              
                /
              
              
                p
                
                  i
                
                
                  
                    e
                    
                      i
                    
                  
                
              
              
                Z
              
            
            )
          
          
            ∗
          
        
      
    
    {\textstyle g=\left(g_{i}\right)_{i}\in \prod _{i}\left(\mathbb {Z} /p_{i}^{e_{i}}\mathbb {Z} \right)^{\ast }}
  
. The preimage of 
  
    
      
        g
      
    
    {\displaystyle g}
  
 under the Chinese remainder theorem isomorphism is an 
  
    
      
        
          n
          
            t
            h
          
        
      
    
    {\textstyle n^{th}}
  
 root of unity 
  
    
      
        α
      
    
    {\textstyle \alpha }
  
 such that 
  
    
      
        
          α
          
            n
            
              /
            
            2
          
        
        =
        −
        1
        
        mod
        
        
        m
      
    
    {\textstyle \alpha ^{n/2}=-1\mod m}
  
. This ensures that the above summation conditions are satisfied. We must have that 
  
    
      
        n
        
          |
        
        φ
        (
        
          p
          
            i
          
          
            
              e
              
                i
              
            
          
        
        )
      
    
    {\textstyle n|\varphi (p_{i}^{e_{i}})}
  
 for each 
  
    
      
        i
      
    
    {\displaystyle i}
  
, where 
  
    
      
        φ
      
    
    {\displaystyle \varphi }
  
 is the Euler's totient function function.
Fast Fourier transform can be adapted to NTT and implemented with only integer operations. Some choices of m such as the Solinas prime 
  
    
      
        
          2
          
            64
          
        
        −
        
          2
          
            32
          
        
        +
        1
      
    
    {\displaystyle 2^{64}-2^{32}+1}
  
 are even easier to calculate on computers as they require no division operation for reduction.


=== Discrete weighted transform ===
The discrete weighted transform (DWT) is a variation on the discrete Fourier transform over arbitrary rings involving weighting the input before transforming it by multiplying elementwise by a weight vector, then weighting the result by another vector. The Irrational base discrete weighted transform is a special case of this.


== Properties ==
Most of the important attributes of the complex DFT, including the inverse transform, the convolution theorem, and most fast Fourier transform (FFT) algorithms, depend only on the property that the kernel of the transform is a principal root of unity. These properties also hold, with identical proofs, over arbitrary rings. In the case of fields, this analogy can be formalized by the field with one element, considering any field with a primitive nth root of unity as an algebra over the extension field 
  
    
      
        
          
            F
          
          
            
              1
              
                n
              
            
          
        
        .
      
    
    {\displaystyle \mathbf {F} _{1^{n}}.}
  

In particular, the applicability of 
  
    
      
        O
        (
        n
        log
        ⁡
        n
        )
      
    
    {\displaystyle O(n\log n)}
  
 fast Fourier transform algorithms to compute the NTT, combined with the convolution theorem, mean that the number-theoretic transform gives an efficient way to compute exact convolutions of integer sequences. While the complex DFT can perform the same task, it is susceptible to round-off error in finite-precision floating point arithmetic; the NTT has no round-off because it deals purely with fixed-size integers that can be exactly represented.


== Fast algorithms ==
For the implementation of a "fast" algorithm (similar to how FFT computes the DFT), it is often desirable that the transform length is also highly composite, e.g., a power of two. However, there are specialized fast Fourier transform algorithms for finite fields, such as Wang and Zhu's algorithm, that are efficient regardless of the transform length factors.


== See also ==
Discrete Fourier transform (complex)
Fourier transform on finite groups
Gauss sum
Convolution
Least-squares spectral analysis
Multiplication algorithm


== References ==


== External links ==
https://www.apfloat.org/ntt.html